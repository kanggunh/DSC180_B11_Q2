Paper #: 19941_1
Title: Passivation effect of theophylline on the surface defects of MAPbI 3 perovskite
Employing molecular passivators to reduce defect density of perovskite surface is an effective way to improve the stability and photovoltaic performance of perovskite solar cells. Herein, the passivation effect and mechanism of theophylline molecule on the defects of MAPbI 3 (0 0 1) surface were investigated by first-principles calculations based on density functional theory. Our results reveal that the theophylline can stably absorb on the MAPbI 3 surface. Two passivation modes: defect-inhibiting mode and defect-healing mode, are proposed to describe the passivation mechanism. In the defect-inhibiting mode, the theophylline adsorbed on the MAPbI 3 surface leads to the increase of formation energies of most defects, suppressing the generation of defects. In the defect-healing mode, the adsorption of theophylline on the defect site of MAPbI 3 surface can effectively eliminate or weaken the defect impurity states in the bandgap, consequently healing the defects. Hence, incorporating theophylline molecule into MAPbI 3 perovskite film is an effective strategy to passivate surface defects and improve the stability and performance of perovskite solar cells.
Introduction Organic-inorganic lead halide perovskites such as MAPbI 3 (MA = CH 3 NH 3 ) and FAPbI 3 (FA = CH(NH 2 ) 2 ) are the most promising photovoltaic materials, showing an extraordinary application prospects in the development of solar cells  [1] [2] [3] [4] . In the past decade, the power conversion efficiency (PCE) of perovskite solar cells (PSCs) has increased from 3.8% to 25.7%, matching the efficiency of polysilicon solar cells  [5] [6] [7] [8] [9] [10] [11] [12] . However, there are numerous defects on the surfaces and grain boundaries of perovskites. The relatively high density of defects not only act as recombination centers, reducing the carrier lifetime and charge extraction efficiency, but also promote the penetration of water and oxygen molecules in the air into the perovskite film, accelerating the degradation of PSCs  [13] [14] [15] [16] . To obtain PSCs with high efficiency and stable performance, many passivation strategies have been implemented, including packaging  [17, 18] , interface engineering  [19, 20] , additive doping  [21, 22] , and surface passivation  [23] [24] [25] . Recently, it has been proved experimentally that introducing molecular passivator to modify perovskite surface is a simple and effective method to improve the stability and PCE of PSCs  [26] [27] [28] . Molecules with lone pair electrons like Lewis base can be used to passivate defects in perovskites. So far, many small organic molecules with O, N, or S functional groups have been successfully utilized for the passivation of perovskite surface defects  [29] [30] [31] . These molecular passivators can be added directly to perovskite precursors or deposited onto the perovskite films. Wang's group coated theophylline on the surface of perovskite film by posttreatment method, and confirmed that the theophylline interacts with Pb I defect through C = O functional group. The photovoltaic performance and long-term stability of treated PSCs were improved and finally showed the best photoelectric conversion efficiency of 22.6%  [32] . Laskar et al.  [33]  added phenylhydrazinium iodide to MAPbI 3 perovskite precursor and they found that the additive not only reduces the defects on perovskite surface but also improves the stability of the perovskites. Molecular passivator can passivate defects on perovskite surface by eliminating defect states through charge transfer. Khanal et al.  [34]  carried out an ab initio molecular dynamics simulation for the system in which  [6, 6] -phenyl-C61-butyrate methyl ester (PCBM) was introduced on MAPbI 3 surface containing I Pb defect, and their results revealed that the interaction between the defect state and the electronic state of PCBM is expected to mitigate the effect of defects on the perovskite surface. Wang et al.  [35]  employed graphene to modify the surface of MAPbI 3 , and their DFT calculations showed that the charge transfer between the graphene and the Pb or I atoms on the surface inhibits the formation of I-I dimer and Pb-Pb dimer in the defective system, thus effectively removing the defect states in mid-gap. Oner et al.  [36]  confirmed through DFT calculations that benzene additive with delocalized electrons could effectively passivate FA i and Pb i deep-level defects on perovskite surface, which is mainly attributed to the charge transfer between the benzene and defective surface. The passivation effectiveness of molecular passivator on surface defects can be evaluated by the changes of defect formation energy. The increase of defect formation energy leads to the decrease of defect density, achieving the passivation of defect. Liu et al.  [37]  used methimazole as a surface patch to alleviate the formation of iodine vacancy on the surface of MAPbI 3 and block the degradation pathway of iodine vacancy, and consequently improve the quality of perovskite film. Using DFT calculation, Zhou's group  [38]  demonstrated that introduction of NaF could improve efficiency and stability of perovskite due to the increase of defect formation energy of FA vacancy. In a word, defects on surfaces and grain boundaries are detrimental to the stability and performance of perovskites. Therefore, an in-depth understanding of chemical and physical characteristics of defects is crucial to design and fabricate PSCs with high stability and excellent performance. Like other Lewis bases, theophylline contains two O-donor atoms and should be an effective passivator of surface defects. Herein, we report theoretical investigations on the passivation effect of theophylline molecule on the surface defects of MAPbI 3 perovskite. Two passivation modes are proposed to uncover the defect passivation mechanism. Our calculations indicate that theophylline can strongly adsorb on the (0 0 1) surface of MAPbI 3 . The theophylline molecule can passivate surface defects by defect-inhibiting mode and defect-healing mode. This work is of great significant for the comprehensive understanding of defect passivation mechanism and the performance improvement of perovskite-based solar cells. 
 Computation methods All first-principles DFT calculations were performed by using Vienna ab initio simulation package (VASP) code  [39] . Perdew-Burke-Ernzerhof (PBE) generalized gradient approximation (GGA-PBE) was chosen to describe the exchange-correlation energy  [40]  and projector augmented wave (PAW) method was adopted to describe the electron-ion interaction  [41] . The van der Waals (vdW) correction of optPBE-vdW was included in the calculations  [42] . The cut-off energy for plane wave function was set to 500 eV, the convergence threshold for self-consistent total energy was set as 1 × 10 -5 eV, and the residual force on each atom in the relaxation kept below 0.02 eV/Å. The atomic valence electrons involved in the calculations are H 1s 1 , C 2s 2 2p 2 , N 2s 2 2p 3 , O 2s 2 2p 4 , Pb 5d 10 6s 2 6p 2 , I 5s 2 5p 5 . The unit cell of MAPbI 3 was optimized with Brillouin zone grid of 6 × 6 × 4. The structure of theophylline molecule was optimized in a periodic cubic cell with side length of 15 Å. MAPbI 3 (0 0 1) surface was modeled by a slab with six atomic layers constructed from a ̅̅̅ 2 √ × ̅̅̅ 2 √ × 1 supercell. A vacuum layer with thickness of 15 Å was set in the normal direction of the slab to avoid the interaction between periodic units. In geometry optimization procedure, atoms in the two bottom layers were fixed, while other atoms were freely relaxed. The Brillouin zone was sampled by a 6 × 6 × 1 Monkhorst-Pack grid in the surface slab optimizations. Some intrinsic point defects such as vacancy, antisite, and interstitial were created on the surface slab. A theophylline molecule was adsorbed on the (0 0 1) surface to construct theophylline/MAPbI 3 adsorption model which was used to evaluate the passivation effect of theophylline on the surface defects of MAPbI 3 perovskite. 
 Results and discussions 
 MAPbI 3 surface and theophylline molecule Tetragonal MAPbI 3 with space group of I4/mcm  [43] , a stable phase at room temperature, was adopted for calculating the properties of bulk and surface. Fig.  1a  shows the optimized structure of tetragonal MAPbI 3 . The computed lattice constants are a = b = 8.86 Å and c = 13.07 Å, which are close to the experimental observation  [44] . Both theoretical and experimental studies have confirmed that (0 0 1) surface is the most stable surface of MAPbI 3  [45, 46] . Therefore, (0 0 1) surface with two type terminations, namely, PbI 2 -terminated surface (Fig.  1c ) and MAIterminated surface (Fig.  1d ), were considered in this study. The calculated surface energies of the PbI 2 -terminated and MAI-terminated surfaces are 0.017 and 0.011 eV/Å 2 (the computational method are given in the Supplementary Material), indicating that these two surfaces are stable and easy to form. The smaller the surface energy, the more stable the corresponding surface  [47] . The MAI-terminated surface of MAPbI 3 is slightly more stable than the PbI 2 -terminated one, which is the same as the result predicted by Quarti et al.  [48] . Our calculated bandgap of bulk MAPbI 3 is 1.63 eV which is comparable to the experimental value of 1.61 eV  [49] . Band structures of the PbI 2 -terminated and MAI-terminated surfaces are shown in Fig.  S1 . It can be seen that the bandgap of PbI 2 -terminated surface is 0.73 eV which is 0.9 eV smaller than that of the bulk, while the MAI-terminated surface has a bandgap of 1.63 eV, the same as the bulk. The narrow bandgap of the PbI 2 -terminated surface may be caused by the unsaturated coordination of Pb atoms on surface  [34] . The optimized structure of theophylline molecule is presented in Fig.  1b . By analyzing the calculated Bader charge (Table  S1 ), we found that the electronic charges on two carbonyl oxygen atoms are greater than those on nitrogen atoms, so these oxygen atoms are more readily bonded to the unsaturated Pb atoms of surface. The H atom in N-H group has higher net charge than the other H atoms, serving as a good hydrogen bond donor  [50] . In addition, the delocalized electrons of theophylline molecule also tend to enhance the interaction with surface. 
 Adsorption of theophylline on the surface of MAPbI 3 In order to find out the most stable adsorption configurations of the theophylline on the MAPbI 3 (0 0 1) surface, we considered two adsorption patterns, i.e., vertical and parallel adsorptions. Fig.  2  shows four adsorption configurations with the minimum energies for the adsorptions of theophylline on the PbI 2 -terminated and MAI-terminated surfaces of MAPbI 3 . Hereafter, we name the adsorption of theophylline on the PbI 2 -terminated surface as theophylline/PbI 2 , on the MAIterminated surface as theophylline/MAI. In theophylline/PbI 2 (Fig.  2a  and c ), theophylline interacts with perovskite surface by forming Pb-O and H⋯I bonds regardless of vertical or parallel adsorption. The Pb atom on the PbI 2 -terminated surface is in unsaturated coordination, which is easy to accept electrons. The O atom in theophylline has lone pair electrons and tends to form a strong coordination bond with the Pb atom on the PbI 2 -terminated surface. When theophylline is adsorbed parallelly on the surface (Fig.  2c ), two O atoms in theophylline are far enough apart to effectively coordinate the two unsaturated Pb atoms on the surface, forming two Pb-O bonds with lengths of 2.53 and 2.60 Å. Meanwhile, a H⋯I hydrogen bond with length of 2.86 Å is formed between the H atom in theophylline and the I atom in perovskite. When theophylline is adsorbed vertically on the MAI-terminated surface (Fig.  2b ), the molecule binds to the perovskite surface through H⋯O and H⋯I hydrogen bonds. The bond length of H⋯O bond is 1.80 Å, indicating that a strong hydrogen bond is formed. While the length of H⋯I bond is 2.68 Å, being a weak hydrogen bond. As theophylline is adsorbed parallelly on the surface (Fig.  2d ), two O atoms of theophylline and H atoms of surface form two H⋯O hydrogen bonds with length of 2.41 Å.  To evaluate the stabilities of the adsorption systems, the adsorption energies are calculated as follows: E ads = E theophylline/slab -E slab -E theophylline (1) where E theophylline/slab , E slab , E theophylline are total energies of the theophylline/MAPbI 3 , MAPbI 3 (0 0 1) surface, and theophylline molecule, respectively. The adsorption energies are given in Fig.  2 . It can be found that the theophylline adsorption on the PbI 2 -terminated surface is stronger than on the MAI-terminated surface, and the parallel adsorption is more stable than the vertical adsorption. In the theophylline/ PbI 2 , adsorption energies in vertical and parallel adsorption patterns are -1.36 eV and -1.76 eV, respectively. The larger adsorption energy for parallel adsorption stem from two reasons. One is an increase in the number of Pb-O bonds. The other comes from the conjugated π electrons which enhance the interaction between the theophylline and the perovskite surface. The molecular skeleton consisting of C, N, and O atoms of theophylline is a conjugate system (Fig.  1b ). Our DFT calculation shows that the highest occupied molecular orbital of theophylline exhibits an evident feature of anti-bonding π orbital. The delocalized electrons in the anti-bonding π orbital can act as electron donors to interact with Pb 2+ ions on the PbI 2 -terminated surface and transfer electrons to the surface. This is consistent with the following analysis of Bader charge and the Oner's findings  [36] . In the theophylline/MAI, the adsorption energies of vertical and parallel adsorptions are -0.74 and -0.93 eV, respectively. The adsorption energy of parallel adsorption is somewhat more negative than that of vertical adsorption due to that there are two relatively stronger H⋯O bonds in the parallel adsorption but there are one H⋯O bond and one weak H⋯I bond in the vertical adsorption. When theophylline adsorbed on MAPbI 3 surface, the formation of Pb-O coordination bond protects the unsaturated Pb atom from the erosion of water and oxygen, and H⋯O hydrogen bond stabilizes the volatile MA on surface. In this way, the adsorption of theophylline molecule enhances the stability of the perovskite materials. To further understand the electronic properties of the adsorption systems, we investigated band structure, partial density of state (PDOS) and charge density difference (CDD) of the four stable adsorption configurations. From the band structures in Fig.  3a  and 3b , it can be seen that the bandgaps of theophylline/PbI 2 increased from 0.73 eV for clean surface to 1.00 and 0.98 eV for the vertical and parallel adsorption systems, which are closer to the experimental value of 0.98 eV  [34] . The increase of bandgap may be due to the formation of Pb-O bond which helps to increase the antibonding orbital level in the conduction band. The bandgaps of theophylline adsorbed vertically and parallelly on the MAI-terminated surface are 1.63 eV and 1.65 eV (Fig.  3c  and d ), which are almost the same as the value of 1.63 eV for the clean MAI-terminated surface (Fig.  S1 ). PDOSs in Fig.  3a  and b  show that Pb and O atoms have significant overlaps in the valence band of the theophylline/PbI 2 regardless of vertical or parallel adsorption, indicating a strong interaction between the Pb and O atoms. The I atom overlaps with the H atom of theophylline to some extent in both vertical and parallel adsorption patterns, showing the formation of H⋯I hydrogen bond. Analogously, PDOSs in Fig.  3c  and d  show the evidence of forming H⋯O and H⋯I hydrogen bonds in the theophylline/MAI adsorption systems. The adsorption of theophylline on perovskite surface results in the electron transfer and charge redistribution. Fig.  3  shows CDD plots of the theophylline/MAPbI 3 adsorption systems. CDD is defined as: Δρ = ρ theophylline/slab -ρ slab -ρ theophylline (2) where ρ theophylline/slab, ρ slab, and ρ theophylline represent charge densities of the theophylline/MAPbI 3 , MAPbI 3 surface slab, and theophylline molecule, respectively. In the theophylline/PbI 2 (Fig.  3a  and b ), a charge depletion region appears on the top of Pb atom, meanwhile charges accumulate around the O atom of theophylline. In the adsorption process, electrons on the Pb atom transfer to the O atom to form Pb-O coordination bond. Simultaneously, a charge accumulation region occurs between the I atom of surface and the H atom of theophylline, forming a H⋯I bond. Likewise, in the theophylline/MAI (Fig.  3c  and d ), charges accumulate between the O and H atoms or I and H atoms, confirming the formation of H⋯O or H⋯I bond. In short, the adsorption of theophylline causes the significant charge transfer between the theophylline molecule and the MAPbI 3 (0 0 1) surface, which plays a crucial role in the stabilization of theophylline/MAPbI 3 adsorption systems. To verify the charge transfer in the adsorption process of theophylline on the MAPbI 3 surfaces, Bader atomic charges were calculated, as listed in Table  S2 . In the theophylline/PbI 2 , the charges on the O atoms of theophylline and the I atoms of surface increased, while the charges on the Pb and H atoms decreased. Electrons are transferred from the theophylline to the perovskite surface with amounts of 0.027 and 0.017 electrons in vertical and parallel adsorption patterns, respectively. As for the theophylline/MAI, the charges on the O atoms and I atoms increased, and the charges of H atoms decreased. Total of 0.036 and 0.048 electrons are transferred from the perovskite surface to the theophylline in vertical and parallel adsorption patterns. The optical properties of the MAPbI 3 (0 0 1) surface with and without theophylline adsorption were inspected to probe the influence of the theophylline molecule on the light absorption of perovskite materials. The absorption coefficient I(ω) is calculated by the following equation  [51] : I(ω) = ̅̅ ̅ 2 √ ω ̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅ ̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅̅ ε 2 1 (ω) + ε 2 2 (ω) √ -ε 1 (ω) √ (3) where ε 1 (ω) and ε 2 (ω) are the real and imaginary parts of dielectric function, depending on the optical frequency ω. As can be seen from Fig.  S2 , the light absorptions of the theophylline/MAPbI 3 adsorption systems are similar with that of the pristine MAPbI 3 surface. The maximum absorption peaks appear at about 340 nm. The light absorption coefficients of the theophylline/MAPbI 3 adsorption systems have no significant differences compared with that of the pristine surfaces. Moreover, theophylline shows a tiny light absorption coefficient in the visible region, so it has no obvious influence on the light absorption of the MAPbI 3 surface. Furthermore, the introduction of theophylline molecule neither leads to the rupture of Pb-I bonds on the outmost surface nor has adverse effect on the electronic properties of the perovskite. The formation of Pb-O and I⋯H bond also protects the unsaturated Pb and I atoms from the corrosion of outside water and oxygen molecule. In addition, the presence of theophylline has no adverse influence on the light absorption of MAPbI 3 perovskite. Therefore, theophylline molecule is expected to be an ideal surface defect passivator. 
 Defects on the surface of MAPbI 3 Intrinsic point defects are ubiquitous on the surface of solution synthesized perovskite, which are detrimental to the stability and performance of the perovskite materials  [38, 52] . Understanding the chemical and physical characteristics of defects can not only explain the decomposition process of the perovskite but also provide guidance for improving its performance through defect passivation. Therefore, we examined seven typical defects in the neutral charge state, V I , V Pb , V MA , Pb I , I Pb , Pb I and I i , on MAPbI 3 (0 0 1) surface. The relaxed geometries of the PbI 2 -and MAI-terminated surfaces with defects are shown in Figs.  S3  and S4 . Defect formation energy was computed according to the following formula  [36] : E f = E defective -E pristine + ∑ i n i (μ i + E i ) (4) where E defective and E pristine represent total energies of the MAPbI 3 (0 0 1) surface with and without defect, n i is the number of element i removed from or added to the system, μ i denotes chemical potential of species i referenced to elemental solid with energy E i . The restrictions of chemical potentials of components must be satisfied for the equilibrium growth of MAPbI 3 crystal are given in the Supplementary Information, and the phase diagram of chemical potentials is shown in Fig.  S5 . It can be found that the stable chemical potential range for the formation of MAPbI 3 is very narrow, being consistent with the previous report  [53] . We choose three points, A (μ I = 0 eV, μ Pb = -2.16 eV, μ MA = -2.95 eV), B (μ I = -0.54 eV, μ Pb = -1.04 eV, μ MA = -2.45 eV) and C (μ I = -1.08 eV, μ Pb = 0 eV, μ MA = -1.87 eV), as I-rich, moderate, and Pb-rich conditions for the growth of MAPbI 3 perovskite. Accordingly, we computed the formation energies of neutral defects under the three representative synthesis conditions of MAPbI 3 perovskite, following the approach reported by Yin et al.  [53] . The formation energies of neutral defects on the MAPbI 3 (0 0 1) surface are shown in Fig.  4  and listed in Table  S3 . There is a strong correlation between the defect formation energy and the surface termination. Defects on the PbI 2 -terminated surface have relative low formation energies due to that there are under-coordinated Pb and I atoms on the outermost layer of these surfaces, which make the defect formation easier. Whereas, there is only exposed under-coordinated I atoms on the MAI-terminated surface, which are inconducive to the formation of defect, leading to the higher defect formation energies. The defect formation energies are dependent on the chemical environments for the growth of perovskite. Under I-rich condition, V Pb , V MA , I Pb and I i on the two terminated surfaces have lower formation energies compared to other defects, while under Pb-rich condition only V I has a relative low formation energy. Therefore, it is less likely to form defects under Pbrich condition than under I-rich condition, which is the same as the conclusion reached by Uratani et al.  [54]  Furthermore, vacancy defects have relative lower formation energies, indicating that vacancy defects are dominant on the MAPbI 3 (0 0 1) surface, while Pb I antisite and Pb i interstitial are almost impossible to generate under I-rich condition. Defects on perovskite surface may lead to the formation of defect states near the band edges or in the mid-gap  [54] . Total density of states (TDOSs) of defective surfaces were plotted in Figs.  S6  and S7 . There are obvious defect states in the bandgap for the presence of Pb I , I Pb and I i defects on the PbI 2 -terminated surface, and V Pb , Pb I and Pb i defects on the MAI-terminated surface, as shown in Fig.  5 , while other defects have no obvious defect states in the bandgap. TDOS of the PbI 2 -terminated surface with Pb I defect is shown in Fig.  5a . It can be seen that the defect state appears in the energy range of -0.8 --0.2 eV near the bottom of conduction band. When I Pb defect is formed on the PbI 2 -terminated surface, see Fig.  5b , the bandgap is almost occupied by low density of defect states. The TDOS in Fig.  5c  clearly shows that defect states emerge near the edge of valence band when I i defect presented on the PbI 2 -terminated surface. For the defects on the MAI-terminated surfaces, we observed that V Pb has a discrete peak of defect states near the valence band edge, as shown in Fig.  5d . For Pb I defect on the MAI-terminated surface (Fig.  5e ), two defect state peaks locate near the conduction band edge. When Pb i defect is formed on the MAI-terminated surface, in Fig.  5f , a defect state peak appears at the conduction band edge. These defect states, or be called trap states, are the primary cause of no-radiative recombination loss of PSC devices. 
 Passivation of defects on the MAPbI 3 surface by theophylline Surface defect passivation is an effective strategy to enhance the performance of PSCs. A number of methods for passivating defects on the surface of perovskite film were implemented experimentally. One of the most commonly used method is to add passivation reagent directly into the perovskite precursor solution to inhibit the formation of defects and obtain dense and uniform perovskite films  [55] [56] [57] . Base on this experimental technique, we design a defect passivation mode, i.e., defect-inhibiting mode, to probe the inhibition of defect formation by the theophylline adsorption on the perovskite surface. In the defectinhibiting mode, the defect formation energies on the MAPbI 3 surfaces with and without theophylline adsorption were calculated and compared to describe how the theophylline adsorption increase the difficulty of defect formation. Another commonly used experimental method is to treat the perovskite surface by spin-coating passivator on the as-prepared perovskite film  [58, 59] . Accordingly, we design a defect-healing mode, in which the theophylline molecule is adsorbed on the site of surface defect and then examine the elimination or reduction of defect states in the bandgap, to illustrate the healing effect of surface defect by the theophylline adsorption. Regarding the defect-inhibiting mode, the defect formation energies on the MAPbI 3 (0 0 1) surfaces with theophylline adsorption were calculated, as shown in Fig.  6 . For the comparison, the defect formation energies on the clean surfaces are also presented in Fig.  6 . All values of these defect formation energies are also listed in Table  S4 . From the previous discussions we have concluded that the defects are easier to form on the PbI 2 -terminated surface than on the MAIterminated surface, and the adsorption of theophylline molecule on the PbI 2 -terminated surface is stronger than on the MAI-terminated surface. It can be observed from Fig.  6  and Table  S4  that the variations of defect formation energies caused by the theophylline adsorption on the PbI 2 -terminated surfaces are more obvious compared with that on the MAI-terminated surfaces. For almost all defects on the PbI 2 -terminated surface, the defect formation energies become higher whether in the case of vertical or parallel adsorption and regardless of synthesis conditions of I-rich, moderate, or Pb-rich. However, both of the vertical and parallel adsorptions of theophylline have no apparent influence on the defect formation energies on the MAI-terminated surface in any synthesis conditions. What is noteworthy is that the theophylline adsorption brings severe influence on the formation energies of defects V Pb , I Pb , and I i which are very easy to form on the clean PbI 2 -terminated surface under the I-rich condition, see Fig.  6a . For instance, the defect formation energy of V Pb is a large negative value on the clean surface, but it becomes to a very small negative value or even zero after the vertical or parallel adsorption of theophylline. The defect I Pb can be generated spontaneously on the clean PbI 2 -terminated surface under Irich condition, but its formation energy changes from negative to positive by the theophylline adsorption, especially in the vertical adsorption pattern. Although the formation energy of defect I i on the clean PbI 2terminated surface is a small positive value, it increases apparently after the theophylline adsorption. Above discussions demonstrate that the theophylline adsorption indeed increases the formation energies of defects, especially for V Pb and I Pb which are most likely to form on the PbI 2terminated surface, inhibiting the formation of these defects. This is understandable from the concept of chemistry. In I-rich condition, iodine is in excess but lead is not enough on the PbI 2 -terminated surface, so Pb vacancy is easy to form and I is facile to occupy the position of Pb. When theophylline adsorbed on the PbI 2 -terminated surface, the exposed and unsaturated Pb atom is coordinated by O atom of theophylline. Thus this Pb atom is not easy to remove to generate V Pb and to be substitute to form I Pb . Now we turn our focus to the defect-healing mode, in which the theophylline molecule is adsorbed on the site of surface defect and then the defect states in the bandgap are checked and compared from the DOS plots before and after the theophylline adsorption. Here, six defects, Pb I , I Pb , and I i on the PbI 2 -terminated surface, V Pb , Pb I , and Pb i on the MAI-terminated surface, are considered, since these defects introduce defect states in the bandgaps of surfaces. Let us first analyze the interaction between the theophylline molecule and the defective surface. In order to search for the most stable adsorption configurations, here we do not distinguish the vertical and parallel adsorptions. The most stable configurations of theophylline adsorbed on the defective MAPbI 3 (0 0 1) surfaces are shown in Fig.  7 , and the adsorption energies are presented in Fig.  S8 . When theophylline adsorbs on the PbI 2 -terminated surface containing Pb I defect (Fig.  7a ),    7c ). At the same time, the H atom of theophylline interacts with the I atom at the defect site to form a H⋯I bond, resulting in the vanish of the iodine dimer appeared at the defect site of clean surface (Fig.  S3h ), and the adsorption energy reaches -2.05 eV which is higher than that of theophylline adsorbed on the defect-free surface (Fig.  S8 ).  When theophylline adsorbs on the MAI-terminated surface containing V Pb defect (Fig.  7d ), the bond lengths of H⋯O and H⋯I bonds decreased and the adsorption energy increased compared to that in the case of theophylline adsorbed on the defect-free surface (Fig.  2b  and Fig.  7d ). When theophylline adsorbs on the MAI-terminated surface containing Pb I and Pb i defects (Fig.  7e  and f ), the O atom of theophylline interacts with the inserted or substituted Pb atom respectively to form a Pb-O bond, leading to the more negative adsorption energy, as shown in Figs.  2, 7  and S8. To disclose the healing effect of theophylline adsorption on the surface defects, we plotted TDOSs for the MAPbI 3 surface with defects which introduce defect states in the bandgap. Fig.  8  shows TDOSs of the MAPbI 3 (0 0 1) surfaces with defects (Pb I , I Pb , and I i on the PbI 2 -terminated surface, V Pb , Pb I , and Pb i on the MAI-terminated surface) before and after the theophylline adsorption. After the addition of theophylline on the PbI 2 -terminated surface containing Pb I antisite, the defect states near the conduction band minimum (CBM) are not obviously reduced, indicating that theophylline molecule has little possibility of healing Pb I defect (Fig.  8a ). For I Pb defect on the PbI 2 -terminated surface, the sharp peak of defect states near the CBM disappears completely, but some defect states in the bandgap still remain, meaning that the theophylline adsorption can heal the I Pb defect to a certain extent but not completely (Fig.  8b ). In the case of I i defect on the PbI 2 -terminated surface (Fig.  8c ), the defect states near the valence band maximum (VBM) are totally eliminated after the theophylline adsorption, implying that theophylline has a good healing effect on the I i defect. For the MAI-terminated surface, the defect states of V Pb near the VBM are totally disappeared (Fig.  8d ), the two peaks of defect states of Pb I in the bandgap and near the CBM are fully eliminated (Fig.  8e ), and the peak of defect states of I i near the CBM are markedly reduced (Fig.  8f ) after the theophylline adsorption. These facts demonstrate that theophylline molecule has an excellent healing effect on the defects on the MAI-terminated surface of MAPbI 3 perovskite. The adsorption of theophylline on the defect site of perovskite surface leads to the effective elimination of defect states, attributing to the charge transfer between the theophylline and the defective surface. To further confirm the strong interaction and charge transfer between the theophylline and the perovskite surface, the charge density difference (CDD) was computed, as shown in Fig.  9 . On the PbI 2 -terminated surface, when theophylline adsorbs on Pb I defect site (Fig.  9a ), charge depletions occur on the Pb atoms near the defect, while charge accumulations appear on the two O atoms of theophylline, forming two Pb-O bonds. Additionally, a weak charge transfer between the H atom of theophylline and the I atom of surface can also be seen. For I Pb defect on the PbI 2 -terminated surface (Fig.  9b ), a charge depletion region appears above the Pb atom near the defect site, and charge transfer happens from the Pb atom to the O atom. In the case of I i defect on the PbI 2 -terminated surface (Fig.  9c ), two larger charge depletion regions present above the two Pb atoms, while two larger charge accumulation regions appear around the two O atoms of theophylline, meaning the electron transfer from the Pb to O atoms. Meanwhile, the H atom of theophylline transfers electrons to the I atom of surface, resulting in the charge accumulation around the I atom. The total interactions of two Pb-O bond and one H⋯I bond result in the most negative adsorption energy (Fig.  S8 ) and the complete delamination of the defect states near the Fermi level (Fig.  8c ). When theophylline adsorbed on V Pb defect site of the MAIterminated surface (Fig.  9d ), the excess charges are mainly accumulated on the carbonyl O atom of theophylline and the I atom of surface, and the charge depletions are mainly located on the H atom of theophylline and the H atom of surface, indicating the formation of H⋯O and H⋯I hydrogen bonds. If theophylline adsorbed on Pb I site (Fig.  9e ), the charge accumulation regions present on the two O atoms, and charge depletion regions appear around the Pb atom and the H atom of surface, evidencing the formation of Pb-O and H⋯O bonds. After the adsorption of theophylline on Pb I defect site (Fig.  9f ), the charge depletion occurs above the Pb atom, and the charge accumulation occurs on the O atom, forming a relatively strong Pb-O bond. 
 Conclusions Based on the first-principles DFT calculations, we investigated the passivation of defects on the surface of MAPbI 3 perovskite by theophylline molecule. Our calculations revealed that theophylline can strongly adsorb on the MAPbI 3 (0 0 1) surface in vertical and parallel adsorption patterns, and the adsorption of theophylline on the PbI 2terminated surface is more stable than on the MAI-terminated surface. The theophylline adsorption does not bring an adverse effect on the light absorption of the perovskite material. Two defect passivation modes, that is, defect-inhibiting mode and defect-healing mode, were proposed to explore the passivation mechanism of theophylline molecule on the surface defects. In the defect-inhibiting mode, the theophylline adsorption increases the formation energies of some defects, and thus inhibits the formation of the defects, especially for the defects V Pb , I Pb , and I i which are very easy to generate on the PbI 2 -terminated surfaces under I-rich condition. In the defect-healing mode, the defect states emerged in the bandgap or near the band edge can be eliminated or reduced by the theophylline adsorption, achieving the effect of healing defect. The TDOS analysis indicated that theophylline molecule has satisfactory healing effect on the defect I i on the PbI 2 -terminated surface, and V Pb , Pb I , and Pb i on the MAI-terminated surface, but has little impact on Pb I defect on the PbI 2 -terminated surface. Our theoretical modeling confirmed that the adsorption of theophylline molecule can indeed passivate some point defects on the surface of MAPbI 3 perovskite, being consistent with the results experimentally observed. Fig. 1 . 1 Fig. 1. Optimized structures of tetragonal MAPbI 3 (a), theophylline molecule (b), PbI 2 -terminated surface (c), and MAI-terminated surface (d). 
 Fig. 2 . 2 Fig. 2. Adsorption configurations and energies of theophylline on the MAPbI 3 (0 0 1) surface, vertical (a) and parallel (c) adsorptions on the PbI 2 -terminated surface, vertical (b) and parallel (d) adsorptions on the MAI-terminated surface. 
 Fig. 3 . 3 Fig. 3. Band structure, PDOS, and CDD of theophylline/MAPbI 3 adsorption systems, vertical (a) and parallel (b) adsorptions on the PbI 2 -terminated surface, vertical (c) and parallel (d) adsorptions on MAI-terminated surface. In CDD plots, yellow and cyan region represent charge accumulation and depletion with an isosurface value of 0.001 electron bohr -3 . 
 Fig. 4 . 4 Fig. 4. Formation energies of neutral defects on the MAPbI 3 (0 0 1) surface under I-rich (a), moderate (b), and Pb-rich (c) conditions. 
 Fig. 5 . 5 Fig. 5. TDOS of the MAPbI 3 surface with defects: PbI 2 -terminated surface with Pb I , I Pb , and I i (a) -(c), MAI-terminated surface with V Pb , Pb I , and Pb i (d) -(f). 
 Fig. 6 . 6 Fig. 6. Formation energies of neutral defects on the MAPbI 3 (0 0 1) surface with and without theophylline adsorption. 
 Fig. 7 . 7 Fig. 7. Adsorption configurations of theophylline on the MAPbI 3 (0 0 1) surface with defects, Pb I , I Pb , and I i on the PbI 2 -terminated surface (a) -(c), V Pb , Pb I , and Pb i on the MAI-terminated surface (d) -(f). 
 Fig. 8 . 8 Fig. 8. TDOS of the MAPbI 3 (0 0 1) surfaces with defects before and after the theophylline adsorption, Pb I , I Pb , and I i on the PbI 2 -terminated surface (a) -(c), V Pb , Pb I , and Pb i on the MAI-terminated surface (d) -(e). Gray area and red line represent TDOS before and after the theophylline adsorption. 
 Fig. 9 . 9 Fig. 9. CDD diagrams for theophylline adsorbed on the PbI 2 -terminated surface with Pb I , I Pb , and I i defects (a) -(c) and on the MAI-terminated surface with V Pb , Pb I , and Pb i defects (d) -(f). Yellow and cyan represent the charge accumulation and depletion with an isosurface value of 0.001 electron bohr -3 . 
			 Computational Materials Science 219 (2023) 112028
