Paper #: 106

Sqrt(Sum(2Th O-C)**2)/(Nref-Npar)): 0.0337 Sqrt(Sum(2Th O-C)**2)/Nref): 0.0285 Final values: (Standard errors on 2nd line)
Supplementary Note 1 Structure modeling for ZrL3 Collected PXRD patterns for as-made ZrL3 was indexed with CELREF Version 3.0. The structural model of ZrL3, including cell parameters and atomic positions, was generated using Materials Studio (v6.1.0) suit of programs by Accelrys, after considering the indexed cell parameters together with the ligand shape and coordination habits. A structure model was refined by a self-consistent iterative procedure in which successive geometry optimization calculation were performed using the Forcite module of Materials Studio, until the total energy difference was less than 1 x 10 -6 kcal mol -1 . The geometry optimization used a "smart" algorithm which was a cascade of the steepest descent, ABNR, and quasi-Newton methods. The bonded and the short range (van der Waals) non-bonded interactions between the atoms were modeled using the Universal Force Field (UFF). Universal is a purely diagonal, harmonic forcefield. Bond stretching is described by a harmonic term, angle bending by a three-term Fourier cosine expansion, and torsions and inversions by cosine-Fourier expansion terms. The van der Waals interactions are described by the Lennard-Jones potential. Electrostatic interactions are described by atomic monopoles and a screened (distance-dependent) Coulombic term. An LJ cutoff distance of 18.5 Å was used for all geometry optimization simulations. The Ewald sum method was used to compute the electrostatic interactions. The reliability of the structure models was checked by comparing the calculated PXRD patterns and the experimental results. The PXRD pattern of ZrL3 can be indexed with a 3D hexagonal unit cell with a = b = 19.9786 Å, c = 7.2427 Å. The a and b are close to the distance between two Zr6 clusters linked by a 1,3,5-Tris(4-carboxyphenyl)benzene linker (19.54 Å in UMCM-309a), indicating a network with Zr6 clusters in the hexagonal lattice points and L3 as linkers. It should be noted that the peak corresponding to the c is not obvious and the selection is somewhat subjective. The pattern of ZrL3 matches that of UMCM-309a indicating a similar structure.  1   
 Indexing results of PXRD pattern of ZrL3 Initial values: (Refinement keys on 2nd line)  -------------- : Base on the indexing result and the component analysis, a model was built with 6-conneted Zr6 clusters as nodes and 3-connected L3 as linkers in the cell from indexing. In the supposed structure, a [Zr6O4(OH)4] cluster is coordinated by six carboxylic group of L3 on the equatorial plane. Six formate groups were assigned on the left coordination sites. The structure model was refined by a self-consistent iterative procedure in which successive geometry optimization calculation were performed using the Forcite module of Materials Studio, until the total energy difference was less than 1 x 10 -6 kcal/mol. The calculated PXRD pattern from the structure model (with modification of crystalline size (20 nm × 20 nm × 2 nm)) fit well with the experimental pattern of ZrL3. Zero 
 Supplementary Note 2 TGA analysis of ZrL3 As shown in Supplementary Fig.  8a , the mass gradually decreases in the entire temperature range, with no flat, constant weight decidedly reached (even at 950 ℃) in TGA plot for an activated ZrL3 sample (in an N2 atmosphere). The persistent weight loss at high temperatures suggest that the linker molecules did not disintegrate and depart completely, likely leaving behind carbon-containing residues from carbonization and aromatization of the linker components.  2  To better probe the MOF composition, the TGA data were re-collected with the sample heated in an air flow, for complete oxidation and removal of the organic components (see Supplementary Fig.  8b ). A stable residual weight (ca 25%) was reached after 600 ℃, indicating the conversion into the persistent/stable ZrO2 (mw 123.2) as the residue. The inflection point at 400 ℃ corresponds to the weight fraction of 66%, which is consistent with the evacuated, dehydrated formula Zr6O8(C27H15O6S6)2O (mw 1947): hydrogen-bonded to the polar -OH, carboxylate, and thiol groups, thus leading to their departure at the higher temperatures (above 180 ℃). The initial weight loss of ca 10% (up to 60 ℃) can be ascribed to the moisture loosely adsorbed on the surface of the MOF solid. In addition, the residual DMF molecules and water molecules either coordinated to the Zr(IV) center or hydrogen-bonded to the O and S groups around the metal nodes of the MOF scaffold. These small molecules guests are encapsulated within the MOF cavities, and do not impact the workings of the perovskite solar device. 
 Supplementary Note 3 Carrier mobility calculation The electron-only devices with the configuration of ITO/TiO2/ZrL3/PC61BM/BCP/Ag, ITO/TiO2/ZrL3:bis-C60/BCP/Ag and ITO/TiO2/PC61BM/BCP/Ag were fabricated to calculated the electron mobilities. Also, the hole- 
 ⁄ = , where (mg L -1 ) refers to the remaining concentration of Pb, the number of unoccupied sites of the sorbent at certain time (min), and (g -1 min -1 ) the adsorption rate constant. The is approximated to be a constant. Such an approximation is justified in the present condition, in which excess adsorbent (20.0 mg ZrL3) was used so that the sorption sites greatly outnumber the Pb ions (0.0024 mmol Pb). The maximum adsorption capacity ( ) for Pb is calculated to be 355 mg g -1 (7.1 mg of Pb uptake in this experiment), over 14 times the Pb ions present (the starting amount of 0.5 mg). The adsorbent is deployed in large excess to fully suppress the residual heavy metal content. In other words, only a small fraction of the binding sites of the adsorbent will be occupied, which further justifies the first order assumption. The linear plot based on the first five data points yields a of 0.103 min -1 (Fig.  4a ), with the corresponding half-life time being 6.73 mins. The affinity of a sorbent for a target metal is described by the distribution coefficient ( ). The is defined as: = Pb(II) sorbed on sorbent (mg g ) Pb(II) in solution (mg mL ) = -× where is the initial concentration of the metal ion, is the final equilibrium concentration of the metal ion, is the volume of the solution (mL) and is the weight of the sorbent used (g). The Kd values for successive adsorption cycles were calculated to be 9.7×10 4 mL g -1 . Cumulative Pore Volume (cm 3 g -1 
 Supplementary Note 6 Pb(II) sorption isotherm measurement of ZrL3 ) Pore width (Å) Supplementary Fig.  15  DFT analysis on the N2 sorption data of a boiling-water-treated ZrL3sample. QSDFT model was employed to show a major pore of 5.67 Å, a micropore surface of 299.5 m 2 g -1 and a micropore volume of 0.107 cm ) Pore width (Å) Supplementary Fig.  17   Absorbance (a.u) Wavelength (nm) 0 mg ml -1 10 mg ml -1 20 mg ml -1 30 mg ml -1  Supplementary Fig. 19 The current density-voltage (J-V) characteristics curves of the holeand electron-only devices with the device configuration of ITO/PEDOT:PSS/spiro-OMeTAD/MoO3/Ag and ITO/TiO2/PC61BM/BCP/Ag, respectively. n is the slope of linear regions in the curve. The hole mobility of spiro-OMeTAD and electron mobility of PC61BM were calculated to be 1.07 × 10 -7 and 1.19 × 10 -6 m 2 V -1 s -1 , respectively.  Supplementary Fig. 23 The current density-voltage (J-V) characteristics curves of the hole-and electron-only devices based on ZrL3:bis-C60 with the device structure of ITO/PEDOT:PSS/ZrL3:bis-C60/MoO3/Ag and ITO/TiO2/ZrL3:bis-C60/BCP/Ag. n is the slope of linear regions in the curve. The hole and electron mobilities of ZrL3:bis-C60 were calculated to be 3.25 × 10 -9 and 2.19 × 10 -7 m 2 V -1 s -1 , respectively. ) Voltage (V) 10 mg ml -1 20 mg ml -1 30 mg ml -1 a 32 Supplementary Fig.  25  The J-V curves of champion M-PVSC with reverse and forward scans.  Supplementary Fig. 30 The Tauc plot of bis-C60 thin film prepared on glass substrate. Light intensity (mW cm -2 ) !"##$%&%'()*+ ,)-$% . The parameters of PL lifetime by fitting TRPL curves obtained from the samples prepared on quartz substrate. 1.57k B T/q 1.41k B T/q 1 1 0 1 0 0 0.1 1 10 J sc (mA cm -2 ) r-PVSC M-PVSC 1 1 0 1 0 0 0. 
 Supplementary Table 5 Solar cell performance parameters of r-PVSC and M-PVSC extracted from J-V curves.  A comparison between the integrated response under the standard reference spectrum and the response measure under the simulator Device configuration V oc (V) J sc (mA cm -2 ) F F( % ) P C E( % ) r-PVSC 1.177± 0. 
 Efficiency External quantum efficiency (EQE) or incident photons to current efficiency (IPCE) Yes No 
 Yes No The Jsc obtained from J-V measurement is consistent with the Jsc integrated from EQE spectrum. (Fig.  2C, 2D ). For tandem solar cells, the bias illumination and bias voltage used for each subcell Yes No Not relevant. 
 Calibration Light source and reference cell or sensor used for the characterization 
 Yes No Simulated AM 1.5 G irradiation was from solar simulator (EnliTech, SS-F5, Taiwan). A silicon solar cell (with a KG-2 filter) was used as reference cell (see "Methods" section in main text). 
 Statistical analysis of the device performance Yes No Fig.  2F  and Supplementary Fig.  28 . 
 Long-term stability analysis Type of analysis, bias conditions and environmental conditions For instance: illumination type, temperature, atmosphere humidity, encapsulation method, preconditioning temperature 
 Yes No Long-term stability for the cells was measured and analyzed at different conditions including shelf stability in humid air and MPP tracking at elevated temperature in N2-filled glovebox (detailed conditions are described in main text). 1 Department of Chemistry, City University of Hong Kong, Kowloon, Hong Kong.  2  Frontier Institute of Science and Technology (FIST), Xi'an Key Laboratory of Sustainable Energy and Materials Chemistry, Xi'an Jiaotong University, Shanxi, China.  3  Department of Materials Science and Engineering, City University of Hong Kong, Kowloon, Hong Kong.  4  Department of Chemistry, University of California-Irvine, Irvine, CA, USA.  5  Department of Materials Science and Engineering, University of California-Irvine, Irvine, USA.  6  Department of Physics and Astronomy, University of California-Irvine, Irvine, CA, USA.  7  Irvine Materials Research Institute, University of California-Irvine, Irvine, CA, USA.  8  Department of Materials Science and Engineering, University of Washington, Seattle, WA, USA. ✉ e-mail: zhengtao@cityu.edu.hk; zonglzhu@cityu.edu.hk; alexjen@cityu.edu.hk T he certified power conversion efficiency (PCE) of organicinorganic lead halide perovskite solar cells (PVSCs) has reached a new high at 25.2%, which can rival those of market-dominating inorganic photovoltaic technologies, including polycrystalline silicon (p-Si), thin film copper indium gallium selenide and cadmium telluride  [1] [2] [3] [4] [5]  . The demonstrated high PCE indicates that it is no longer a limiting factor for commercializing PVSCs. As such, research efforts in this field have been gradually shifted to focus on the reliability and stability issues of PVSCs under ambient conditions, light soaking and thermal stresses  [6] [7] [8] [9]  . By applying composition and crystal engineering, encapsulation, electrode selections, defect passivation and interfacial modifications, the device lifetime can be prolonged by excluding external environmental tensions  [10] [11] [12] [13]  . Nevertheless, long-term stability of PVSCs under operational conditions has yet to be realized, which remains a critical hurdle to overcome before their large-scale implementation. Moreover, compared to the thermally and chemically stable cadmium telluride having low solubility in water (with a solubility product constant (K sp ) below 10 -30 ) and presenting a lower toxicity threat to the environment, lead (Pb)-containing compounds in perovskites (or degraded perovskites) have a much higher K sp of 10 -8 in rainwater  11, [14] [15] [16]  . Therefore, to improve PVSC operational stability effectively and eliminate/minimize Pb 2+ leakage from the degraded perovskite absorbers, an integrated solution with proper materials and device configurations is required to enable PVSCs for practical applications. Metal-organic frameworks (MOFs) have been recently explored in the perovskite photovoltaic community due to their potential for enhancing photovoltaic performance  [17] [18] [19] [20] [21]  . This stems from the relative ease in tuning their functionalities as a versatile class of well-defined hybrid materials. So far, there are only very few cases that report the use of MOFs in PVSCs, indicating the very embryonic stage of this area. Among the limited studies, MOFs have been applied as scaffolds to template the growth of perovskites or as additives/surface modifiers to passivate the defects of perovskites for enhancing the device performance and stability  18, 21  . However, it is challenging to use a MOF as an efficient charge-transporting layer (CTL) because most of them are quite insulating with low carrier mobilities  19  . Additionally, the MOFs utilized in PVSCs are mostly unfunctionalized prototypes that lack the diverse chemical functionalities needed for integrating with PVSCs. To address these problems, we have developed a simple and effective strategy by applying a 2D conjugated MOF that possesses n-type electrical behaviour and suitable energy levels as an electron-extraction layer (EEL) at the perovskite/cathode interface. The use of Zr(iv) ions to engage selectively the hard carboxyl groups allows dense free-standing thiol arrays to be built around the Zr(iv)oxo cluster to offer steric shielding and stabilization  22, 23  . The dense array of thiol groups on the MOF is particularly important because of their capabilities in rigidifying the networks with crosslinked disulfide linkages and in trapping heavy metal ions (such as lead, mercury and so on). In addition, the thiol-functionalized MOF can also form intimate contact with the silver electrode to extract electrons efficiently from PVSCs by reducing the contact resistance and trapping mobile Pb 2+ ions at the perovskite/electrode interface to mitigate the potential impact of the device on environmental sustainability. 
 Characterization of 2D MOF and perovskite/MOF films As shown in Fig.  1a , a new linker molecule H 3 L3 was first synthesized (Supplementary Figs.  1 2 3 4 ). The peak numbers and assignments Despite the notable progress in perovskite solar cells, maintaining long-term operational stability and minimizing potentially leaked lead (Pb 2+ ) ions are two challenges that are yet to be resolved. Here we address these issues using a thiol-functionalized 2D conjugated metal-organic framework as an electron-extraction layer at the perovskite/cathode interface. The resultant devices exhibit high power conversion efficiency (22.02%) along with a substantially improved long-term operational stability. The perovskite solar cell modified with a metal-organic framework could retain more than 90% of its initial efficiency under accelerated testing conditions, that is continuous light irradiation at maximum power point tracking for 1,000 h at 85 °C. More importantly, the functionalized metal-organic framework could capture most of the Pb 2+ leaked from the degraded perovskite solar cells by forming water-insoluble solids. Therefore, this method that simultaneously tackles the operational stability and lead contamination issues in perovskite solar cells could greatly improve the feasibility of large-scale deployment of perovskite photovoltaic technology. 
 2D metal-organic framework for stable perovskite solar cells with minimized lead leakage Shengfan in the NMR spectra confirmed the molecular structure of the H 3 L3 linker and indicated the high purity of the H 3 L3 sample used for assembling the Zr(iv)-based MOF product, ZrL3. The corresponding polycrystalline framework solid, ZrL3 (Fig.  1b ), was then solvothermally prepared, using ZrOCl 2 •8H 2 O as the metal source, formic acid as the modulator and ethylene dithiol for stabilizing the thiol groups on the organic linker. The peak S-H stretch at around 2,555 cm -1 can be clearly observed from the FT-IR spectra of H 3 L3 and ZrL3 (Supplementary Figs.  5  and 6 ), indicating the successfully installed thiol groups in the ZrL3 networks. The powder X-ray diffraction (PXRD) pattern of as-made ZrL3 (Supplementary Fig.  7 ) can be indexed onto hexagonal unit cells (parameters: a = 19.98 Å, c = 7.24 Å (see Supplementary Note 1). The short c axis suggests a single-layer structure based on Zr 6 O 8 clusters as it compares well with the corresponding interlayer distance in a known structure. Elemental analysis and thermogravimetric analysis (TGA) results fit the formula Zr 6 O 4 (OH) 4 (L3) 2 (OH) 6 (H 2 O) 27 (DMF) (DMF = N,N-dimethylformamide) for ZrL3 (Supplementary Fig.  8  and Note 2). The linker/Zr 6 cluster ratio thus determined suggests full occupancy for the linker sites in ZrL3. The capping sites can be occupied by the formate (HCOO -) and HO -/H 2 O species, but it should be noted that their ratios here cannot be pinpointed by the current data as their small weight fractions do not impact significantly the elemental and TGA results. The morphology, micro and atomic structures of the 2D MOF were also characterized by scanning electron microscopy (SEM) and transmission electron microscopy (TEM). The SEM image of ZrL3 features the morphology of thin platelets with dimensions between 100 and 500 nm (Supplementary Fig.  10 ). The low magnification image, fast Fourier transform and electron diffraction show the distinct hexagonal arrays of the 2D layers in ZrL3, as demonstrated in Supplementary Fig.  11 . Moreover, atomic resolution high angle annular dark field images from aberration corrected scanning transmission electron microscopy indicate the direct (eclipsed) stacking of the MOF layers (Supplementary Fig.  12 ). Individual Zr atoms are seen within the Zr clusters at high magnification. The surface clusters of a thin region were found to be more diffuse compared to the interior. The organic linkers between Zr clusters were seen in the bright field image and the surface of ZrL3 was also shown to be terminated by the organic linkers as in the model (Fig.  1c, d ). TEM studies also suggest superior stability of the 2D networks as ZrL3 was stable under prolonged parallel electron beam radiation (~30 e -Å -2 s -1 ) while imaging. The stability of the ZrL3 lattice is further verified by gas sorption studies and PXRD. The N 2 sorption isotherm (77 K) features dominant type-I characteristics of microporous solids (Fig.  1e ), with additional uptake at high P/P 0 regions that can be attributed to capillary condensation in mesopores (for example, arising from the inter-particle/layer spaces). The Brunauer-Emmett-Teller surface area is calculated to be 528 m 2 g -1 for ZrL3, which agrees with the simulated accessible solvent surface of 594 m 2 g -1 (Supplementary Fig.  13 ). To probe respectively the hydrolytic and thermal stability, ZrL3 was placed in boiling water for 24 hours it was also heated at 100 °C in air for 7 days. The boiling-water-treated sample still showed substantial porosity as per gas sorption studies, even though the surface area was somewhat decreased (369 m 2 g -1 , see also Supplementary Figs.  14  and 15  for the density functional theory analysis of the N 2 sorption data). Moreover, the PXRD pattern of ZrL3 after either boiling-water-treatment or continual heating at 100 °C in air remained strong, indicating the retention of the crystalline phase (Fig.  1f  and Supplementary Fig.  16 ). These results demonstrated the superior moisture and thermal stability of ZrL3. The optical bandgap of ZrL3 was determined and calculated to be 2.53 eV from its ultraviolet-visible (UV-vis) diffuse reflectance spectrum, as shown in Fig.  1g . Additionally, the absorption spectra were also obtained to study the effect of ZrL3 on light harvesting of the perovskite layer (Supplementary Fig.  17 ). No obvious change could be found in the absorption spectra with varied thicknesses of ZrL3 and the bandgap of the mixed-cation (Cs/formamidinium (FA)/methylammonium (MA)) perovskite was calculated to be 1.60 eV from the Tauc plot. The electron-and hole-only devices were fabricated to study the electrical properties of ZrL3 by the space-charge-limited-current method (Supplementary Figs. 18 and 19 and Note 3)  24  . As a result, the electron-and hole-mobilities were calculated to be 2.81 × 10 -7 m 2 V -1 s -1 and 5.36 × 10 -9 m 2 V -1 s -1 , respectively. The relatively higher electron mobility indicated that ZrL3 is more of a n-type material, which would be appropriate for extracting electrons in PVSCs. To investigate the interfacial charge carrier dynamics between perovskite and different EELs, steady-state photoluminescence (PL) and time-resolved photoluminescence (TRPL) spectra were obtained for the perovskite films coated with ZrL3, phenyl-C61-butyric acid methyl ester (PC 61 BM) and PC 61 BM/ZrL3 layers, respectively. As can be seen in Fig.  1h , the pure perovskite film showed the strongest PL intensity due to the efficient radiative recombination of the photogenerated carriers, while it was apparently quenched upon contacting with the EELs. We note that the perovskite film showed substantially quenched PL when it contacted with ZrL3, suggesting efficient charge extraction from perovskite to ZrL3 (ref.  25, 26  ). This phenomenon is further confirmed by the TRPL spectra, as shown in Fig.  1i  and summarized in Supplementary Table  1 . The perovskite/ZrL3 film exhibited biexponential decay with a fast (1.6 ns) and a slow (13.8 ns) component after being excited by a pulsed laser. This decay is much shorter than for the perovskite-only sample (137.8 and 632.8 ns). In addition, the perovskite/PC 61 BM/ZrL3 film exhibited a slightly faster PL decay than the perovskite/PC 61 BM film, which might be attributed to the cascade energy alignment in perovskite/PC 61 BM/ZrL3 (see Supplementary Fig.  20  and Note 4 ). 
 Device architecture and photovoltaic performance The inverted planar PVSCs with the device configuration of indium tin oxide (ITO) glass/poly(triarylamine) (PTAA)/perovskite/ PC 61 BM/EEL/silver (Ag) were fabricated and the corresponding energy alignment is provided in Fig.  2a, b . The device without any EEL showed a relatively low PCE of 18.80% with a fill factor (FF) of 71.21%, which was attributed to the non-ideal electron extraction from PC 61 BM to the electrode and the insufficient hole-blocking ability. Encouragingly, by introducing ZrL3 as the EEL between PC 61 BM and Ag, a much higher FF of 76.42% along with a higher PCE of 20.34% was achieved (Supplementary Figs.  21  and 22 ). These results suggest the enhanced electron extraction and hole-blocking ability originated from ZrL3, which is consistent with the TRPL results. To extract electrons even more efficiently, a bis-C60 surfactant (previously demonstrated to be able to tune the cathode work function for improving electron extraction in both organic photovoltaic devices and PVSCs (ref.  [27] [28] [29] [30]  )) was further incorporated with ZrL3 as a hybrid EEL. Although the mobilities of the ZrL3:bis-C60 hybrid EEL are similar to those of ZrL3, the reduced energy barrier with the cathode will facilitate electron collection (Supplementary Fig.  23 ). As expected, the PCE of the device with the ZrL3:bis-C60 EEL (denoted as M-PVSC) could be further increased to 22.02% with an FF of 81.28%, open-circuit voltage (V oc ) of 1.20 V and negligible hysteresis. This is among the highest values reported for the planar inverted PVSCs (Fig.  2c , Supplementary Figs.  24  and 25  and Table  2 ). The short-circuit current density (J sc ) obtained from the J-V curve matched well with the integrated value from the external quantum efficiency (EQE) (Fig.  2d ), demonstrating the good reliability of the results. The 'champion' (best) cell of M-PVSC was further held at the maximum power point (MPP) with a bias voltage of 1.03 V under continuous 1 sun illumination (AM 1.5G, 100 mW cm -2 ) to obtain a stabilized photocurrent of 20.97 mA cm -2 , which corresponds to a stabilized PCE of 21.60% (Fig.  2e ). More importantly, the efficiency of the encapsulated M-PVSC was certified to be 21.3% by an independent accredited institute (the National Institute of Metrology, China), which is close to the value measured in house (Supplementary Fig.  26 ). To elucidate the potential roles ZrL3 and bis-C60 played in the hybrid EEL for device efficiency, the PVSCs using only bis-C60 as the EEL were fabricated as the reference device (denoted as r-PVSC), which affords a slightly lower PCE of 21.32% than that of M-PVSC (Supplementary Fig.  27  and Table  3 ). The device performance of the PVSCs with different EELs is summarized in Fig.  2f  and Supplementary Tables  3 4 5 . There are no obvious enhancements in V oc and J sc , while the enhanced PCE for M-PVSCs mainly comes from the FF improvements (Supplementary Fig.  28 ). To explore the effect of EEL morphology on the improved FF, atomic force microscopy was employed to characterize the morphology of bis-C60, ZrL3 and ZrL3:bis-C60 prepared on perovskite/PC 61 BM film. The roughness of perovskite/PC 61 BM was slightly reduced from 10.02 to 8.86 nm after coating with bis-C60 (Supplementary Fig.  29) . By contrast, the film roughness of both perovskite/PC 61 BM/ ZrL3 and perovskite/PC 61 BM/ZrL3:bis-C60 films were increased to 36.31 nm and 35.45 nm, respectively and the morphologies of perovskite/PC 61 BM/ZrL3 and perovskite/PC 61 BM/ZrL3:bis-C60 were quite similar. These results implied that the film morphology of hybrid EEL was dominated by ZrL3 and it should not be the reason for the varied FF between the devices with different EELs. Furthermore, given that the hole-blocking ability of the EEL can significantly affect the FF in photovoltaic devices, the energy levels of ZrL3, bis-C60 and ZrL3:bis-C60 were then calculated and are summarized in Supplementary Table  6  (also Supplementary Figs.  30  and  31 and Note 4). It was found that bis-C60 possesses a larger energy barrier for the holes than ZrL3. Therefore, it can potentially provide better hole-blocking ability which is consistent with the higher FF observed in r-PVSC than the devices with ZrL3 EEL alone. On the other hand, it is known that the thiol group can interact with Ag by forming S-Ag bonds, which can reduce the contact resistance at the interface  [31] [32] [33] [34]  . Thus, it is expected that the S-Ag bonds would form between the dense thiol and disulfide groups in ZrL3 and the Ag electrode to enable M-PVSCs to have better EEL-Ag contact than r-PVSCs. This allows M-PVSCs to have lower contact resistance and higher FF, which is consistent with our previous report  33  . Based on these considerations, the high efficiency achieved for M-PVSCs should be mainly attributed to bis-C60, while ZrL3 with the dense thiol groups plays a role in reducing the contact resistance, thus slightly improving the FF. The resultant PVSCs were also characterized by light intensity (I) dependent photovoltage and photocurrent density. Supplementary Fig.  32  shows the linear relationships between J sc and I in double-logarithmic scale and the fitted α values are close to 1, which demonstrates the efficient carrier transport and the few bimolecular recombinations for both devices. Additionally, the slopes were calculated from the semi-natural logarithmic plot of V oc versus I. The M-PVSC exhibited a slightly lower slope (1.41 k B T/q) r-PVSC (1.57 k B T/q), where k B , T and q are Boltzmann's constant, absolute temperature and elementary charge, respectively. These results indicate that the trap-assisted Shockley-Read-Hall recombination is reduced in M-PVSC because of the better contact between ZrL3 and the Ag electrode, which contributes to faster charge extraction in M-PVSC. In a real-use scenario, perovskites and CTLs in a complete PVSC are susceptible to hydration and oxidation due to abundant moisture and an oxygen atmosphere  [35] [36] [37]  . To highlight the superior stability of ZrL3, perovskite/PC 61 BM films were prepared initially on glass and coated with either bis-C60 or ZrL3:bis-C60 hybrid EEL to investigate their ability to protect perovskites against moisture and oxygen. The perovskite/PC 61 BM film with only bis-C60 EEL bleached almost completely after being placed in an ambient environment with a relative humidity (RH) of 75% for over two weeks (Supplementary Fig.  33 ). In sharp contrast, no obvious degradation was observed for the perovskite/PC 61 BM film protected by the ZrL3:bis-C60 hybrid EEL. Besides, the contact angle with a drop of water on top of ZrL3:bis-C60 protected perovskite/PC 61 BM film rose from 68.37 to 81.23° (Supplementary Fig.  34 ), implying ZrL3 can indeed help prevent moisture from penetrating into perovskite film, which is consistent with its enhanced film stability. 
 Long-term device stability To verify the feasibility of using a ZrL3:bis-C60 EEL in enhancing device stability, a comprehensive study was carried out on the encapsulated PVSCs in both humid air and nitrogen atmosphere. The M-PVSC showed superior shelf stability in an ambient environment (with a RH of 75%), maintaining 90% of its initial efficiency after 1,100 hours (Fig.  3a ). By contrast, the PCE of r-PVSC dropped significantly to <50% of its original value. The significantly enhanced stability can be attributed to the strong coordinating ability of Zr(iv) ions and the dense thiol and crosslinked disulfide linkages in ZrL3, which protect perovskites against moisture and oxygen 38 . Long-term operational stability of the devices was tested under a white LED lamp with the light intensity equivalent to 1 sun in a N 2 -filled glovebox (Fig.  3b ). Specifically, the operational stability was tested under an accelerated ageing condition: (1) no UV filter for the light source and (2) the devices were monitored at an elevated temperature of 85 °C to estimate their potential for long-term stability. The ZrL3-incorporated cell was tracked at the MPP and the corresponding PCEs obtained from the J-V curve were constantly monitored during the test (Fig.  3c ). The PCE of M-PVSC only dropped slightly to 92% of its initial value after 1,000 hours of ageing. Thus, M-PVSC is among the most stable inverted PVSCs tested under the MPP tracking condition at 85 °C. Moreover, it is observed that the constantly recorded PCEs from the J-V curves of M-PVSC during MPP tracking showed a similar decay trend, demonstrating the good reliability of the testing (Fig.  3c ). In the literature, small-molecule based CTLs/EELs tend to crystallize and form aggregates under thermal stress. This creates pathways for direct interactions between perovskite and metal electrode and so impairs the device performance  37  . The superior stability of ZrL3 under thermal stress significantly enhanced the thermal stability of M-PVSC, which was further verified by the stability profile of the PVSCs with only ZrL3 as the EEL (Supplementary Fig.  35 ).  
 Lead contamination of PVSCs To probe the possible sources and mechanisms that cause the degradation in our devices, the depth profiles of Pb, Ag and I ions throughout the un-encapsulated PVSCs were investigated by using time-of-flight secondary-ion mass spectrometry (ToF-SIMS) (Fig.  3d, e ). The Pb 2+ signal could be clearly observed to shift towards the Ag electrode through the electron-transporting layer in the r-PVSC after it was aged under the accelerated condition in air (85 °C and 85% RH). This indicates that the perovskite films can be easily decomposed into Pb-containing by-products and ammonium salts under such an aggressive ageing condition, resulting in Pb 2+ diffusion into other layers  35, 39  . Very encouragingly, almost no Pb 2+ ions could be detected in the Ag layer of M-PVSC and they were "trapped" at the ZrL3:bis-C60/Ag interface to form Pb(ii)-ZrL3 complexes. Unlike the physical encapsulation methods used in reducing lead leakage, this in situ chemical adsorption of Pb 2+ by ZrL3:bis-C60 EEL in the device is a much more effective and sustainable process for long-term practical applications (Fig.  3f ). To quantify the adsorption ability of ZrL3 for Pb 2+ ions, sorption kinetics and sorption isotherm measurements were obtained (Fig.  4a ,b and Supplementary Notes 5 and 6). A distribution coefficient K d of around 10 5 ml g -1 , a substantial value of 355 mg g -1 for the Pb adsorption capacity (q max ) and a sorption rate constant (pseudo first-order) of 0.103 min -1 were achieved. These results strongly support the idea that ZrL3 EEL can effectively adsorb Pb 2+ by rapid chemical reactions between thiols and Pb 2+ to minimize the leakage of Pb 2+ ions into the environment. To investigate the lead leakage that occurred in the degraded PVSCs, they were immersed in deionized water with a pH value of ~5.6 (simulating acidic rain) to compare the concentration of water soluble Pb components between M-PVSCs and r-PVSCs, as shown in Fig.  4c . Pb 2+ testing paper was used to perform a quick check on the Pb 2+ concentration in the contaminated water and it was found that the aqueous extracts from the r-PVSC showed a much higher Pb 2+ concentration compared with those of the M-PVSC. An inductively coupled plasma optical emission spectroscopy (ICP-OES) instrument was further used to quantify accurately the Pb 2+ concentrations (Fig.  4d  and Supplementary Fig.  36 ). The Pb 2+ concentration decreased drastically to an average value of 7.6 ppm for M-PVSCs compared to 38.4 ppm for r-PVSCs and 38.1 ppm for pure perovskite film, which means over 80% of the leaked Pb 2+ ions from the degraded perovskite could be captured by thiol-functionalized ZrL3 to form water-insoluble Pb(ii)-ZrL3 complexes. This substantially reduced lead leakage was attributed to the chemical reaction between the dense array of thiol and disulfide groups on ZrL3 with leaked Pb 2+ ions from the degraded perovskites. Although this Pb(ii)-trapping process can be further optimized, our results demonstrate a promising strategy to improve simultaneously PVSC long-term operational stability and reduce/ prevent Pb 2+ leakage into the environment. This will greatly facilitate the large-scale deployment of highly efficient PVSCs for clean energy applications. 
 Conclusion We have developed an effective strategy to address simultaneously the most challenging operational stability and lead contamination issues in PVSCs by incorporating a functionalized 2D MOF as an EEL into a PVSC. The resultant inverted PVSC achieved a high PCE of >22% (a certified value of 21.3%) and substantially improved long-term operational stability. More importantly, the thiol-containing MOF can capture most of the leaked Pb 2+ (over 80%) from degraded PVSCs by forming a water-insoluble complex. These combined results showed the promise of simultaneously realizing stable and environmental-friendly PVSCs through multi-functional MOFs.   
 Synthesis of dimethyl 1,3,5-tris[3′,5′-bis(benzylthio)-4′-(methoxycarbonyl) phenyl] benzene (M3). Molecule S1 (2.00 g, 4.36 mmol), bis(pinacolato)diboron (1.107 g, 4.36 mmol), PdCl 2 (PPh 3 ) 2 (77 mg, 0.11 mmol) and anhydrous potassium acetate (941 mg, 9.59 mmol) were loaded in a 250 ml two neck round-bottom flask and dried under vacuum for 30 min. The flask was then connected to a nitrogen atmosphere. Anhydrous 1,4-dioxane (30 ml, bubbled with nitrogen for 10 min beforehand) was added to the flask. The mixture was stirred at 90 °C for 12 h. After cooling to room temperature, K 3 PO 4 aqueous solution (2.3 M, 5.0 ml bubbled with nitrogen for 10 min beforehand) was added, followed by the addition of 1,3,5-tribromobenzene (400 mg, 1.27 mmol). The mixture was stirred at 90 °C for 12 h. After cooling to room temperature, the mixture was poured into water (400 ml) and extracted with DCM (3 × 100 ml). The combined organic phases were washed with distilled water (3 × 200 ml). The organic phase was then dried over anhydrous MgSO 4 and evaporated with a rotary evaporator. The solid residue obtained was purified by flash column chromatography (eluent: DCM/n-hexane/ ethyl acetate, 1:1:0.01) to obtain M3 as a: white solid (987 mg, 64% yield based on 1,3,5-tribromobenzene);  1    
 Synthesis of 1,3,5-tris[3′,5′-bis(benzylthio)-4′-carboxyphenyl]benzene (MA3). Molecule M3 (485 mg, 0.40 mmol) was dissolved in tetrahydrofuran (7.0 ml) in a 100 ml two neck round-bottom flask, followed by adding KOH solution (8.9 M, 7.0 ml in MeOH/H 2 O, v-v = 1:1). The mixture was stirred at 70 °C for 24 h. After cooling to room temperature, 10% HCl(aq.) was added to the resulting mixture to attain pH < 2. A yellow precipitate formed was filtered, washed extensively with distilled water and suction-dried on a filter paper to afford MA3 as a: brown solid (455 mg, 97% yield based on M1);  1    
 Synthesis of 1,3,5-tris(3′,5′-bimercapto-4′-carboxyphenyl)benzene (H 3 L3). Molecule MA3 (234 mg, 0.20 mmol), anhydrous AlCl 3 (640 mg, 4.80 mmol), dry DCM (17.0 ml) and dry toluene (2.0 ml) were mixed in a reaction tube in a N 2 -filled glove box. After the reaction tube was taken out, the tube was connected to a N 2 manifold and stirred at room temperature for 2 h. Afterwards, 10% HCl (aq., 10 ml, bubbled with N 2 for five min beforehand) was added to the mixture, followed by stirring at room temperature for 2 h. The yellow precipitate formed was collected by suction filtration and washed with 10% HCl (aq.), distilled water, then DCM and dried under vacuum to afford H 3 L3 as a: brown solid (103 mg, 82% yield based on MA3);  1   Polycrystalline framework solid of ZrL3. H 3 L3 (30 mg, 0.048 mmol) and 10 drops of 1,2-ethanedithiol (170 mg, 1.81 mmol) were dissolved in DMF (3.0 ml), while ZrOCl 2 •8H 2 O (92 mg, 0.29 mmol) and formic acid (≥ 88%, 490 mg, 9.37 mmol) were ultrasonically dissolved in another 3.0 ml DMF. The two mixtures were added to a 25 ml Pyrex glass ampoule. The ampoule was flame-sealed and heated in an oven at 120 °C for 48 h, followed by programmed cooling to room temperature for 12 h. The pale brown powder formed was collected by filtration, then washed with DMF (3 ml × 10) and acetone (3 ml × 10) and dried under nitrogen flow for weight measurement (90 mg). The above powder was denoted as as-made ZrL3. Preparation of activated ZrL3. In a nitrogen-filled glovebox, an as-made ZrL3 sample (~80 mg) and DMF (~8 ml) were added to a 15 ml glass vial and heated at 60 °C for 12 h. After cooling to room temperature, the supernatant was replaced with fresh DMF (~8 ml) and heated at 60 °C for 12 h. The above solvent exchange and heating procedures were repeated three times. After that, the above activation procedure was repeated using CH 3 CN. The vacuum-dried powder was denoted as activated ZrL3. Elemental analysis found (C (26.70%), H (4.286%), N (0.47%)) and a fitting formula can be determined to be Zr 6 O 4 (OH) 4 (L3) 2 (OH) 6 (H 2 O) 27 (DMF) (molecular mass 2,596.45), which gives a calculated profile as (C (26.37%), H (3.92%), N (0.54%), S (14.82%), Zr (21.08%)). The activated ZrL3 sample was also characterized by TGA in both N 2 and air flows (Supplementary Fig.  8 , see also Supplementary Fig.  9  for an informative comparison of TGA data). The TGA measurement conducted in an air flow showed 25.1% ZrO 2 residue, equivalent to a Zr content of 18.6%. Both TGA and elemental analysis results agree with the evacuated, dehydrated formula Zr 6 O 8 (C 27 H 15 O 6 S 6 ) 2 O (molecular mass 1947). Boiling-water-treatment of ZrL3. To a 100 ml round-bottom flask charged with a stirring bar, an activated ZrL3 sample (120 mg) and deionized water (30 ml) were added and the mixture was refluxed (using an oil bath at 120 °C) for 24 h. After cooling to room temperature, the resultant MOF solid was collected by filtration and dried under vacuum at 105 °C for 12 h. The above powder was denoted as boiling-water-treated ZrL3. Perovskite solar cell fabrication. The pre-patterned ITO (15 Ω sq -1 ) glass substrates were sequentially cleaned by sonication with detergent (Decon 90/ deionized water, v/v = 1:1), deionized water, acetone and IPA for 15 min, respectively. The cleaned ITO glass substrates were then transferred into an oven at a temperature of 100 °C and treated with O 2 plasma for 10 min before use. Then, the hole-transporting layer, that is, 10 mg ml -1 PTAA in toluene (doped with 1 wt% of 2,3,5,6-tetrafluoro-7,7,8,8-tetracyanoquinodimethane (F4-TCNQ)), was spin-coated onto the ITO glass substrate at 4,000 rpm for 30 s and this was subsequently annealed at 150 °C for 10 min. After cooling for 5 min, the mixed-cation perovskite film was then deposited on PTAA by a one-step spin-coating method. The perovskite precursor solution was prepared by mixing CsI, FAI, MABr, PbI 2 and PbBr 2 in DMF/DMSO (v/v = 5:1) to a chemical formula of Cs 0.05 (FA 0.85 MA 0.15 ) 0.95 Pb(I 0.85 Br 0.15 ) 3 . Considering the poor wetting ability of the PTAA surface, 50 μl DMF was first spun onto the PTAA layer to improve the wetting ability before depositing the perovskite layer. Then, 60 μl of perovskite precursor solution was spin-coated on PTAA at 1,000 rpm for 10 s and 5,000 rpm for 30 s. During the second step, 110 μl CB as anti-solvent was quickly dripped onto the centre of the perovskite film 15 s before the end of the spin-coating process and then annealed at 60 °C for 5 min and 100 °C for 30 min. The electron-transporting layer, that is PC 61 BM (20 mg ml -1 in CB), was spun onto the perovskite layer with a speed of 2,000 rpm for 30 s, followed by annealing at 90 °C for 10 min. As for the devices with a MOF EEL, ZrL3 solution was first prepared by dispersing ZrL3 into IPA at different concentrations followed by ultrasonication and stirring. Then, the ZrL3 (or ZrL3 doped with 10 wt% of bis-C60) solution was spun onto the PC 61 BM layer at a speed of 2,000 rpm for 60 s. For the reference devices, bis-C60 (2 mg ml -1 in IPA) was spun onto the PC 61 BM with a speed of 2,000 rpm for 30 s. All the spin-coating processes were conducted in a N 2 -filled glovebox with contents of O 2 and H 2 O < 1 ppm at a controlled temperature of 20-25 °C. Finally, 120 nm Ag was thermally evaporated in a high vacuum chamber (<5 × 10 -6 Torr) through a metal shadow mask (aperture area of 0.13 cm 2 is defined by the overlap between the pre-patterned ITO and the back metal electrode). Characterizations and measurements. Elemental analysis was performed with a Vario EL III CHN elemental analyser. Infrared spectra in the range 400-4,000 cm -1 were recorded on a Nicolet Avatar 360 FT-IR spectrophotometer. Solution 1 H NMR and 13 C NMR spectra were recorded at room temperature on Bruker superconducting-magnet high-field NMR spectrometers with working frequencies of 300 and 400 MHz, using tetramethylsilane as the internal standard. Chemical shifts (δ) are expressed in ppm relative to the residual solvent reference (for example chloroform-d 1 H: 7.26 ppm, 13 C: 77.0 ppm). Coupling constants are expressed in hertz. TGA was carried out in a nitrogen or air stream using Perkin Elmer thermal analysis equipment (STA 6000) with a heating rate of 2 °C min -1 , with an empty Al 2 O 3 crucible being used as the reference. The porosity and surface area analyses were performed using a Quantachrome Autosorb iQ gas sorption analyser. Samples were outgassed at 0.03 Torr with a 2 °C min -1 ramp to 120 °C and held at 120 °C for 12 h. The samples were then held in vacuum until the analyses started to run. Pore analysis was performed using N 2 at 77.35 K (P/P 0 25.1% x (1947/123.2x6) = 25.1% x 2.63 = 66.0%. The preceding stage of weight loss starts from the weight fraction of 88.5% at 180 ℃ (to 66% at 400 ℃); this weight fraction (88.5% at 180 ℃) is consistent with the formula Zr6O4(OH)4(L3)2(OH)6(H2O)27(DMF) (mw 2596): 25.1% x (2596/123.2x6) = 88.1%. This formula is also supported by CHN elemental analysis: found [C (26.70 %), H (4.286 %), N (0.47 %)]; calculated: [C (26.37 %), H (3.92 %), N (0.54%)]. The 27 water molecules of this formula are closely trapped in the cavities of the MOF matrix; the trapping of these water molecules are strengthened by being coordinated to the Zr(IV) centers, and by extensively 
 4 .Fig. 8 48 Lead(II) acetate solutions of various Pb(II) concentrations(10, 25, 50, 100, 250, 500, 750 and 1000 mg L -1 ) were prepared using D.I. water, and used in the following adsorption procedure. An activated sample of ZrL3 (5.0 mg) was added to each centrifuge tube containing Pb(II) solution (5.0 mL) with different concentrations. The mixtures were stirred at room temperature for 18 hours. The MOF solids were separated by centrifugation and the supernatant was filtered through a 0.22-µm membrane and analyzed using ICP-OES to determine the remaining Pb(II) content. The saturated Pb adsorption capacity () is calculated by the following mathematical expression: -1 ) is the sorption capacity at equilibrium state, (mg L -1 ) is the Pb concentration remaining in the solution at equilibrium state and (L mg -1 ) is a constant related to binding site affinity. Values for (355 mg g -1 ) and can be obtained from the slope and y-intercept, respectively, by plotting / versus , as shown in Fig.SupplementaryThe TGA plot for an activated ZrL3 sample in (a) an N2 atmosphere and (b) in an air flow. The flattened curve in b indicates the conversion of ZrL3 into residual ZrO2(Please refer to Supplementary Note 2 for detailed analysis.). 14 DFT analysis on the N2 sorption data of an activated ZrL3 sample.QSDFT model was employed to show a major pore of 5.45 Å, a micropore surface of 442.3 m 2 g - 1 and a micropore volume of 0.162 cm 3 g -1 . 
 (a) UV-vis spectra of perovskite/PC61BM/ZrL3 with different concentration of ZrL3. (b) The Tauc plot of the perovskite film. 
 Supplementary Fig. 20 20 Cyclic voltammetry (CV) curve of ZrL3 thin film. 
 Supplementary Fig. 24 24 The J-V curves of perovskite solar cells based on ZrL3:bis-C60 EEL with different concentrations. 
 a 28 28 Supplementary Fig.27 (a) The champion J-V curves of r-PVSC and (b) the corresponding hysteresis behavior. Statistics of key photovoltaic parameters obtained from the J-V characteristic for 30 r-PVSC and M-PVSC. 
 . 32 32 Photon enegy (eV) 
 Fig. 2D. Fig. 2D. 
 Wu 1 , 1 Zhen Li 1 , Mu-Qing Li 1,2 , Yingxue Diao 1,3 , Francis Lin 1 , Tiantian Liu 1 , Jie Zhang 1 , Peter Tieu 4 , Wenpei Gao 5 , Feng Qi 1 , Xiaoqing Pan 5,6,7 , Zhengtao Xu 1 ✉ , Zonglong Zhu 1 ✉ and Alex K.-Y. Jen 1,3,8 ✉ 
 Fig. 1 | 1 Fig. 1 | Characterization of ZrL3 and the perovskite films with different eeLs. a, The thiol-decked carboxyl linker H 3 L3. b, Structural model of corresponding 2D MOF ZrL3. c, bright field image. d, Model of ZrL3. e, N 2 sorption isotherm at 77 K and brunauer-Emmett-Teller plot (insets) for the activated ZrL3 before (left) and after (right) boiling-water-treatment. f, PXRD patterns of ZrL3. g, UV-vis diffuse reflectance spectrum of the as-made ZrL3. h,i, PL (h) and TRPL (i) spectra of the perovskite films with different EELs. 
 Fig. 2 | 2 Fig. 2 | Device structure and performance of the PVSCs with ZrL3:bis-C60 eeL. a, Device structure of inverted PVSC. b, Energy level alignment of the used materials. c, J-V curve of the champion PVSC with ZrL3:bis-C60 EEL. d, EQE spectrum and integrated current density of the champion PVSC with ZrL3:bis-C60 EEL. e, Stabilized power output at the MPP for the PVSC with ZrL3:bis-C60 EEL. f, PCE histogram obtained from 30 PVSCs with ZrL3:bis-C60 EEL. 
 Fig. 3 | 3 Fig. 3 | Long-term stability studies for the PVSCs with bis-C60 (r-PVSC) or ZrL3:bis-C60 (M-PVSC) eeL. a, Shelf stability of the encapsulated PVSCs in humid air with RH of 75%. b, Long-term operational stability of the encapsulated PVSCs under MPP tracking at 85 °C under continuous light irradiation with a white LED lamp (100 mW cm -2 ) in a N 2 -filled glovebox. c, PCEs constantly recorded from the J-V curves of M-PVSC during MPP tracking. d,e, ToF-SIMS depth profiles of the pristine (d) and aged (e) PVSCs with bis-C60 (left) or ZrL3:bis-C60 (right) EEL. f, Schematic of degradation process of PVSCs and the immobilization effect of ZrL3 on leaked Pb 2+ ions. 
 Fig. 4 | 4 Fig. 4 | Lead contamination of the PVSCs with bis-C60 (r-PVSC) or ZrL3:bis-C60 (M-PVSC) eeL. a, Pb(ii) sorption kinetics of an activated ZrL3 sample (20.0 mg) at an initial Pb(ii) concentration of 10.0 ppm. The two insets are the corresponding absorbed Pb(II) amount and the Lagergren first-order kinetic plot of the Pb(II) sorption, respectively. b, Pb(ii) Langmuir sorption isotherm of the activated sample of ZrL3. The inset is the linear fit with the Langmuir adsorption model. c, Degraded PVSCs with bis-C60 (r-PVSC) or ZrL3:bis-C60 (M-PVSC) EEL are immersed into the deionized water with a pH value of ~5.6 and Pb ion testing paper is used to quickly detect the Pb concentration in the contaminated water. d, Pb concentration in the contaminated water was accurately detected by ICP-OES measurements. 
 
 
 3 g -1 . a b 200 fitted volume measured volume 2000 ) g -1 2 uptake (cm 3 100 150 dS(d) 1500 1000 Pore width (Mode) = 5.67 Å N 50 Fitting error = 0.449% 500 0 0 0.0 0.2 0.4 0.6 0.8 1.0 4 6 8 1 0 1 2 1 4 1 6 1 8 2 0 P/P 0 Pore width (Å) c d g -1 ) 400 Micropore surface area = 299.5 m 2 g -1 g -1 Micropore volume = 0.107 cm 3 g -1 Cumulative Surface Area (m 2 100 200 300 Cumulative Pore Volume (cm 3 0.04 0.08 0.12 0 0.00 4 6 8 1 0 1 2 1 4 1 6 1 8 2 0 4 6 8 1 0 1 2 1 4 1 6 1 8 2 0 Pore width (Å) 
 The starting materials, reagents and solvents for MOF synthesis were purchased from commercial sources, including J&K, Sigma-Aldrich and Anaqua and were used without further purification. Caesium iodide (CsI), formamidinium iodide (FAI) and methylammonium bromide (MABr) were purchased from Dysol. Lead iodide (PbI 2 ) and lead bromide (PbBr 2 ) were purchased from TCI. Phenyl-C61-butyric acid methyl ester (PC 61 BM) was purchased from ADS. Nature NaNotechNology Articles Methods Materials. Poly[bis(4-phenyl)(2,4,6-trimethylphenyl) amine] (PTAA) and bathocuproine (BCP, purity of 99.9%) were purchased from Xi'an Polymer Light Technology Corporation. The solvents, including DMF, dimethyl sulfoxide (DMSO), isopropanol (IPA) and chlorobenzene (CB) were purchased from J&K and used as received. Toluene was purchased from Tian Hang Technology Co., Ltd. Silver with high purity was purchased from commercial sources. Synthesis of methyl 2,6-bis(benzylthio)-4-bromobenzoate (S1). 4-Bromo- 2,6-difluorobenzoic acid (4.74 g, 0.02 mol) and potassium carbonate (27.6 g, 0.20 mol) were loaded in a 250 ml two neck round-bottom flask. N-Methyl- 2-pyrrolidone (100 ml) was added to the flask and the mixture was stirred and bubbled with nitrogen at room temperature for 30 min. Benzyl mercaptan (6.0 ml, 0.05 mol) was then added to the mixture under nitrogen. The mixture was stirred at 80 °C for 4 days. After cooling to room temperature, methyl iodide (3.0 ml, 48.19 mmol) was added to the mixture and the mixture was stirred at room temperature for 30 min. The resulting mixture was poured into distilled water (800 ml) and extracted with dichloromethane (DCM) (3 × 200 ml). The combined organic layer was dried over anhydrous MgSO 4 , evaporated on a rotary evaporator and purified by column chromatography (eluent: DCM/hexane, 1:5) to afford S1 as a: white solid (6.96 g, 76% yield based on 4-bromo-2,6-difluorobenzoic acid); 1 H NMR (300 MHz, CDCl 3 ): δ = 7.34-7.18 (m, 12H), 4.05 (s, 4H), 3.91 (s, 3H) ppm; 13 C NMR (75 MHz, CDCl 3 ): δ = 167.35, 138.72, 136.35, 135.67, 133.41, 129.23, 128.69, 127.70, 123.22, 52.70, 40.48 ppm. 
 H NMR (300 MHz, DMSO-d 6 ): δ = 7.55 (s, 6H), 7.52 (s, 3H), 7.16-7.26 (m, 18H), 7.32-7.35 (m, 12H), 4.35 (s, 12H) ppm; 13 C NMR (75 MHz, DMSO-d 6 ): δ = 168.25, 140.59, 140.33, 138.13, 137.19, 133.64, 129.09, 128.45, 127.23, 125.52, 37.95 ppm. 
 H NMR (400 MHz, acetone-d 6 ): δ = 8.01 (s, 3H), 7.78 (s, 6H) ppm; 1 H NMR (400 MHz, DMF-d 7 ): δ = 8.11 (s, 3H), 7.96 (s, 6H) ppm; 13 C NMR (100 MHz, DMF-d 7 ): δ = 169.14, 142.78, 141.27, 137.32, 129.61, 127.05, 126.85 ppm. 
			 NATure NANOTeChNOLOGY | VOL 15 | NOVEMbER 2020 | 934-940 | www.nature.com/naturenanotechnology 
			 © The Author(s), under exclusive licence to Springer Nature Limited 2020 NATure NANOTeChNOLOGY | VOL 15 | NOVEMbER 2020 | 934-940 | www.nature.com/naturenanotechnology 
			 NATure NANOTeChNOLOGY | www.nature.com/naturenanotechnology