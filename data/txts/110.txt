Paper #: 110


Note S1. A quantitative analysis of the TRPL. For the interpretation of the TRPL data in Fig.  1b , we fitted the TRPL curves at t > 200 ns with a model described in a previous work (1). For the modelling we assumed a mobility of 1 cm/s. Since it is impossible to distinguish between surface and bulk recombination, we modelled two extreme cases. In the first case we assumed zero surface recombination, i.e. the decay is solely caused by bulk recombination with a fitted bulk recombination constant k1 = 3.5•10 5 s -1 for the reference and 2.3•10 5 s -1 for the Fo-FAPbI3 sample. In the second case we assumed that the PL decays of both samples are dominated by surface recombination, with a surface recombination velocity S fitted as 13.9 cm/s for the Fo-FAPbI3 and 21.3 cm/s for the reference sample. Both cases gave the same fit curves as shown in Fig.  1b . These results show that the formate treatment reduces the non-radiative recombination rate significantly by either reducing bulk or surface recombination. 
 Note S2. DFT calculations of the formation energy. We constructed 12 and 24 formula unit (f.u.) supercells of α-FAPbI3 and a hypothetical FAPb(HCOO)3. In order to create the formate analogue of the cubic perovskite phase, we took inspiration from the published literature on formate based perovskites (2). The FAPb(HCOO)3 perovskite structure was thus constructed by taking the perovskite structure of formamidinium manganese formate (3) as an initial template and replacing the manganese ion with the lead (Pb 2+ ) ion. After this, the structure was relaxed with DFT. The formation energies of both cubic perovskite phases, FAPbI3 and FAPb(HCOO)3 were calculated with respect to the precursor phases. For α-FAPbI3, we chose PbI2 and FAI as precursors: EFAPbI₃ = E[FAPbI3] -E[FAI] -E[PbI2] , while for FAPb(HCOO)3 we chose lead formate (Pb(HCOO)2) and formamidinium formate (FAHCOO) as precursors: EFAPb(HCOO)₃ = E[FAPb(HCOO)3] -E[FAHCOO] -E[Pb(HCOO)2]. Here, E is the total energy of the respective fully relaxed phases calculated with DFT. The formate based precursor structures were taken from the Cambridge Crystallographic Structural Database (4-6). All calculations were performed at 0 K, without considering thermal effects. The resulting formation energy of the 144 atoms supercell (12 f.u.) of α-FAPbI3 is ca. +0.15 eV/f.u., while the formation energies of the 252 atoms supercell (12 f.u.) of cubic FAPb(HCOO)3 is ca. +0.26 eV/f.u., showing that the formation energy increased by replacing iodide anions with formate anions on the α-FAPbI3 lattice. Taking into account possible finite size effects, we also compared the formation energies of 24 f.u. supercells of α-FAPbI3 (288 atoms) and cubic-FAPb(HCOO)3 (504 atoms) and found that the formation energy increased similarly. Furthermore, we also highlight the fact that the effective ionic radius of the formate anion is 136 pm, i.e. even smaller than the one of chloride anion (181 pm) that is known not to mix with FAPbI3. Therefore, we conclude that formate anions cannot be doped into the cubic lattice of α-FAPbI3. Computational details: we performed variable cell Kohn-Sham DFT calculations of all structures within the Generalized Gradient Approximation (GGA) in the form of the Perdew-Burke-Ernzerhof (PBE) (7) exchangecorrelation functional with Grimme D3 dispersion corrections (8). We used Quantum Espresso (9) with ultra-soft pseudo-potentials for valence-core electron interactions and a plane wave basis set with a 60 Ry kinetic energy cutoff and a 480 Ry density cutoff. The Brillouin zone for the 144 atoms supercell of α-FAPbI3 was sampled by a 1x1x2 k-point grid, the 108 atoms supercell of FAI by 1x1x2 k-points grid, for the 36 atoms supercell of PbI2 by 2x2x2 k-points, for the 252 atom supercell of FAPb(HCOO)3 by 1x2x1 k-point grid, the 144 atom supercell of FAHCOO by 1x2x2 k-points and the 108 atom supercell of Pb(HCOO)2 by 1x2x2 k-points. Reference crystal structures for DFT calculations: CCDC reference: 1861266 -Formamidinium formate (FAHCOO) CCDC reference: 925259 -Lead formate (Pb(HCOO)2) CCDC reference: 1538402 -Formamidinium iodide (FAI) We note that MD simulations were performed to understand the crystallization mechanism of perovskite from precursor solutions with and without formamidinium formate addtive, while OAI was used as a post-treatment of the crystalline perovskite film to passivate the surface defects. Therefore, OAI was excluded from the MD simulations in this study. 
 Note S3. Quantification of MA in the 2% Fo-FAPbI3 film. To quantify the amount of MA in the sample, the resonances in Extended Data Fig.  2e  were integrated. The NMR signal of the FA includes two spinning sidebands, which are added to the integration of the central FA peak. The percentage of MA relative to FA is then calculated from the ratio of the integrated NMR intensities, noting that a quantitative recycle delay of >5× the longest T1 relaxation constant was used. Quantification of MA:  
 Note S4. Ab-initio MD of homogeneous mixture of ions at pre-nucleation stage: We performed constant temperature and constant pressure (NPT) Born-Oppenheimer MD (BOMD) simulations of a homogeneous mixture of ions: 6 Pb 2+ , 9 I -, 9 HCOO -, 6 FA + in 4 dimethyl sulfoxide (DMSO) and 16 dimethylformamide (DMF) molecules. All simulations were performed at DFT level (PBE+D3) (7,8) as described in the methods section. These simulations show that formate ions coordinate strongly with Pb 2+ ions (Extended Data Fig.  3a , b and Supplementary Video [1]) which might help in avoiding formation of δ-phase at the prenucleation stages. Furthermore, this coordination also slows down the growth process, which helps in the formation of larger stacked grains. Computational details: BOMD was performed with the CP2K package (10,11). We used a time step of 1 fs, a Nose-Hoover chain thermostat (12) for controlling the temperature at 300 K and the barostat by Martyna et al. (13) for pressure control at 1 atm. All simulations used DFT at the PBE+D3 (7,8) level with double-zeta basis sets (DZVP-MOLOPT for Pb, I, S, C, N, H) (  14 ) and Goedecker-Teter-Hutter (GTH) pseudopotentials (15) with a 560 Ry density cut-off. 
 Note S5. Passivation effects of HCOO -anions: Comparison of HCOO -passivation strength with other anions at I -vacancy on surface: To understand the benefits of the surface passivation with formate anions, we created an I -vacancy (only one) at the surface and compared the binding affinities of different anions to this vacant site. We selected I -, Cl -, Br -, BF4 -and HCOO -. At first, different anion passivated structures were relaxed at the DFT level with variable-cell optimization as described in the following computational details. All of the DFT relaxed slabs are shown in Extended Data Fig.  4a  to f. To estimate the relative binding strength the adsorbed anions were moved in the z-direction away from the surface as shown in Extended Data Fig.  4f . DFT energies were calculated for each structure along this desorption profile. The resulting energy profiles shown in Fig.  2d  were calculated relative to the energy of the respective original (fully bound) configurations. Computational details: First, we constructed a 324 atoms slab structure of cubic phase FAPbI3 with more than 15 Å empty space in the z-direction. Four more structures were constructed from this slab by replacing one I -from the surface with four different anions: Br -, Cl -, BF4 -and HCOO -on the FA-I and Pb-I terminated interfaces of the slab. We then performed variable cell Kohn-Sham DFT calculations of these five different structures with the Generalized Gradient Approximation (GGA) for the exchange-correlation functional in the form of Perdew-Burke-Ernzerhof (PBE) (7) with Grimme D3 (8) dispersion corrections. We used Quantum Espresso (9) with ultra-soft pseudo-potentials for valence electron-core interactions with a plane wave basis set of 60 Ry kinetic energy cutoff for the wavefunctions and 480 Ry density cutoff. The Brillouin zone was sampled by a 2x2x1 kpoints for every structure. There is a possibility of I -vacancy passivated (by Br -, Cl -, BF4 -and HCOO -) on either Pb-I terminated surfaces (Extended Data Fig.  4g ) or FA-I terminated surfaces (Extended Data Fig.  4h ). The relative binding strength shown in Fig.  2d  are calculated on the Pb-I interfaces at a z-distance of ~4Å. Systematic comparison of the relative binding strength of FA + cations on different passivated surfaces: To further understand effects of the surface/grain boundaries passivation with HCOO -anions, we also performed a systematic comparison of the desorption energies of FA + cations from surfaces passivated with different anions: I -, Cl -, Br -, BF4 -and HCOO -. To this end, different anion passivated structures were constructed and subsequently relaxed with DFT level variable-cell optimization as described in the computational details. All of the DFT relaxed slabs are shown in Extended Data Fig.  5a  to f. Then one FA + cation from surface was selected and moved to increasing distances along the z-direction. DFT energies were calculated for each structure along this desorption profile. The resulting energy profiles (at a distance of ~4Å) shown in the Extended Data Fig.  5g  were calculated relative to the energy of the respective original (fully bound) configurations. Computational details: First, we constructed a 240 atoms (2x2x5) slab of cubic phase FAPbI3 with more than 15 Å empty space in the z-direction. Four more different structures were made from this slab by replacing surface I - with four different anions: Br -, Cl -, BF4 -and COOH -on the FA-I terminated interface of the slab as depicted in Extended Data Fig.  5a  to f. We then performed variable cell Kohn-Sham DFT calculations of these five different structures with the Generalized Gradient Approximation (GGA) for the exchange-correlation functional in the form of Perdew-Burke-Ernzerhof (PBE) (7) with Grimme D3 (8) dispersion corrections. We used Quantum Espresso (9) with ultra-soft pseudo-potentials for valence electron-core interactions with a plane wave basis set of 60 Ry kinetic energy cutoff for the wavefunctions and 480 Ry density cutoff. The Brillouin zone was sampled by a 2x2x1 k-points for every structure. Ab-initio MD of formate ions on the surface of FAPbI3: To further understand the passivation effect of HCOO - anions, we also performed DFT level MD simulations. In the absence of an experimentally determined atomistic structure for formate passivated surface or grain boundaries, we started with a plausible passivated structure of FAPbI3. In this computational experiment, we first created a 684 atoms slab (vacuum on both sides) of α-FAPbI3 with two-different terminated sides ie. with a cut through a FA-I plane on one side and through a Pb-I plane on the other side. Then we fully replaced the outmost surface layers of I -anions with HCOO -anions. This final configuration is shown in Extended Data Fig.  3c  to e. In the case that formate anions passivate the iodide defects, these are the two possible configurations that can be present at the perovskite-HTM interface or grain boundaries. For this structure, we performed constant temperature and constant volume (NVT) Born-Oppenheimer molecular dynamics (BOMD) simulations. We ran ~12 ps BOMD with a similar set-up as defined above. Atomic representations of these simulations are shown in Supplementary Videos [2] and [3]. 
 Note S6. Explanation of the Supplementary Videos: Supplementary Video [1]: This video is generated from ab-initio MD of the precursor solution with formate anions, as described above in note S2. Here we show the coordination of HCOO -anions with Pb 2+ cations at the prenucleation stage. To guide the eyes, we only chose to show the HCOO -and Pb 2+ ions while the rest of the ions and solvent molecules are omitted for clarity. Pb 2+ ions are shown with large brown coloured spheres, oxygen atoms with red, carbon atoms with light blue and hydrogen atoms are represented with white spheres. Supplementary Video [2]: This video is generated from ab-initio MD of HCOO -passivated FA-I terminated interface of FAPbI3. This is also shown in Extended Data Fig.  3a , b and explained in note S3. Here we show that FA + cations on the interface are strongly coordinated with their neighbouring HCOO -anions. Oxygen atoms are shown with red, carbon with light blue, nitrogen with dark blue and hydrogen atoms are represented with white balls. Supplementary Video [3]: This video is generated from ab-initio MD of HCOO -passivated Pb-I terminated interface of FAPbI3. This is also shown in Extended Data Fig.  3a , b and explained in note S3. Here we show that Pb + cations on the interface are strongly coordinated with their neighbouring HCOO -anions. Pb 2+ ions are shown with yellow balls, oxygen with red, carbon with light blue and hydrogen atoms are represented with white balls. Supplementary Video [4]: A description of the perovskite fabrication process. 
 Pseudo-halide anion engineering for α-FAPbI 3 perovskite solar cells Metal halide perovskites of the general formula ABX 3 -where A is a monovalent cation such as caesium, methylammonium or formamidinium; B is divalent lead, tin or germanium; and X is a halide anion-have shown great potential as light harvesters for thin-film photovoltaics  [1] [2] [3] [4] [5]  . Among a large number of compositions investigated, the cubic α-phase of formamidinium lead triiodide (FAPbI 3 ) has emerged as the most promising semiconductor for highly efficient and stable perovskite solar cells  [6] [7] [8] [9]  , and maximizing the performance of this material in such devices is of vital importance for the perovskite research community. Here we introduce an anion engineering concept that uses the pseudo-halide anion formate (HCOO -) to suppress anion-vacancy defects that are present at grain boundaries and at the surface of the perovskite films and to augment the crystallinity of the films. The resulting solar cell devices attain a power conversion efficiency of 25.6 per cent (certified 25.2 per cent), have long-term operational stability (450 hours) and show intense electroluminescence with external quantum efficiencies of more than 10 per cent. Our findings provide a direct route to eliminate the most abundant and deleterious lattice defects present in metal halide perovskites, providing a facile access to solution-processable films with improved optoelectronic performance. Perovskite solar cells (PSCs) have attracted much attention since their first demonstration in 2009  [1] [2] [3] [4] [5]  . The rapid expansion of research into PSCs has been driven by their low-cost solution processing and attractive optoelectronic properties, including a tunable bandgap  6  , high absorption coefficient  10  , low recombination rate  11  and high mobility of charge carriers  12  . Within a decade, the power conversion efficiency (PCE) of single-junction PSCs progressed from 3% to a certified value of 25.5%  13  , the highest value obtained for thin-film photovoltaics. Moreover, through the use of additive and interface engineering strategies, the long-term operational stability of PSCs now exceeds 1,000 hours in full sunlight  14, 15  . PSCs therefore show great promise for deployment as the next generation of photovoltaics. Compositional engineering plays a key part in achieving highly efficient and stable PSCs. In particular, mixtures of methylammonium lead triiodide (MAPbI 3 ) with formamidinium lead triiodide (FAPbI 3 ) have been extensively studied  5, 7  . Compared to MAPbI 3 , FAPbI 3 is thermally more stable and has a bandgap closer to the Shockley-Queisser limit  6  , rendering FAPbI 3 the most attractive perovskite layer for single-junction PSCs. Unfortunately, thin FAPbI 3 films undergo a phase transition from the black α-phase to a photoinactive yellow δ-phase below a temperature of 150 °C. Previous approaches to overcome this problem have included mixing FAPbI 3 with a combination of methylammonium (MA + ), caesium (Cs + ) and bromide (Br -) ions; however, this comes at the cost of blue-shifted absorbance and phase segregation under operational conditions  [7] [8] [9] 16  . Nevertheless, α-FAPbI 3 has recently emerged as the candidate of choice for highly efficient and stable PSCs  9, 17, 18  . We have previously prepared α-FAPbI 3 by spin-coating a precursor solution of FAPbI 3 mixed with excess methylammonium chloride (MACl), and achieved a certified efficiency of 23.48% for the resulting mesoporous FAPbI 3 PSC  17  . By fully exploiting the absorption spectrum of FAPbI 3 together with proper light management, a certified efficiency of 23.73% was reported  18  -approaching the theoretical maximum-with a short-circuit current density (J sc ) of 26.7 mA cm -2 . However, the open-circuit voltage (V oc ) of around 1.15 V for FAPbI 3 PSCs still lags behind the radiative limit  9, 18  , which suggests that more work is needed to further reduce the density of defects in the FAPbI 3 perovskite films to suppress the non-radiative recombination of charge carriers. Bromide, chloride (Cl -) and thiocyanate (SCN -) anions have commonly been used to improve the crystallinity and stability of perovskite films  8, 9, 11, [17] [18] [19] [20] [21] [22]  . Another pseudo-halide anion, formate (HCOO -), has also been investigated in connection with MAPbI 3 PSCs  [23] [24] [25] [26]  . Two studies  23, 24  reported that MAHCOO improves the quality of MAPbI 3 films by controlling the growth of the perovskite crystals, while others  25, 26  reported that formic acid accelerates the crystallization of perovskites based on MA cations. Previous work has therefore mainly dealt with the effect of formate on the morphology, nucleation and growth of MAPbI 3 . There has also been a recent report of a highly fluorescent methylammonium lead bromide and formate mixture in water  27  . However, a fundamental understanding of the effects of formate on perovskite films has yet to be achieved. Here we uncover the key role of HCOO -anions in removing halide vacancies, which are the predominant lattice defects in FAPbI 3 perovskite films. This enables the PCE of the PSC to exceed 25%, combined with a high operational stability and external quantum efficiency (EQE) of electroluminescence (EQE EL ) that exceeds 10%. Iodide vacancies are also the principal cause of the unwanted ionic conductivity of metal halide perovskites, which has deleterious effect on their operational stability. We provide insight into the mode of formate intervention. Formate is small enough to fit into the iodide vacancy  22  , thereby eliminating a prevalent and notorious defect in the metal halide perovskite that accelerates the non-radiative recombination of photogenerated charge carriers, in turn decreasing both the fill factor and the V oc of a solar cell. We generated FAPbI 3 perovskite films with improved crystallinity and larger grain size by introducing 2% formamidine formate (FAHCOO) into the precursor solution. The defect passivation and the improved crystallinity are essential to attain the levels of efficiency and stability that are demonstrated by our FAPbI 3 -based PSCs. 
 Characterization of the perovskite films The reference FAPbI 3 film, hereafter denoted 'reference', was prepared as previously reported using a precursor solution containing a mixture of FAPbI 3 powder with 35 mol% additional MACl  17  . For the formate-doped FAPbI 3 (Fo-FAPbI 3 ) film, x mol% (x ≤ 4) FAHCOO was added to the reference precursor solution (for experimental details, see Supplementary Information). At a later stage in this work, we quantify the amount of MA in the resulting perovskite material to be 5%, but for simplicity we refer to this sample as FAPbI 3 . Figure  1a  shows the ultraviolet-visible (UV-vis) absorption and photoluminescence spectra of the FAPbI 3 perovskite films (x = 0, 2 and 4). The absorption threshold and photoluminescence peak position were identical for all films; however, there was an obvious decrease in absorbance for the 4% Fo-FAPbI 3 film. We derived a bandgap of 1.53 eV for the films using the Tauc plot (Extended Data Fig.  1a ). Fig.  1b  shows the time-resolved photoluminescence of the FAPbI 3 perovskite films. The 2% Fo-FAPbI 3 perovskite film showed a slower photoluminescence decay than the reference, which indicates a reduced non-radiative recombination rate due to a reduction in trap-mediated bulk or surface recombination. By contrast, the 4% Fo-FAPbI 3 perovskite film showed a faster photoluminescence decay than the reference. A full photoluminescence decay up to 4 μs is shown in Extended Data Fig.  1b . A quantitative analysis of the time-resolved photoluminescence is presented in Supplementary Note 1. Scanning electron microscopy (SEM) measurements were performed to investigate the morphology of the perovskite film. Compared to the reference film (Fig.  1c ), the 2% Fo-FAPbI 3 film (Fig.  1d ) had a slightly larger grain size of up to 2 μm (Extended Data Fig.  1c ). The insets of Fig.  1c, d  show the cross-sectional SEM images of the corresponding perovskite films. Both the reference and 2% Fo-FAPbI 3 films showed monolithic grains from the top to the bottom. Extended Data Fig.  1d , e shows the irregular grain size of the 4% Fo-FAPbI 3 films. Atomic force microscopy measurements (Extended Data Fig.  1f, g ) revealed a surface roughness of 41.66 nm and 57.47 nm for the reference and 2% Fo-FAPbI 3 films, respectively. The slightly increased surface roughness of the 2% Fo-FAPbI 3 film is probably due to the slightly increased grain size. X-ray diffraction (XRD) measurements (Extended Data Fig.  1h ) showed identical peak positions at around 13.95° and 27.85° for both the reference and the Fo-FAPbI 3 perovskite films, corresponding to the α-phase of FAPbI 3 . However, the XRD pattern of the 4% Fo-FAPbI 3 film showed additional peaks, which are assigned to fluorine-doped tin oxide (FTO) substrates and different orientations of α-FAPbI 3 . The broader and lower-intensity diffraction peaks-resulting in a higher relative noise level-indicate a poor crystallinity, which is consistent with the poor optical measurements of the 4% Fo-FAPbI 3 film described above. Synchrotron-based two-dimensional grazing-incidence XRD measurements were also obtained for the FAPbI 3 films at a relative humidity of around 100% at 30 °C in air. Figure  1e  clearly shows the presence of the δ-phase in the reference, whereas this phase was absent in the 2% Fo-FAPbI 3 film (Fig.  1f ). This provides strong evidence that FAHCOO stabilizes the α-phase of FAPbI 3 against humidity. In addition, the full-width at half-maximum of the α-phase peak was decreased for the 2% Fo-FAPbI 3 film, which is hereafter denoted as 'target'. The integrated one-dimensional diffraction intensity is shown in Extended Data Fig.  1i . We infer from these data that including 2% FAHCOO in the synthesis of the FAPbI 3 films strongly enhances their crystallinity. We obtained solid-state nuclear magnetic resonance (NMR) spectroscopy measurements in order to elucidate the molecular mechanisms that lead to the improvements afforded by the HCOO -anions. We prepared the samples by mixing formamidinium iodide and PbI 2 powders with 5 mol% excess FAHCOO using a mechano-synthesis method. Experimental details are provided in Methods. The 207 Pb spectrum is sensitive to the nature of the anions that are coordinated to Pb 2+ in the perovskite crystal  28  . Figure  2a  shows the 207 Pb NMR spectrum of α-FAPbI 3 , in which the 207 Pb resonance appears at 1,543 ppm. The addition of 5% FABr results in a notable shoulder on the low-frequency side of the resonance, as shown in Fig.  2a  (2). This shoulder corresponds to 207 Pb in a [PbBrI 5 ] site, which resonates at lower frequency than in a [PbI 6 ] site, because 207 Pb in a [PbBr 6 ] site in FAPbBr 3 resonates at 510 ppm  28  . However, the 207 Pb resonance of α-FAPbI 3 remained the same even when 5% FAHCOO was added during the synthesis, which is strong evidence that HCOO -does not substitute for iodide anions in the α-FAPbI 3 lattice. This is also supported by the density functional theory (DFT) calculations of the formation energy (Supplementary Note 2). To explore the local environment of the HCOO -anions in the Fo-FAPbI 3 perovskite, 1 H-  13  C cross-polarization experiments  29  were performed at 100 K. Figure  2b  (1) shows  13  C resonance signals at 167.8 ppm and 158.5 ppm for the HCOO -and FA + environments in FAHCOO, respectively. Figure  2b , (  2 ) and (  3 ) show the δ-FAPbI 3 and α-FAPbI 3 and 13 C resonances at 157.6 ppm and 153.4 ppm, respectively. Upon mixing 5 mol% FAHCOO with FAPbI 3 , the  13  C signal of α-FAPbI 3 remained unchanged at 153.4 ppm (Fig.  2b (4 )); this further corroborates the lack of substitution of iodide by HCOO -inside the FAPbI 3 lattice, which would broaden the  13  C resonance of FAPbI 3 . The HCOO -peak, however, exhibited considerable broadening-indicative of a distribution of local environments-in contrast to the well-defined environment in crystalline FAHCOO. This is consistent with interaction of the HCOO -anion with undercoordinated Pb 2+ to passivate iodide vacancies that are present at the surface or the grain boundaries of the perovskite, as predicted by molecular dynamics simulations (see below). For the spin-coated target thin films, the formate  13  C signal is less intense, appearing as a shoulder on the α-FAPbI 3 peak (Extended Data Fig.  2a, b ). This is due to a combination of the lower initial formate concentration and-because the exposed area is greater-the potentially greater evaporation of formate during annealing in the thin films compared to that in the powders; however, it should be noted that cross-polarization spectra are not quantitative. The presence of FAHCOO in the α-FAPbI 3 films is also supported by the time-of-flight secondary-ion mass spectrometry measurements (Extended Data Fig.  2c, d ). We further quantified the composition of the spin-coated target films using directly detected 13 C NMR at 100 K (Extended Data Fig.  2e ). Integration of the FA + and MA + resonances in the quantitative  13  C spectrum yields a concentration of MA + in the final film of 5.1% (Supplementary Note 3). 
 Molecular dynamics simulations To explore in more detail the unique role of HCOO -anions, we performed ab initio molecular dynamics simulations of a homogeneous mixture of different ions in the precursor solution (see Extended Data Fig.  3a, b  and Supplementary Note 4)-comprising Pb 2+ , I -, HCOO -and FA + -and found that HCOO -anions coordinate strongly with Pb 2+ cations (Supplementary Video 1). This strong coordination might help to slow the growth process, resulting in larger stacked grains of the perovskite film; this is validated by the in situ images of the perovskite films without annealing (Supplementary Fig.  1 ). Compared to the reference film, the target film showed a slower colour change from brown to black. We also performed molecular dynamics simulations to understand the surface passivation effects of HCOO -anions. Extended Data Fig.  3c  shows a super cell of a α-FAPbI 3 perovskite slab, in which surface iodides are replaced by formate anions. We found that HCOO -anions can form a hydrogen-bonded network with FA + ions (Extended Data Fig.  3d , Supplementary Video 2), in agreement with the hydrogen bonding that is observed in FAHCOO crystal structures  30  . In addition, HCOO -anions can also form a bonding network on the Pb 2+ ion-terminated surface, owing to their strong affinity towards lead (Extended Data Fig.  3e , Supplementary Video 3). Figure  2c  shows a calculated structure that illustrates an HCOO -anion passivating an I -vacancy at the FAPbI 3 surface. I -vacancy defects are the most deleterious defects for halide perovskites. They act as electron traps-inducing the non-radiative recombination of charge carriers-and are responsible for the ionic conductivity of perovskites that causes operational instability. We estimated the relative binding affinities of different anions to I -vacancies at the surface (Extended Data Fig.  4 ).The energies shown in Fig.  2d  reveal that HCOO -has the highest binding energy to I -vacant sites in comparison with Cl -, Br -, I -and BF 4 -. Furthermore, we also calculated the bonding energies of FA + cations at the interface with HCOO -anions and with other anions (Extended Data Fig.  5 , Supplementary Note 5). We found that FA + cations at the interface form stronger bonds with HCOO -than with the other anions. We therefore conclude that the HCOO -anion acts by eliminating anion-vacancy defects. 
 Photovoltaic performance of the PSCs We further explored the photovoltaic performance of the PSCs. FAPbI 3 PSCs were fabricated using a configuration as illustrated in Fig.  3a .   2 ) and α-FAPbI 3 + 5% FAHCOO (3). In (1), a small amount of the δ-phase can be seen, but this is distinct from the shoulder seen in (  2 ), and is not seen in (  3 ). b,  13  C solid-state NMR spectra (recorded at 100 K and 12 kHz MAS) of FAHCOO (  1 ), δ-FAPbI 3 (2), α-FAPbI 3 (3) and α-FAPbI 3 + 5% FAHCOO (4) (the top trace in (  4 ) is an eightfold magnification). c, Calculated structure illustrating the passivation of an I - vacancy at the FAPbI 3 surface by a HCOO -anion. All chemical species are shown in ball-and-stick representation. Pb 2+ , yellow; I -, pink; oxygen atoms, red; carbon, green; nitrogen, blue; hydrogen, white. d, The relative interaction strengths of different anions with the I -vacancy at the surface. Figure  3b  shows current density (J)-voltage (V) curves of the reference and target PSCs under both forward and reverse scans. The reference cell had a maximum PCE of 23.92% with a J sc of 25.72 mA cm -2 , a V oc of 1.153 V and a fill factor of 80.69%. The target PSC had a maximum PCE of 25.59% with a J sc of 26.35 mA cm -2 , a V oc of 1.189 V and a fill factor of 81.7%. The detailed parameters are summarized in Extended Data Table  1 . A statistical distribution of the measured PCE of the reference and target PSCs are shown in Fig.  3c . To verify the efficiency, we sent one of our best target PSCs to an accredited photovoltaic test laboratory (Newport, USA) for certification. Supplementary Fig.  2  represents a certified quasi-steady-state efficiency of 25.21%, with a V oc of 1.174 V, a J sc of 26.25 mA cm -2 and a fill factor of 81.8%. EQE measurements (Fig.  3d ) were performed to verify the measured J sc . The EQE of the target cell was higher than that of the reference cell over the whole visible-light absorption region. By integrating the EQE over the AM 1.5G standard spectrum, the projected J sc of the reference and target PSCs are 25.75 mA cm -2 and 26.35 mA cm -2 , respectively, which well match the measured J sc under the solar simulator. Figure  3e  shows the EQE EL of the PSCs. It is known that the photovoltage of a solar cell is directly related to the ability to extract its internal luminescence  31  . EQE EL values have previously been successfully used to predict the V oc of PSCs  32  . In this case, the EQE EL of the reference cell was 2.2%, whereas that of the target cell was 10.1% for injection current densities of 25.5 mA cm -2 and 26.5 mA cm -2 (corresponding to the J sc measured under 1 sun illumination), respectively. Treatment with formate therefore results in a fivefold reduction in the non-radiative recombination rate. The V oc of 1.21 V that we obtained for the target cell (Extended Data Fig.  6a ) is 96% of the Shockley-Queisser limit of 1.25 V 32,33 -to our knowledge, this is the highest value yet obtained. To further confirm the role of formate, we also measured the performance of devices fabricated using formamidinium acetate as an additive (Extended Data Fig.  6b ); however, this additive had a negative effect on performance. For the devices fabricated without MACl additives or passivation layers, those that contained formate still showed an advantage (Extended Data Fig.  6c, d ). Supplementary Fig.  3  shows a linear relationship (with a slope of approximately 0.95) between J sc and light intensity for both the reference and target PSCs-indicating good charge transport and negligible bimolecular recombination-and Fig.  3f  shows a linear relationship between V oc and the logarithm of light intensity. We fitted the data points with a slope of η id k B T/q, where η id is the ideality factor, k B is the Boltzmann constant, T is temperature and q is the electron charge. The reference cell had an η id of 1.52, whereas that of the target cell was 1.18-lower than the previously reported value  33  of 1.27. A summary of the detailed photovoltaic parameters can be found in Extended Data Table  2 . The reduction in η id , as well as the space-charge-limited current measurements (Supplementary Fig.  4 ), further support our findings of a reduction in trap-assisted recombination  34, 35  . Because the fill factor critically depends  36  on η id , the reduction in η id that we observe here also contributes to the increase in fill factor measured for the target PSCs. 
 Shelf-life and operational stability of the PSCs To assess the stability of our PSCs, we measured first their shelf life by storing the unencapsulated devices in the dark at 25 °C and 20% relative humidity. Figure  4a  shows that the PCE of the reference cell decreased by about 35% after 1,000 h aging, whereas the target cell showed a degradation of only 10% over this time. A heat-stability test was also performed by annealing the unencapsulated PSC devices at 60 °C under 20% relative humidity. Figure  4b  shows that the target cell retained around 80% of its initial efficiency after 1,000 h aging, whereas the reference cell retained only about 40%. We further investigated the operational stability of the PSCs by aging the unencapsulated devices under a nitrogen atmosphere, using maximum power point (MPP) tracking under a simulated 1-sun illumination. Figure  4c  shows the PCE of the PSCs under continuous light soaking using a xenon lamp. The PCE of the target cell remained above 24% after 10-h MPP tracking, whereas that of the reference cell decreased to 22.8%. Figure  4d  shows the long-term operational stability of the PSCs. The PCE of the reference cell decreased by about 30%, whereas the target cell only lost around 15% of its initial efficiency. Note that during this experiment the temperature of the PSCs was measured to be around 35 °C, as we did not cool the cells during illumination. Compared to the target PSC, the reference cell showed a considerable decrease in J sc and fill factor over the 450-h MPP tracking test (Extended Data Fig.  7 ), which suggests that reference perovskite layer is less stable. We attribute the decline in fill factor to a de-doping of the hole conductor due to Li + ion migration under illumination  37  . The improvement in thermal and operational stability of the target cell compared with the reference cell is ascribed to the better crystallinity of the perovskite film and a reduced concentration of halide defects, because NMR experiments show that formate is not incorporated into the bulk of the perovskite. It is known that crystallinity is crucial for the stability of the perovskites, because the main degradation process starts from defects near the grain boundaries. The high crystallinity and large grain size of the formate-containing perovskite films-as validated by SEM and XRD measurements-will contribute to their greater stability and performance. Our simulations and calculations suggest that formate anions have the highest binding affinity among all halides and pseudo halides for iodide vacancy sites, and are therefore the best candidates to eliminate the most abundant and deleterious lattice defects present in halide perovskite films. This results in a marked reduction of trap-mediated non-radiative recombination, which we validated by EQE EL , time-resolved photoluminescence, n id , and SCLC measurements. A low level of halide vacancies is beneficial for the stability of solar cells, because halide vacancies can lead to degradation as a result of photoinduced iodine loss, especially under light illumination. Overall, we demonstrate α-FAPbI 3 -based PSCs with a PCE of 25.6% (certified 25.2%) and high stability, achieved through solution processing by introducing 2% formamidinium formate into the FAPbI 3 perovskite precursor solution. Our molecular dynamics simulations, together with solid-state NMR spectroscopy analysis and in-depth optoelectronic device characterization, provide an understanding of the role of HCOO -anions as passivating agents for FAPbI 3 perovskites. Our findings pave the way for facile access to high-performance PSCs approaching their theoretical efficiency limit. 
 Online content Any methods, additional references, Nature Research reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at  https://doi.org/10.1038/s41586-021-03406-5 . 
 Materials Formamidine acetate salt (99%), hydroiodic acid (HI, 57 wt% in water), titanium diisopropoxide bis(acetylacetonate), 2-propanol (anhydrous, 99.5%), chlorobenzene (anhydrous, 99.8%), N,N-dimethylformamide (DMF, anhydrous 99.8%,), dimethyl sulfoxide (DMSO, >99.5%), 2-methoxyethanol (anhydrous, 99.8%) and formic acid were procured from Sigma-Aldrich and used as received. Methylamine hydrochloride (MACl, 98%) was procured from Acros Organics. Fluorine-doped tin oxide on glass (FTO glass, 7 Ω sq -1 ) was obtained from Asahi. Ethanol (absolute, 99.9%) was procured from Changshu Yangyuan Chemicals. Diethyl ether (extra pure grade) was procured from Duksan. TiO 2 paste (SC-HT040) was procured from ShareChem. Lead iodide (PbI 2 , 99.999%) was purchased from TCI. 
 Materials synthesis Formamidinium iodide (FAI) was synthesized as reported elsewhere  8  . In brief, 25 g formamidine acetate was directly mixed with 50 ml hydroiodic acid in a 500 ml round-bottomed flask with vigorous stirring. A light-yellow powder was obtained by evaporating the solvent at 80 °C for 1 h in a vacuum evaporator. The resulting powder was then dissolved in ethanol and precipitated using diethyl ether. This procedure was repeated three times until white powder was obtained, and the white powder was recrystallized from ethanol and diethyl ether in a refrigerator. After recrystallization, the resulting powders were collected and dried at 60 °C for 24 h. As reported previously  18  , black FAPbI 3 powder was synthesized by mixing the synthesized FAI (0.8 M) with PbI 2 (1:1 molar ratio) in 30 ml of 2-methoxyethanol with stirring. The yellow mixed solution was heated with a stirring bar at 120 °C and then recrystallized using the retrograde method. The resulting powder was filtered using a glass filter and baked at 150 °C for 30 min. Formamidine formate (FAHCOO) was synthesized by dissolving formamidine acetate in an excess of formic acid. The resulting solution was dried at 80 °C by rotary evaporation to remove most of the formic acid and acetic acid. A wet formamidine formate powder was obtained. This wet powder was recrystallized with a small amount of ethanol. A transparent, plate-like crystal was formed after the recrystallization, which was consecutively dried in vacuum for 10 h to obtain the final formamidine formate. Bulk perovskite samples for solid-state NMR are prepared by grinding the reactant (FAI and PbI 2 with FABr or FAHCOO as appropriate) in an electric ball (Retsch Ball Mill MM-200) for 30 min at 25 Hz, before annealing at 150 °C for 15 min. 
 Substrate preparation Asahi FTO glass (1.8 mm, 7 Ω sq -1 ) was used as the substrate for the devices. The substrates were cleaned using the RCA-2 (H 2 O 2 -HCl-H 2 O) procedure for 15 min to remove metal-ion impurities. Then, the substrates were cleaned sequentially with acetone, ethanol and isopropyl alcohol (IPA) in an ultrasonic system for 15 min. To deposit the compact TiO 2 (c-TiO 2 ) layer, 60 ml of a titanium diisopropoxide bis(acetylacetonate)/ethanol (1:10 volume ratio) solution was applied using the spray-pyrolysis method. Prior to the spraying process, the FTO substrates were placed on a hot plate and the temperature was increased to 450 °C rapidly. After the spray pyrolysis step, the substrates were stored at 450 °C for 1 h and then slowly cooled to room temperature. On top of the c-TiO 2 layer, a mesoporous TiO 2 (m-TiO 2 ) layer was deposited by spin-coating a TiO 2 paste dispersed in ethanol/terpineol (78:22 w/w). The TiO 2 nanoparticles have a diameter of approximately 50 nm and were purchased from ShareChem. The FTO/c-TiO 2 substrates prepared with m-TiO 2 were heated at 500 °C on a hot plate for 1 h to remove organic compounds first, and then slowly cooled to 200 °C. 
 Device fabrication For the fabrication of the perovskite layer, the whole process was carried out at controlled room temperature (25 °C) and humidity (20% relative humidity). The reference perovskite precursor solution was prepared by mixing 1,139 mg FAPbI 3 and 35 mol% MACl in a mixture of DMF and DMSO (4:1). For the Fo-FAPbI 3 perovskite film, extra FAHCOO was added to the reference solution in the range of 1-4 mol%. For each sample, 70 μl of the solution was spread over the m-TiO 2 layer at 6,000 rpm for 50 s with 0.1 s ramping. During the spin-coating, 1 ml diethyl ether was dripped after spinning for 10 s. The perovskite film was then dried on a hot plate at 150 °C for 10 min immediately. See Supplementary Video 4 for details of the fabrication of perovskite films. After cooling the perovskite film on the bench, 15 mM of octylammonium iodide dissolved in IPA was spin-coated on top of the perovskite film at 3,000 rpm for 30 s. The hole-transport layer was deposited by spin-coating a Spiro-OMeTAD (Lumtech) solution at 4,000 rpm for 30 s. Details of the Spiro-OMeTAD solution was reported in the previous study  18  . Finally, a gold electrode was deposited on top of the Spiro-OMeTAD layer using a thermal evaporation system. The back and front contacts were formed with 100-nm-thick Au films deposited under a pressure of 10 -6 Torr. 
 Characterization of the solar cells The solar cells without encapsulation were measured with a solar simulator (McScience, K3000 Lab solar cell I-V measurement system, Class AAA) in a room with relative humidity below 25% at 25 °C. An anti-reflecting coating layer was used for the devices. The light intensity was calibrated to AM 1.5G (100 mW cm -2 ) using a Si-reference cell certified by the National Renewable Energy Laboratory before performing measurements. No light soaking was applied before the potential I-V scans. All J-V curves were measured using a reverse scan (from 1.25 V to 0 V) and a forward scan (from 0 V to 1.25 V) under a constant scan speed of 100 mV s -1 . The stabilized power output was measured at the maximum power point using a xenon lamp light source. A non-reflective mask with an aperture area of 0.0804 cm 2 was used to cover the active area of the device to avoid the artefacts produced by the scattered light (the mask area is determined using a microscope). EQE measurements were obtained using a QEX7 system (PV Measurements). For the EQE EL measurements, different bias voltages or currents were applied to the PSCs with a BioLogic SP300 potentiostat. The emitted photon flux from the PSCs was recorded using a calibrated, large-area (1 cm 2 ) Si photodiode (Hamamatsu S1227-1010BQ). All measurements were performed in the ambient environment (40% relative humidity, 24 °C). 
 Characterization of the device stability For the stability tests, all PSCs were used without encapsulation. The shelf-life stability was assessed by measuring the photovoltaic performance of PSCs every tens of hours. The thermal stability test was performed by ageing the solar cells on a hot plate at 60 °C at 20% relative humidity. The performance of the devices was periodically measured after cooling the devices to room temperature. The operational stability was performed with a BioLogic potentiostat under an LED or a lamp that was adjusted to AM 1.5G (100 mW cm -2 ). The PSCs were masked and placed inside a homemade sample holder purged with continuous N 2 flow. The devices were aged with a maximum point power tracking routine under continuous illumination. The temperature-control system was not activated during the measurements. J-V curves with reverse voltage scans were recorded every 30 min during the whole operational test. 
 Characterization of the perovskite film UV-vis absorption spectra of the perovskite films were recorded on a UV-1800 (Shimadzu) spectrophotometer. The SEM images of the perovskite films were taken with a field-emission scanning electron microscope (FE-SEM, S-4800, Hitachi). XRD patterns of the perovskite films were performed using a D8 Advance (Bruker) diffractometer equipped with Cu Kα radiation (λ = 0.1542 nm) as the X-ray source. Steady-state photoluminescence and time-resolved photoluminescence measurements of the perovskite films were conducted using a PicoQuant FluoTime 300 (PicoQuant GmbH) equipped with a PDL 820 laser pulse driver. A pulsed laser diode (λ = 375 nm, pulse full-width at half-maximum <70 ps, repetition rate 200 kHz-40 MHz) was used to excite the perovskite sample. Surface roughness was assessed using a Cypher S atomic force microscope from Asylum Research under ambient conditions (24 °C, 50% relative humidity). An Olympus AC240-TS tip was used, and the system was operated under tapping mode. Two-dimensional grazing-incidence XRD of the perovskite films was performed at the BL14B1 beamline of the Shanghai Synchrotron Radiation Facility (SSRF) using X-rays with a wavelength of 0.6887 Å. Two-dimensional grazing-incidence XRD patterns were acquired by a MarCCD mounted vertically at a distance of around 632 mm from the sample with grazing-incidence angles of 0.4° and an exposure time of 30 s. For the time-of-flight secondary-ion mass spectrometry (TOF-SIMS) measurements, the reference and 2% Fo-FAPbI 3 films were coated on a glass substrate using anti-solvent methods. The samples were analysed by TOF-SIMS using a hybrid IONTOF TOF-SIMS instrument. Depth profiling was accomplished with a three-lens 25-keV BiMn primary ion gun and a Bi 3 + primary ion-beam cluster (1 pA pulsed beam current). Measurements used a caesium-ion beam for sputtering with an energy of 500 eV (sputtering current 1-23 nA). Profiling was completed with a 100 × 100 μm 2 primary-beam area and a 300 × 300 μm 2 sputter-beam raster. Non-interlaced mode was used to limit beam damage from the primary ion-beam (1 frame, 2 s sputter, 2 s pause). 
 Solid-state NMR measurements Low-temperature (100 K) 1 H-13 C cross-polarization and directly detected 13 C (125.8 MHz) NMR spectra, and room-temperature 207 Pb (104.7 MHz) NMR spectra were recorded on a Bruker Avance III 11.7 T spectrometer equipped with a 3.2-mm low-temperature CPMAS probe.  207  Pb and  13  C spectra were referenced to Pb(NO 3 ) 2 at -3,492 ppm and the CH 2 resonance of solid adamantane at 38.48 ppm, respectively, at room temperature. Room temperature 207 Pb spectra were recorded with a Hahn echo and an effective recycle delay of 17 ms. The low-temperature 1 H-13 C cross-polarization spectra of δ-FAPbI 3 and α-FAPbI 3 were recorded with 1 ms contact time, recycle delays of 1.5 s and 4 s, respectively, and 12 kHz MAS. The low-temperature 1 H-  13  C spectra of FAHCOO and Fo-FAPbI 3 were recorded with 2 ms contact time, 10 s recycle delay and 12 kHz MAS. The quantitative, directly detected  13  C experiment on a scraped 2% Fo-FAPbI 3 film was performed with a single pulse experiment, 12 kHz MAS and a 10 s recycle delay, which is more than 5 times the longitudinal relaxation time of 13 C (1 s). All  13  C spectra were acquired with 100 kHz 1 H decoupling. The low-temperature 1 H-13 C cross-polarization spectrum of scraped 2% Fo-FAPbI 3 thin-film was measured with 2 ms contact time, 4 s recycle delay and 12 kHz MAS. NMR characterization was performed with 5% Fo-FAPbI 3 , because the greater amount of formate in the sample provides higher sensitivity compared to 2% Fo-FAPbI 3 . MACl was not included in the mechanosynthesized samples for NMR spectroscopy, because this would lead to broadening of the  13  C and 207 Pb resonances of FAPbI 3 (ref.  29  ), owing to different local environments with slightly different chemical shifts that arise from MA + substitution of nearest-neighbour-and more distant-A-site cations. This broadening would obscure the small changes in the 207 Pb and  13  C resonances that arise from the incorporation of formate. However, given that the incorporation of MA + ions has a minimal effect on the lattice structure, these findings also apply to the MA + -doped composition studied here.  Fig. 1 | 1 Fig. 1 | Characterization of the FAPbI 3 films. a, UV-vis absorption and photoluminescence (PL) spectra of the FAPbI 3 films. b, Time-resolved photoluminescence of the FAPbI 3 films. c, d, SEM images of the reference 
 Fig. 2 | 2 Fig. 2 | Solid-state NMR spectra and molecular dynamics simulations. a,207  Pb solid-state NMR spectra (recorded at 298 K and a magic-angle spinning (MAS) rate of 15 kHz) of α-FAPbI 3 (1), α-FAPbI 3 + 5% FABr (2) and α-FAPbI 3 + 5% FAHCOO (3). In (1), a small amount of the δ-phase can be seen, but this is distinct from the shoulder seen in (2), and is not seen in (3). b,13  C solid-state NMR spectra (recorded at 100 K and 12 kHz MAS) of FAHCOO (1), δ-FAPbI 3 (2), α-FAPbI 3 (3) and α-FAPbI 3 + 5% FAHCOO (4) (the top trace in (4) is an eightfold magnification). c, Calculated structure illustrating the passivation of an I - vacancy at the FAPbI 3 surface by a HCOO -anion. All chemical species are shown in ball-and-stick representation. Pb 2+ , yellow; I -, pink; oxygen atoms, red; carbon, green; nitrogen, blue; hydrogen, white. d, The relative interaction strengths of different anions with the I -vacancy at the surface. 
 Fig. 3 |Fig. 4 | 34 Fig. 3 | Characterization of the photovoltaic performance of the FAPbI 3 PSCs. a, The configuration of a typical FAPbI 3 PSC device. Spiro-OMeTAD, 2,2′,7,7′-tetrakis(N,N-dip-methoxyphenylamine)9,9′-spirobifluorene. b, J-V curves of the reference and target PSCs under both reverse and forward voltage scans. c, The distribution of the PCEs of the reference and target PSCs. d, EQE and the integrated J sc of the reference and target PSCs. e, EQE EL measurements of the reference and target PSCs under current densities from 0.01 mA cm -2 to 100 mA cm -2 . f, The relationship between the measured V oc and light intensity for the reference and target PSCs. 
 Extended Data Fig. 1 |Extended Data Fig. 5 | 15 Characterization of the perovskite films with and without FAFo. a, The Tauc plot of the 2% Fo-FAPbI 3 perovskite film. b, A full photoluminescence decay of the reference, 2% Fo-FAPbI 3 and 4% Fo-FAPbI 3 perovskite films. c, The distribution of the grain sizes of the reference and 2% Fo-FAPbI 3 films. The box + whisker plots show the distribution of the grain sizes for both reference and 2% Fo-FAPbI3 perovskite films. The distribution is based on 22 data points each. d, e, The top-view SEM image (d) and the cross-sectional SEM image (e) of the 4% Fo-FAPbI 3 perovskite film. f, g, AFM images of the reference (f) and the 2% Fo-FAPbI 3 (g) perovskite films. h, The XRD patterns of the reference, 2% Fo-FAPbI 3 and 4% Fo-FAPbI 3 perovskite films. Peaks labelled with an asterisk are assigned to the FTO substrates, which can be seen for the 4% sample owing to the lower intensity of the perovskite reflections. i, Integrated one-dimensional grazing-incidence XRD pattern of the reference and 2% Fo-FAPbI 3 films. Extended Data Fig. 2 | The composition of the Fo-FAPbI 3 perovskite film. a, b, 1 H-13 C cross-polarization spectra of mechanosynthesized FAPbI 3 with 5% FAHCOO (a) and a scraped thin film of 2% Fo-FAPbI 3 (b), recorded at 12 kHz MAS and 100 K. In b the formate signal can be seen as a minor shoulder on the FAPbI 3 peak. A minor signal arising from the PTFE that is used to seal the rotor is also visible. c, d, TOF-SIMS measurements of the reference (c) and the 2% Fo-FAPbI 3 (d) films. e, Quantitative, directly detected 13 C solid-state NMR measurement of 2% Fo-FAPbI 3 scraped thin film at 12 kHz MAS and 100 K. Extended Data Fig. 3 | Ab initio molecular dynamics simulations. a, Molecular dynamics snapshot showing the coordination of Pb 2+ ions with HCOO -anions in the perovskite precursor solution. As a guide to the eye, we highlight only Pb 2+ and HCOO -ions; the remaining ions and solvent molecules are shown as transparent. b, The radial distribution function g(r) between the oxygen atoms of HCOO -and Pb 2+ over the full ab initio molecular dynamics trajectory of around 11 ps. c, Initial configuration of FAPbI 3 with surface iodide replaced by HCOO -anions. d, The top view of surface atoms on the FA + -terminated side. e, The top view of the surface atoms on the Pb 2+ -terminated side. Pb 2+ -HCOO -and FA + -HCOO -bonding and hydrogen-bonding networks are illustrated with magenta dashed lines. All ions are shown in ball-and-stick representation. Pb 2+ ions, yellow; iodide, light pink; oxygen, red; carbon, light blue; nitrogen, dark blue; sulfur, light yellow; hydrogen, white. Extended Data Fig. 4 | DFT-relaxed slabs of FAPbI 3 with different anions adsorbed at an iodide-vacancy site on the surface. a, Structure of a pure FAPbI 3 slab with a Pb-I terminated surface on the top and an FA-I terminated surface on the bottom side. b-e, Front view of the Cl -(b), Br -(c), BF 4 -(d) and HCOO -(e) passivated surface. f, An illustration of iodide-vacancy passivation by HCOO -. g, h, DFT-relaxed FAPbI 3 slab with HCOO -adsorbed at the iodide-vacancy site on the Pb-I (g) and the FA-I (h) terminated surface. All chemical species are shown in ball-and-stick representation. Pb 2+ , grey; iodide, violet; oxygen, red; carbon, dark brown; nitrogen, light blue; bromide, red-brown; chloride, light green; boron atoms, dark green; fluoride, yellow; hydrogen atoms, white. Bonding between formamidinium and different anions on the surface of FAPbI 3 . a, Structure of a pure FAPbI 3 slab with FA-I termination on the top and Pb-I termination on the bottom side. b, c, The front view (b) and the side view (c) of the HCOO -passivated surface. d-f, Cl -(d), Br - (e) and BF 4 -(f) passivated surface. All chemical species are shown in ball-and-stick representation. Pb 2+ , grey; iodide, violet; oxygen, red; carbon, dark brown; nitrogen, light blue; bromide, red-brown; chloride, light green; boron atoms, dark green; fluoride, yellow; hydrogen, white. g, Relative desorption strength of FA + cations on different passivated surfaces. Extended Data Fig. 6 | Photovoltaic performance of the PSCs under different conditions. a, J-V curve of the target PSC measured without a metal mask. b, J-V curves of the reference PSC and the PSC with 2% formamidinium acetate. c, J-V curves of the reference 2% Fo-FAPbI 3 PSCs without the MACl additive. d, J-V curves of the reference and the 2% Fo-FAPbI 3 PSCs without using octylammonium iodide passivation. FF, fill factor. 
 
 
 
 
 
 
 
 
 
 
			 Extended Data Fig. 7 | J-V metrics of the reference and target PSCs during the operational stability test. a-c, The change in J sc (a), V oc (b) and fill factor (c) of the reference and target cells over the 450-h MPP tracking measurement.