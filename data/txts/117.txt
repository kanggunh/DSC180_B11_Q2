Paper #: 117
Ion-modulated radical doping of spiro-OMeTAD for more efficient and stable perovskite solar cells
Record power conversion efficiencies (PCEs) of perovskite solar cells (PSCs) have been obtained with the organic hole transporter 2,2′,7,7′-tetrakis(N,N-di-p-methoxyphenyl-amine)9,9′-spirobifluorene (spiro-OMeTAD). Conventional doping of spiro-OMeTAD with hygroscopic lithium salts and volatile 4-tert-butylpyridine is a time-consuming process and also leads to poor device stability. We developed a new doping strategy for spiro-OMeTAD that avoids post-oxidation by using stable organic radicals as the dopant and ionic salts as the doping modulator (referred to as ion-modulated radical doping). We achieved PCEs of >25% and much-improved device stability under harsh conditions. The radicals provide hole polarons that instantly increase the conductivity and work function (WF), and ionic salts further modulate the WF by affecting the energetics of the hole polarons. This organic semiconductor doping strategy, which decouples conductivity and WF tunability, could inspire further optimization in other optoelectronic devices. 
 RESEARCH
M etal halide perovskites have achieved impressive power conversion efficiencies (PCEs) in both single-junction (1-6) and tandem solar cells  (7, 8) . However, a key challenge limiting their practical application is the trade-off between high efficiency and high stability, an issue determined by not only the perovskite materials  (9)  but also the charge transport layers  (10) . Currently, most high-performance perovskite solar cells (PSCs) with >24% PCE are based on the benchmark hole transport layer (HTL) spiro-OMeTAD doped by lithium bis(trifluoromethane)sulfonimide (LiTFSI) and 4-tert-butylpyridine (tBP)  (11) (12) (13) , a process that limits the stability of these highefficiency PSCs. Conventional spiro-OMeTAD doping (Fig.  1A , top) involves LiTFSI to facilitate the generation of spiro-OMeTAD •+ TFSI -radicals and tBP to improve dopants' solubility and film morphology  (14) . This recipe usually requires an in situ oxidization process for a period of 10 to 24 hours in air to reach the optimal conductivity and work function (WF)  (15) . However, because of the low doping efficiency of this process, a large amount of dopants and additives (~56 mol % LiTFSI and ~330 mol % tBP) are required to generate ~10 mol % radicals  (16) . The residual LiTFSI, tBP, and by-products (e.g., Li x O y ) are not only diffusible  (17)  but also sensitive to humidity and heat  (18, 19) , negatively affecting device stability. In addition, the complex in situ oxidation process makes it challenging to understand the mechanism of conventional spiro-OMeTAD doping, which limits further development of stable HTLs with high PCEs. Several efforts addressing the spiro-OMeTAD stability issue have focused on the hygroscopic lithium salt. For example, a CO 2 gas-forming treatment was recently used to remove the hygroscopic lithium species  (20) . Less hygroscopic dopants, including metallic salts  (21) (22) (23) , protic ionic liquids  (24) , and ex situ synthesized spiro-OMeTAD 2•+ (TFSI -) 2 radicals  (25, 26) , have also been used to replace the oxidant LiTFSI. Such doping usually requires the addition of volatile tBP, whose role in the doping process has been controversial  (27, 28) . In particular, tBP would react with radicals and coordinate with LiTFSI to form by-products (Fig.  1A , top), which not only negatively affects device performance but also prevents a full understanding of the spiro-OMeTAD doping mechanism. We developed a stable doping strategy for instant and effective doping of spiro-OMeTAD, which we call ion-modulated (IM) radical doping (Fig.  1A , bottom), that relies on two components. One is the presynthesized stable spiro-OMeTAD 2•+ (TFSI -) 2 radical (synthesis and characterizations in figs. S1 and S2), which acts as the main dopant to improve conductivity and WF. The second is the ionic salt 4-tert-butyl-1methylpyridinium bis(trifluoromethylsulfonyl)imide (TBMP + TFSI -) to further modulate the WF. In this doping strategy, the localized ionic environment created by the ionic salt was used to manipulate the energetics of the hole polarons and decouple the conductivity and WF tunability. The doped spiro-OMeTAD based on our IM radical doping strategy delivered PSCs simultaneously with high efficiency (PCE > 25%) and high stability (T 80 for ~1200 hours under 70 ± 5% relative humidity (RH) and T 80 for ~800 hours under 70°± 3°C without encapsulation), minimizing the trade-off between efficiency and stability of PSCs. In addition, the IM radical doping strategy provides a facile yet effective approach to separately optimize the conductivity and WF of organic semiconductors for a variety of optoelectronic applications. 
 PSC performance based on IM radical-doped spiro-OMeTAD We first compared the distinctive effects of conventional and IM radical doping of spiro-OMeTAD using (FAPbI 3 ) 0.99 (MAPbBr 3 ) 0.01 (FA, formamidinium; MA, methylammonium) PSCs with an SnO 2 electron transport layer (ETL) (fig.  S3 )  (12) . The conventional spiro-OMeTAD doping process requires an oxidation time of ~24 hours to reach the optimized PCE of 22.2% (Fig.  1B , fig.  S4A , and table  S1 ). The gradual improvement in device performance with increasing oxidation time is consistent with the conductivity increase (fig.  S5A ) that resulted from the continuous generation of spiro-OMeTAD •+ TFSI -radicals, as evidenced by the ultraviolet-visible-near-infrared (UV-Vis-NIR) absorption spectra (fig.  S5B )  (29, 30) . In our IM spiro-OMeTAD doping strategy, the first additive consists of presynthesized spiro-OMeTAD 2•+ (TFSI -) 2  (31, 32) , which can be immediately converted into spiro-OMeTAD •+ TFSI - monoradicals through comproportionation with the neutral spiro-OMeTAD  (25) : spiro-OMeTAD þ spiro-OMeTAD 2•þ TFSI À ð Þ 2 → 2 spiro-OMeTAD •þ TFSI À ð1Þ We note that more radical cations (and hence a higher conductivity) are obtained at lower dopant levels using the current approach than using LiTFSI, as indicated by absorption spectra and conductivity measurements (fig.  S5 ). Upon the incorporation of radicals, the device performance improved relative to undoped spiro-OMeTAD (fig.  S4B ), and an optimal performance was reached with the doping radical ratio of ~14 mol % (calculated to the ratio of monoradicals). However, compared to a high open-circuit voltage (V oc ) of 1.15 V achieved with the conventional doping recipe, the optimized V oc of spiro-OMeTAD doped with radicals was 1.04 V (Fig.  1B ). Upon addition of the second additive (ionic salt, TBMP + TFSI -), the V oc of the solar cells increased and a V oc of 1.17 V was achieved with 20 mol % TBMP + TFSI -. The resulting PCE of 23.4 % was even higher than that based on the conventional doping (Fig.  1B ). Further increasing the TBMP + TFSI -content led to a decrease in the fill factor (FF) (fig.  S4C  and table  S2 ) possibly because of ion aggregation (fig.  S6 ). The high V oc of the optimized devices was also consistent with the values of electroluminescence external quantum efficiency (EL EQE ), which increased from 0.05% to 5.4% upon the addition of 20 mol % TBMP + TFSI - into the HTL (fig.  S7 ), indicating reduced nonradiative recombination. Remarkably, based on the meso-TiO 2 scaffold with FAPbI 3 as the active layer, the IM radical doping of spiro-OMeTAD delivered a PCE of 25.1% (table  S3 , certified 25.0% in fig.  S8 ), which was again higher than that of the control device with conventionally doped spiro-OMeTAD (Fig.  1C ). The PCE statistics demonstrated that the IM radical doping strategy, which did not involve a post-oxidation process, was more controllable than the conventional doping process (fig.  S9 ). Because the IM radical doping strategy completely removed the need to use hygroscopic LiTFSI and volatile tBP, an improvement in device stability can be expected. We systematically compared the device stability with IM radical doping versus conventional doping as a function of RH, heat, and illumination. Relative to the conventional doping of spiro-OMeTAD, the IM radical doping strategy extended the T 80 of PSCs (unencapsulated) from ~96 to ~1240 hours under high RH of ~70 ± 5% (Fig.  1D  and fig.  S10 ), and T 80 from ~264 to ~796 hours under ~70°± 3°C (Fig.  1E  and fig.  S11 ). The improved device stability with the IM radical-doped HTL was ascribed to not only the improved stability of HTL but also the prevention of phase and thermal degradation of the perovskite active layer under high RH and under heat stress, as evidenced from optical images (fig.  S12 ) and x-ray diffraction results (figs. S13 and S14) of the degraded devices. Scanning electron microscopy (SEM) images provided more details of the protection effect from the spiro-OMeTAD HTL based on IM radical doping. A large number of pinholes were observed in degraded devices based on the conventionally doped HTLs, implying that LiTFSI residuals absorbed moisture and that tBP volatilized gradually. Both effects accelerated the degradation of the perovskite active layer (figs. S15 and S16). In contrast, the devices based on the IM radical doping strategy maintained a compact and uniform morphology after long-term exposure to high RH and thermal stress (figs. S15 and S17), protecting the perovskite layer underneath. In addition, under maximum power point (MPP) tracking, the PCEs of PSCs based on conventional doping decayed to ~85% after 500 hours of continuous illumination. Devices based on the IM radical doping strategy maintained ~95% of the initial PCE after the same operational time (fig.  S18 ), similar to that of devices using inorganic HTLs  (33, 34)  or undoped polymer HTLs  (35) . 
 The roles of radicals and ionic salts on spiro-OMeTAD doping Our IM radical doping strategy provided an instantly effective and stable doping of spiro-OMeTAD. In addition, this simple process allowed us to decouple and investigate the fundamental functions of additives (radicals and ionic salts). We focused on two physical parameters that are key to the effectiveness of the HTL: conductivity and energy levels [including both WF and ionization energy (IE)]. To investigate the HTL conductivity, we used hole-only devices with the structure ITO/PEDOT: PSS/doped spiro-OMeTAD/Au [ITO, indium tin oxide; PEDOT, poly(3,4-ethylenedioxythiophene); PSS, polystyrene sulfonate]. The effects of organic radicals on the film conductivity (Fig.  2 , A and B) showed two distinct stages as a function of an increasing amount of organic radicals. There was initially an extremely high doping efficiency with a small doping ratio of radicals (<2 mol %; Fig.  2B , light blue area), which suggested efficient hole polaron generation. In particular, 0.1 mol % of radicals could increase the conductivity of the film by almost four orders of magnitude, from 1.10 × 10 -8 S cm -1 to 8.03 × 10 -5 S cm -1 . This increase could be attributed to the filling of deep trap states by dopant-generated charge carriers, which would bring increased carrier concentration as well as higher carrier mobility  (36) . For higher doping concentrations, the holeonly current density exhibited a linear dependence over the entire voltage range from 0 V to 5 V, indicative of a high hole concentration in the system. In the second stage (doping ratio from 2 mol % to 60 mol %, marked by the light red area), the doping efficiency nearly saturated and the conductivity peaked at ~1.00 × 10 -3 S cm -1 at ~14 mol % radicals (Fig.  2B ). This doping saturation phenomenon was consistent with previous reports in other organic semi-conductor systems and is ascribed to the increase in energetic disorder induced by long-range Coulomb interactions when increasing the number of dopants  (37) . The addition of the TBMP + TFSI -ionic salt had negligible effects on the film conductivity over a wide range of concentrations (up to 20 mol %) (Fig.  2C ), beyond which a slight decrease in film conductivity was observed, possibly because of the aforementioned phase aggregation and increased disorder in the film (see below). In addition to conductivity, the energy level alignment at the HTL interface is another parameter that is critically important to device performance. An optimal energy level of the HTL helps to facilitate hole extraction and eliminate interfacial nonradiative recombination, contributing to high device performance (especially high V oc ). We investigated the impact of the radicals on the relevant energy levels by ultraviolet photoelectron spectroscopy (UPS). For the pristine spiro-OMeTAD, the ionization energy (IE) was 5.08 eV, which according to Koopmans' theorem  (38)  corresponds to the energy of the highest occupied molecular orbital (HOMO), and the WF was 4.36 eV (fig.  S19A ). The density functional theory (DFT) results showed that the IE of an isolated spiro-OMeTAD molecule was ~5.46 eV, and this value decreased to 5.03 eV when the calculations were performed by taking into account an effective medium with a dielectric constant of 2.4 (fig.  S20 ). With increasing amounts of radicals, both IE and WF increased (Fig.  2D ). A more detailed comparison revealed that the difference between WF and IE decreases along with increasing dopant concentration (Fig.  2D ), emphasizing the extent to which the Fermi level moves toward the HOMO level, which is a key signature of p-doping. Combining the conductivity results in Fig.  2B , we noticed that a radical concentration of >2 mol % could affect the energy levels of the film despite almost no improvement in conductivity. The shift of energetic levels saturated at ~14 mol % radical doping, which is due to the limit in charge transfer and hole generation  (37) . Based on the 14 mol % radical-doped system, we further assessed the effect of the TBMP + TFSI -ionic salt on the film energy levels. In contrast to the simultaneous change of the HOMO level and WF upon the addition of radicals, the ionic salt increased the WF to 5.08 eV with 20 mol % TBMP + TFSI -but had a negligible effect on the HOMO levels (Fig.  2E  and fig.  S19B ). The slightly decreased WF with 30% TBMP + TFSI -was ascribed to the effects of ion aggregation (fig.  S6 ). As such, the addition of TBMP + TFSI -breaks the doping limit of radical doping, resulting in a Fermi level that is very close to the HOMO level (the difference is as small as 0.12 eV, a value much smaller than those obtained in traditional organic semiconductor doping). The promoted doping efficiency after TBMP + TFSI -incorporation was also confirmed by the increased carrier concentration, as indicated from a Mott-Schottky analysis (fig.  S21 ). In PSCs, as long as the HOMO energy of the HTL remains above the valence band of perovskites, it has little impact on the device V oc value. For example, different HTLs with HOMO energies between -5.2 and -5.4 eV have almost the same J-V curves  (39) . Within a suitable HOMO energy range, an optimal WF of the HTL aligned with the quasi-Fermi level (QFL) of the perovskite active layer is critical to minimizing the voltage loss  (40, 41) . As illustrated in Fig.  2F , the increase of the WF by the TBMP + TFSI -reduced the hole extraction barrier between the perovskite and the IM radical-doped HTL film. This change enables a high QFL splitting in the perovskites under illumination by eliminating the interfacial nonradiative recombination loss. Thus, this WF modulation by the ionic salt is important, as this V oc improvement made it possible for the device based on our IM radical doping strategy to reach the performance comparable to that based on conventional doping (refer to Fig.  1, B  and C ). From these conductivity and energy level investigations, the different functions assumed by the organic radicals and ionic salts become clear. The radicals enhance the conductivity and affect the energy levels (both HOMO and WF); the ionic salts further optimize the WF and contribute to optimal V oc values in the devices. The effectiveness of the radicals as a means of tuning the conductivity and energy levels can be understood with a charge transfer model between neutral spiro-OMeTAD and the spiro-OMeTAD •+ TFSI -radical. For neutral spiro-OMeTAD, the Fermi level (E F ) corresponds to an energy about midway between the lowest unoccupied molecular orbital (LUMO) and HOMO levels (fig.  S20 ). The low film conductivity in the absence of dopant can be understood by poor film crystallinity and low charge carrier concentrations, which are determined by thermal excitation of charge carriers from HOMO to LUMO levels. Upon radical doping, spiro-OMeTAD •+ TFSI - provides additional electronic states (42) (figs. S22 to S24)-specifically, bound hole states corresponding to singly unoccupied molecular orbital (SUMO) levels stabilized by Coulombic attraction from the TFSI -counterion. Electron transfer from neutral spiro-OMeTAD (host) to spiro-OMeTAD •+ TFSI - radical complex (dopant) leads to the generation of free hole polarons and increases the conductivity (Fig.  3A ). Concurrently, the hole filling of the transport states downshifts the Fermi level and increases the WF (Fig.  2D )  (43, 44) . 
 The mechanism of ionic salts modulating spiro-OMeTAD doping We now turn to a discussion of how ionic salts can further tune the WF. We did not observe oxidation or reduction between ionic salts and neutral spiro-OMeTAD/spiro-OMeTAD •+ TFSI -(figs. S25 and S26). A straightforward possibility for inducing the WF change is the introduction of a macroscopic dipole, which could be induced either by a particular spiro-OMeTAD orientation  (45)  or by an interfacial TBMP + TFSI -accumulation  (46) . We excluded the former on the basis of the grazing-incidence wide-angle x-ray scattering (GIWAXS) results (fig.  S27 ), which indicated neither stacking mode change nor crystallization amelioration upon addition of TBMP + TFSI -. The latter could be ruled out because timeof-flight secondary ion mass spectroscopy (TOF-SIMS) measurements showed a uniform distribution of S -, C 4 H 9 -, C 5 H 4 N -, and CF 3 across the entire HTL (fig.  S28 ), indicating the absence of surface dipoles formed by TBMP + TFSI -. In addition, the incorporation of ionic salts increased the WF more than its effects on the IE (Fig.  2D ), further ruling out the possibility of the surface-dipole effect. The exclusion of macroscopic dipole formation motivated us to understand the WF tuning mechanism at the molecular level. Both radicals and salts are ionic, so Coulomb interactions among them are to be expected and would affect their frontier orbital energetics. Details on the Coulomb interactions between the ionic salts and radicals were obtained from both high-resolution liquid and solid-state nuclear magnetic resonance (hr-and ss-NMR, respectively) spectroscopies (Fig.  3B ). Although NMR spectroscopy cannot provide direct information on radicals given the strong interactions of unpaired electrons with NMR active nuclei, comparison between different samples provided useful information on the interactions in our mixture. We observed electron transfer between spiro-OMeTAD •+ TFSI -and spiro-OMeTAD, in that all 1 H signals (labeled a to f) of spiro-OMeTAD hr-NMR spectra were broadened after the addition of spiro-OMeTAD •+ TFSI -(Fig.  3B  and fig.  S29 ). The broad signal half-widths suggested that spiro-OMeTAD •+ TFSI -and neutral spiro-OMeTAD were near each other and mutually exchanging electrons, which could be attributed to p-p stacking between fluorene moieties of spiro-OMeTAD and spiro-OMeTAD •+ TFSI -(47, 48). However, the 1 H NMR signals of spiro-OMeTAD d+e+f were more broadened while the b and c peaks were only slightly affected, indicating that the electron exchange between spiro-OMeTAD and spiro-OMeTAD •+ TFSI -influenced the molecules only partially on the fluorene part  (49) . Upon addition of TBMP + TFSI -into the spiro-OMeTAD and spiro-OMeTAD •+ TFSI -mixture, the 1 H NMR signals from all aromatic protons (b, c, and d+e+f) of spiro-OMeTAD nearly disappeared (Fig.  3B ). This indicated more effective electron exchange between spiro-OMeTAD and spiro-OMeTAD •+ TFSI -in the presence of the TBMP + TFSI -salt. Because direct interactions between TBMP + TFSI -and spiro-OMeTAD were negligible (fig.  S29A ), we attributed the effect of TBMP + TFSI -on the 1 H hr-NMR signals (Fig.  3B ) to Coulomb interactions between spiro-OMeTAD •+ TFSI -and TBMP + TFSI -, which enhanced charge transfer between spiro-OMeTAD and spiro-OMeTAD •+ TFSI -in the presence of the TBMP + TFSI -salt. The emergence of these interactions is consistent with the shift and narrowing of the 19 F ss-NMR peak of TFSI -(fig.  S30 ). A complementary electron paramagnetic resonance (EPR) study from 77 K to room temperature demonstrated a Lorentzian broadening of EPR spectra in our radical-doped spiro-OMeTAD (for samples both with and without TBMP + TFSI -) (Fig.  3C  and figs. S31 and S32). We attributed this effect to the dynamic broadening due to the electron selfexchange between the neutral spiro-OMeTAD and spiro-OMeTAD •+ TFSI -radical. Within the intermediate exchange rate limit, the EPR broadening upon TBMP + TFSI -incorporation was attributed to the increased electron transfer rate between the neutral spiro-OMeTAD and spiro-OMeTAD •+ TFSI -radical that decreased the spin lifetime  (50) . We further investigated the impact of these Coulomb interactions on the frontier orbital energies by combining the photoelectron spectroscopy data and DFT results. The incorporation of TBMP + TFSI -not only decreased the energy offset between the HOMO level and the Fermi level but also changed the density of states (DOS) of frontier orbitals (Fig.  3D ). In addition, low-energy inverse photoelectron spectra (LEIPS) indicated that the SUMO level of spiro-OMeTAD •+ downshifted from -4.06 to -4.30 eV upon addition of TBMP + TFSI - (fig.  S33 ). The DFT calculations highlighted the effect of the ionic salt on the molecular orbital levels (figs. S34 and S35), which we rationalized by considering that the TBMP + TFSI -ionic salt screened the Coulomb attraction between the counterion and hole polaron in the spiro-OMeTAD •+ TFSI -complex  (51) . In this context, the impact of the TBMP + TFSI -can be viewed as a modulation of the activation energy of doping (E d a ) related to the energy difference between the doping states and transport states (Fig.  3E ), because neutral spiro-OMeTAD molecules close to TFSI -anions from the ionic salts can homogenize the electrostatic potential of the transport states, resulting in decreased E d a and increased WF. Given this understanding of the impact of ionic salts on the energetic levels, we investigated why there was no conductivity enhancement with increasing WF, a feature that makes it decouple conductivity and WF tuning. Decreasing the E d a of dopants upon ionic salt addition (Fig.  3E ) enabled an increasing fraction of hole polarons to be thermally populated. This effect, taken alone, would lead to a conductivity increase. However, the temperaturedependent conductivity indicated that the ionic salts also increase disorder. The temperaturedependent conductivity measurements revealed a faster-decreasing rate of conductivity upon addition of TBMP + TFSI -and suggested an increased long-distance intermolecular charge hopping potential barrier (E h a ) from 0.14 eV to 0.20 eV (52, 53) (Fig.  3F  and fig.  S36 ). This more difficult long-distance intermolecular charge transfer implied a decreased mobility that might be induced by increased disorder or more scattering from ionic clusters  (54, 55) . Overall, the ionic salts played a dual role: They increased the free hole population but also increased disorder. These two effects largely compensated each other and led to negligible conductivity changes over a broad range of ionic salt concentrations. 
 The generality of the IM radical doping strategy Stimulated by the possibilities of precise energetic manipulation and facile conductivity tunability, we applied the IM radical doping approach to perovskites with different compositions and devices with different architectures (planar or mesoporous structures). In addition to the PSCs based on SnO 2 / (FAPbI 3 ) 0.99 (MAPbBr 3 ) 0.01 and TiO 2 /FAPbI 3 shown in Fig.  1, B  and C , IM radical-doped spiro-OMeTAD HTLs also resulted in high PCEs in perovskites with different band gaps, different fabrication methods (one-step or twostep), and with or without ionic liquid additives. All PCEs were similar to (or slightly higher than) those based on conventionally doped spiro-OMeTAD HTL (Fig.  4A , fig.  S37 , and tables S4 and S5), indicating that our IM radical doping strategy is applicable to different PSCs. In addition, we observed improved stability (both under high RH and high temperature) for all the PSCs using IM radical-doped spiro-OMeTAD compared with those using conventionally doped spiro-OMeTAD (fig.  S38 ). The generality of the IM radical doping strategy was also demonstrated in terms of the ionic salts. We investigated six additional ionic salts, based on typical anions [bis(trifluoromethylsulfonyl)imide, hexafluorophosphate, tetrafluoroborate, p-toluenesulfonate] and cations (ethyldimethylpropylammonium, propylpyridinium, imidazolium, methylpyridinium) (Fig.  4B ). All of the ionic salts could effectively tune the WF (Fig.  4B  and fig.  S39 ) without negatively affecting the conductivity (fig.  S40 ). Their incorporation resulted in high V oc values (~1.12 to 1.16 V) and high PCEs (~22% to 23%) in SnO 2 / (FAPbI 3 ) 0.99 (MAPbBr 3 ) 0.01 -based PSCs (Fig.  4C  and table  S6 ). Although the use of different cations resulted in negligible WF modifications, we noted that switching from TFSI -to other anions could slightly decrease the WF, which pointed to the anions playing a more prominent role in the energetic modulation in the framework of the IM radical doping strategy. A possible reason is that the anions coming from the ionic salts can exchange with TFSI - in the radical complex, resulting in new radical complex species with different energetics. 
 Discussion Because the energetics of the hole polarons are sensitive to their local ionic environment, the IM radical doping strategy provides room to manipulate the WF as a function of the nature of the ionic salts. WF tuning could be achieved over a large range by controlling the interaction strength between the ionic salts and the radical complex and is more easily adjustable than WF modulation through interfacial molecular dipoles  (46) . As such, the IM radical doping strategy fills the gap between several previous strategies to enhance WF and conductivity and greatly expands the toolbox for organic semiconductor doping  (56, 57) . 
 Materials and Methods 
 Materials synthesis Synthesis of spiro-OMeTAD 2•+ (TFSI -)2 To an oven-dried 50 mL flask were added spiro-OMeTAD (1.26 g, 1 mmol) and 20 mL anhydrous dichloromethane (DCM) with stirring under nitrogen atmosphere. Silver(I) bis(trifluoromethanesulfonyl)imide (Ag-TFSI) (0.78 g, 2 mmol) was added over 5 min at room temperature. The flask was evacuated and backfilled with nitrogen. The resultant mixture was stirred at room temperature for 24 h. The reaction was diluted by adding dichloromethane. A gray precipitate of silver (0) was filtered off by Anopore inorganic membrane, and the solvent from the filtrate was removed to leave a dark solid. The solid was dissolved in a minimal amount of dichloromethane and precipitated in dry diethyl ether. The resulting fine and dark powder spiro-OMeTAD 2•+ (TFSI -)2 was collected via filtration through Anopore inorganic membrane. The dark crystal was obtained by vapor diffusion of diethyl ether into concentrated DCM solution of spiro-OMeTAD 2•+ (TFSI -)2 at 8 o C. spiro-OMeTAD 2•+ (TFSI -)2 was characterized by X-ray diffraction single crystal analysis. X-ray intensities of spiro-OMeTAD 2•+ (TFSI -)2 were collected at 296 K on a Bruker AXS Kappa Apex II Duo diffractometer with Mo Kα radiation (λ = 0.71073 Å) from a sealed-tube generator. Unit cell dimensions were obtained with leastsquares refinements, and all structures were solved by direct methods using SHELXS-97. The other non-hydrogen atoms were located in successive difference Fourier syntheses. The final refinement was performed by full-matrix least-squares methods with anisotropic thermal parameters for non-hydrogen atoms on F2. The hydrogen atoms were added theoretically and riding on the concerned atoms. The crystallographic data can be referred to the previously published report  (31) . Spiro-OMeTAD 2•+ (TFSI -)2 was further characterized by XPS and UV-Vis absorption, as shown in Fig.  S2 . From the XPS results, compared to only one Gaussian-shaped N peak at 400.2 eV in neutral spiro-OMeTAD, the spiro-OMeTAD 2•+ (TFSI -)2 N peak can be deconvoluted into three components, with N -at 399.7 eV, N at 400.1 eV and N •+ at 401.9 eV, respectively. From the UV-Vis absorption spectra, neutral spiro-OMeTAD has a steep absorption band edge at 405 nm, which corresponds to the S0-S1 (essentially HOMO to LUMO) transition of spiro-OMeTAD. Once oxidized, the spiro-OMeTAD 2•+ (TFSI -)2 shows three additional absorption peaks. The peak at around 510 nm corresponds to transition from MOs localized on the MeO-substituted phenyls to unoccupied MOs of π* character within the MeO-substituted moieties. The peak at around 700 nm corresponds to a charge transfer from MeO-phenyl groups to fluorene moieties combined with π-π* excitations within the fluorene moieties  (29) . The broad peak located in the infrared region refers to an inter-valence charge transfer (IVCT) band  (30) . The strong IVCT absorption is due to the dynamically delocalized hole over the half moiety of spiro-OMeTAD. Note that the anomaly in the absorption spectrum of spiro-OMeTAD 2•+ (TFSI -)2 at around 1700 nm is due to detector switch. 
 Synthesis of 4-tert-butyl-1-methylpyridinium-based salts To a 100 mL flask were added tBP (1.35 g, 10 mmol) and anhydrous acetonitrile (10 mL) with stirring under nitrogen atmosphere. Iodomethane (4.2 g, 30 mmol) in anhydrous acetonitrile (2.5 mL) was added by a dropping funnel over 30 min at room temperature. The resultant mixture was heated under reflux for 16 h then left at room temperature. After removal of solvent under reduced pressure, the crude product 4-tert-butyl-1-methylpyridinium iodide (TBMP + I -) was obtained, which was then purified by recrystallization. Anion exchanges were used to achieve other TBMP-based salts. To a solution of TBMP + I -(1.39 g, 5 mmol) in 5 mL methanol, a solution of silver(I) bis(trifluoromethanesulfonyl)imide (Ag-TFSI) (10 mmol) in acetonitrile (5 mL) was added dropwise to the heated reaction mixture under magnetic stirring. A thick yellow precipitate of silver(I) iodide formed. After 4 hours reflux, the precipitate was filtered off and rinsed with methanol, and the solvent from the filtrate was evaporated to leave a waxy solid 4tert-butyl-1-methylpyridinium bis(trifluoromethanesulfonyl)imide (TBMP + TFSI -). Alternatively, 10 mmol of silver(I) hexafluorophospate (Ag-PF6), silver(I) terafluoroborate (Ag-BF4), and silver(I) p-methylbenzenesulfonate (Ag-PS) were applied to obtain 4-tert-butyl-1methylpyridinium hexafluorophospate (TBMP + PF6 -), 4-tert-butyl-1-methylpyridinium terafluoroborate (TBMP + BF4 -) and 4-tert-butyl-1-methylpyridinium p-methylbenzenesulfonate (TBMP + PS -), respectively. The obtained products were characterized by proton nuclear magnetic resonance ( 1 H NMR) and carbon nuclear magnetic resonance ( 13 C NMR) spectra on Varian 500 MHz spectrometer. TBMP + TFSI -: 1 H NMR (500 MHz, Methanol-d4) δ 8.77 (d, J = 6.8 Hz, 2H), 8.13 (d, J = 7.0 Hz, 2H), 4.39 (s, 3H), 1.48 (s, 9H). 13  TBMP + PF6 -: 1 H NMR (500 MHz, Methanol-d4) δ 8.75 (d, J = 6.8 Hz, 2H), 8.12 (d, J = 6.9 Hz, 2H), 4.37 (s, 3H), 1.47 (s, 9H). 13  The other ionic salts, ethyldimethylpropylammonium bis(trifluoromethylsulfonyl)imide (EDMPA + TFSI -), 3-methyl-1-propylpyridinium bis(trifluormethylsulfonyl)imide (PMPlm), 1propyl-3-methyl-imidazolium bis(trifluoromethylsulfonyl)imide (BMIM + TFSI -), were purchased directly from Sigma-Aldrich without further purification. 
 Precursor preparation The conventional doping of spiro-OMeTAD was prepared by dissolving 72.3 mg spiro-OMeTAD (99.9%, Sigma-Aldrich) in 1 mL chlorobenzene (anhydrous, 99.8%, Sigma-Aldrich) and doped with 25 μL lithium bis(trifluoromethylsulfonyl)imide (99.95%, Sigma-Aldrich) salt in acetonitrile (520 mg mL -1 ) and 35 μL 4-tert-butylpyridine (96%, Sigma-Aldrich), and stirred at room temperature overnight. The IM radical doping of spiro-OMeTAD was initiated by mixing 90 mg ml -1 spiro-OMeTAD in the chlorobenzene solution with various content of spiro-OMeTAD 2•+ (TFSI -)2 and TBMP + TFSI -or other ionic salts. The narrow bandgap perovskite (FAPbI3)0.99(MAPbBr3)0.01 active layer precursor was prepared by mixing 1.81 M lead iodide (PbI2) (Anhydro Beads, 99.999% Sigma-Aldrich), 1.65 M formamidium iodide (FAI) (Greatcell solar), 0.58 M methylamonium choloride (MACl) (Xi'an Polymer Light Technology Corp.), 0.014 M lead bromide (PbBr2) (99.999% Sigma-Aldrich) and 0.014 M methylammonium bromide (MABr) (Greatcell solar) and dissolved in anhydrous N, N-dimethylformamide (DMF, 99.8%, Sigma-Aldrich) and dimethyl sulfoxide (DMSO, 99.9%, Sigma-Aldrich) with the volume ratio of 8:1 mixed solution. For the recipe with ionic liquids as additives, 0.5 mg ml -1 Potassium hexafluorophosphate (KPF6, ≥99%, Sigma-Aldrich) was added into the perovskite precursors. The wide bandgap perovskite Cs0.05(FA0.8MA0.2)0.95Pb(I0.8Br0.2)3 precursor was prepared by mixing 1.5 M nominal FAPbI3 (with 9 % PbI2 excess) and MAPbBr3 (with 9 % PbBr2 excess) in DMF:DMSO = 4:1 volume, with the volume ratio of 77:23. Finally, 5 vol% of 1.5 M nominal CsI (Anhydro Beads, 99.999% Sigma-Aldrich) in DMSO was added to the perovskite precursor. 
 Device fabrication For the devices based on the SnO2 electron transport layer (ETL) (used in stability test): All ITO substrates were ultrasonic cleaned sequentially in deionized (DI) water and ethanol for 15 min respectively, and dried by a compressed nitrogen gun. After 15 min UV-Ozone surface treatment, we deposited SnO2 ETL by spin coating a 1:6 diluted SnO2 nanoparticle water solution (Alfa Aeser) at 4,000 rpm for 30 s, followed by annealing at 150 °C for 20 min in air. Afterwards, a thin potassium chloride (KCl, 99 %, Sigma-Aldrich) layer was deposited by spin coating 1 mg ml -1 KCl DI water solution at 3,000 rpm for 30 s and annealed at 100 °C for 10 min in air. The perovskite solution was then deposited via spin coating at 5000 rpm for 30 sec (2,000 rpm ramp). Within 10 seconds of the 5,000-rpm spinning, 100 μL of chlorobenzene as the antisolvent was deposited onto the film. After spin-coating, the perovskite film was then annealed at 150 °C for 15 min in ambient air. Then the 5 mg ml -1 n-Octylammonium iodide (OAI, Greatcell solar) solution in tert-butanol (IPA, anhydrous, ≥99.5%, Sigma-Aldrich) was span coated onto the perovskite surface at 4000 rpm and annealed at 100 °C for 3 min for the surface passivation. Later, the different hole transport layers were deposited by spin coating at 5,000 rpm for 30 s without further annealing. Metal electrodes 80 nm Au was deposited on hole transporting layer through thermal evaporation method under a vacuum degree higher than 3×10 - For the MAPbI3 layer deposition, the 1.2 M MAPbI3 in DMF with 2 mol% Pb(SCN)2 as additive was deposited on the SnO2 substrate and spun using one step spin-coating process (3,500 rpm). 100 µl of chlorobenzene as the anti-solvent was dripped on the film. The perovskite films were then annealed at 100 °C for 20 min in the ambient atmosphere. For the device based on the wide bandgap perovskite, the perovskite layer was spread on the SnO2 substrate and spun using one step spin-coating process (3,500 rpm). During spin-coating, 160 µl of Anisole (anhydrous, 99.7%, Sigma-Aldrich) as the anti-solvent was dripped on the film. The perovskite films were then annealed at 100 °C for 20 min in the ambient atmosphere. For the two-step perovskite deposition, the 1.5 M PbI2 in DMSO : DMF 1 : 9 solution was deposited on the SnO2 substrate and spun at 1,500 rpm for 30 s and then annealed at 70 °C for 1 min. Then ammonium salt solution (90 mg ml -1 FAI, 6 mg ml -1 MAI and 9 mg ml -1 MACl) was dynamically spun onto the PbI2 film at 2,000 rpm. After soaking for 1 min, the perovskite film was annealed at 150 °C for 15 min in the ambient atmosphere. Then the 5 mg ml -1 phenethylammonium iodide (PEAI, Greatcell solar) solution in IPA was span coated onto the perovskite surface at 5,000 rpm without further annealing. The PSCs using FAPbI3 based mesoporous TiO2 were fabricated using the following process. The substrates (Asahi FTO glass (1.8 mm, 7 Ω sq -1 )) were cleaned using the RCA-2 (H2O2-HCl-H2O) procedure for 15 min to remove surface impurities. Then the substrates were cleaned sequentially with acetone, ethanol and IPA in an ultrasonic system for 15 min, respectively. To deposit the compact TiO2 (c-TiO2) layer, 60 ml of a titanium diisopropoxide bis(acetylacetonate)/ethanol (1:10 volume ratio) solution was applied using the spray-pyrolysis method. The FTO substrates were previously placed on a hot plate and the temperature was increased to 450 °C rapidly before the spray process. After the spray pyrolysis step, the substrates were stored at 450 °C for 1 h and then slowly cooled to room temperature. Before mesoporous TiO2 (m-TiO2) layer coating, plasma treatment was conducted on c-TiO2 surface for 15 min. A m-TiO2 layer was continuously deposited by spin-coating a TiO2 paste (ShareChem, with the diameter ~40 nm) dispersed in 2-methoxyethanol/terpineol (78:22 w/w). The FTO/c-TiO2 substrates prepared with m-TiO2 were heated at 500 °C on a hot plate for 1 h to remove organic compounds first, and then slowly cooled to room temperature. Later, the perovskite precursor solution was prepared by mixing 1,139 mg FAPbI3 and 35 mol% MACl in a mixture of DMF and DMSO (4:1). The precursor solutions were filtered using a 0.2 µL pore-sized filter (Whatman). After plasma treatment on m-TiO2 surface for 15min, 70 μl of the precursor solution was spread over the m-TiO2 layer at 6,000 rpm for 50 s with 0.1 s ramping. During the spincoating, 1 ml diethyl ether was dripped after spinning for 10 s. The perovskite film was then dried on a hot plate at 150 °C for 10 min immediately. After cooling, 15 mM of octylammonium iodide (OAI, Aldrich) dissolved in IPA was spin-coated on top of the perovskite film at 3,000 rpm for 30 s. The whole process of perovskite layer deposition was carried out at controlled room temperature (25 °C) and humidity (20% RH). The HTLs were deposited by spin-coating the doped spiro-OMeTAD (Lumtec) solution at 3,000 rpm for 30 s. 
 Supplementary Text Characterizations and measurements X-ray diffraction (XRD) patterns were obtained from an X-ray diffractometer (Panalytical X'Pert Pro) with an X-ray tube (Cu Kα, λ = 1.5406 Å). X-ray intensities of spiro-OMeTAD 2•+ (TFSI -)2 were collected at 296 K on a Bruker AXS Kappa Apex II Duo diffractometer with Mo Kα radiation (λ=0.71073 Å) from a sealed-tube generator. 
 Ultraviolet-visible (UV-Vis) absorption spectra were measured with a PerkinElmer model Lambda 900 fitted with a reflection/transmission accessory. 
 Time-of-Flight Secondary Ion Mass Spectrometry (TOF-SIMS) measurements were performed on a TOF-SIMS.5 instrument from IONTOF, operated in the spectral mode using a 25 keV Bi3 + primary ion beam with an ion current of 0.78 pA. A mass-resolving power of approximately 6,000 m/∆m was reached. For depth profiling a 1 keV Cs + sputter beam with a current of 39.81 nA was used to remove the material layer-by-layer in interlaced mode from a raster area of 500 × 500 µm. This raster area was chosen to ensure a flat crater bottom over an area of 100 × 100 µm used for the mass spectrometry. The position of the ITO substrate interface in the sputter depth profile was defined by the half-maximum of the In2 + secondary ion count rate. Steady-state photoluminescence (PL) spectra were recorded using a commercially spectrometer (FLS 1000) with a 200 W Xe lamp as an excitation source. Time resolved photoluminescence (TRPL) spectra measurements were taken on a 1 μm 2 laser spot size at room temperature using commercially spectrometer (FLS 1000) with 635 nm laser source (less than 100 ps, 0.1 MHz).  (58, 59)  measurements were performed using an experimental apparatus described elsewhere  (60) . Briefly, an electron beam is incident to the sample film. The emitted photons are collected and focused into a photon detector consisting of an optical bandpass filter (Semrock Inc.; center wavelengths at 232, 260, and 285 nm) and a photomultiplier tube (R585, Hamamatsu Photonics K.K). We performed measurements at different wavelengths to minimize the uncertainties. In order to avoid the sample damage, the kinetic energy of incident electrons was restricted to less than 5 eV and the electron current of around 4 x 10 -7 A. 
 Low energy inversed photo-electron spectroscopy (LEIPS) Grazing-incidence wide-angle X-ray scattering (GIWAXS) was recorded at the Shanghai Synchrotron Radiation Facility. The diffraction patterns were collected by two dimensional MarCCD 225 detector with 234 mm from the sample to the detector. All the samples were protected with N2 gas during the measurements. To assure the diffraction intensity, an exposure time of 15 s was adopted with an incidence angle of 0.5°, and the wavelength of the X-ray was 1.24 Å (10 KeV). The photoelectron spectroscopic experiments, UPS (HeI hv = 21.22 eV) and XPS (monochromatized Al K h = 1486.6 eV), were carried out using a Scienta-200 hemispherical analyzer or dedicated home designed and built spectrometer and calibrated by referencing to Fermi level and Au 4f 7/2 peak position of the Ar + ion sputter-clean gold foil. The XPS experimental condition was set so that the full-width at half-maximum of the clean Au 4f7/2 line (at the binding energy of 84.00 eV) was 0.65 eV. UPS was performed to study the interfacial alignment and the frontier electronic structure features with an error margin of ±0.05 eV. The work function and the vertical IP are derived from the secondary electron cut-off and the frontier edge of the occupied density of states. All spectra were measured at a photoelectron take-off angle of 0° (normal emission). 1 H hr-NMR spectra were acquired with a Bruker Avance III 600 spectrometer operating at 600.2 MHz for 1 H. The width of 1 H NMR 90° pulse was 18 μs, relaxation delay 10 s, acquisition time 2.73 s. Samples were dissolved in C2D2Cl4/C6D5Cl solvent mixture. The chemical shifts are relative to TMS using a sodium trimethylsilylpropanesulfonate (DSS, δ= 0.00 ppm from TMS in 1 H NMR spectra) aqueous solution as the external standard in capillary. All samples were measured at 295 K. 19 F solid-state NMR (ssNMR) spectra were collected using a 500 MHz Bruker Avance III HD NMR spectrometer (B0 = 11.7 T) at Larmor frequency ν( 19 F) = 470.639 MHz using a double-resonance 2.5-mm magic angle spinning (MAS) probe. All MAS NMR experiments were recorded without a decoupling sequence, using the spin-echo approach ( π /2-(t1)-π-aq.), where the t1 delay was rotor-synchronized (1 loop)  (61) . The experiments were performed at a 30 kHz spinning speed  (62) . The number of scans collected for each 19 F VF/MAS NMR spectrum was 16 at recycle delays 2 s. The 19 F chemical shift was calibrated using Teflon ( 19 F: -122 ppm). The solid samples were kept and packed into ZrO2 rotors under Ar atmosphere. All experimental conditions and concentrations of individual components were kept constant. 
 High-resolution liquid-and solid-state nuclear magnetic resonance (hr-and ss-NMR) Atomic Force microscopy (AFM) measurements were carried out using an AFM (Bruker Dimension Icon) in air with controlled humidity at around 20 RH%. 
 Photo current-voltage (J-V) curves were measured (2400 Series Source Meter, Keithley Instruments) under simulated AM 1.5 sunlight at 100 mW cm -2 irradiated by a Enlitech AAA sun simulator, with the intensity calibrated by a Si reference cell. The active area of the solar cell is 0.06 cm 2 . The forward J-V scans were measured from -0.2 V to 1.2 V and the reverse scans were from 1.2 V to -0.2 V, both at a scan rate of 200 mV s -1 . Conductivity measurements were conducted based on the ITO/PEDOT:PSS/doped spiro-OMeTAD/Au. The current-voltage curves from -5 V to 5 V were collected by the source meter (2400 Series Source Meter, Keithley Instruments). Temperature-dependent conductivity measurements were conducted by putting the device with structure of ITO/HTL/Au in a vacuum chamber. Each time when the temperature was stabilized by the temperature controller, the current-voltage curves from -1 V to 1 V were collected by the source meter (2400 Series Source Meter, Keithley Instruments). 
 EQE of electroluminescence (ELEQE) measurements were carried out at room temperature in a nitrogen-filled glovebox. A Keithley 2400 sourcemeter and a fibre integration sphere (FOIS-1) coupled with a QE Pro spectrometer (Ocean Optics) were used for the measurements. The devices are tested on top of the integration sphere and only forward light emission can be collected. The absolute radiance was calibrated by a standard Vis-NIR light source (HL-3P-INT-CAL plus, Ocean Optics). 
 Stability tests For all the humidity stability studies, the perovskite films and devices were stored at room temperature (measured as 25±1 °C) in a controlled-humidity cabinet with a transparent glass door, with a low-power fluorescent light in the room (light intensity around 5 w cm -1 ). The relative humidity in the chamber was controlled to the desired humidity of 70±5%. And the air humidity in the room was floating from 20% to 80%. The relative humidity in the cabinet was precisely measured periodically throughout the stability experiments using a calibrated hygrometer. The cabinet was only opened when taking the samples out for measurements. For the thermal stability test, the perovskite films and devices were stored in a closed oven with the fixed temperature at 70±3 °C. The oven was only opened when taking the samples out. The control device for the stability test has the structure of FTO/SnO2/Perovskite/HTLs/Au. Illumination stability measurements were performed in a dry air atmosphere at 25 °C and under standard one sun illumination (AM 1.5) with the output circuit keeping connected. All the devices in the stability test were unencapsulated. 
 Analysis based on DFT calculations 
 Neutral spiro-OMeTAD and the spiro-OMeTAD:TFSI radical complex: The electronic structures of the spiro-OMeTAD molecule and spiro-OMeTAD:TFSI complex were determined at the density functional theory (DFT) level using the long range corrected LC-hPBE functional (with 20% Hartree-Fock exchange) and the 6-31G** basis set, as implemented in Gaussian 16 program  (63) . The range-separation parameter () was optimized for an isolated molecule according the published procedure  (64, 65) , which led to ω = 0.129 bohr -1 . In order to account for the effect of the environment on the energy levels, calculations were also performed for a molecule embedded in a dielectric medium using the polarizable continuum model (PCM). The PCM calculations were performed for a dielectric constant =2.37 (corresponding to toluene). The electronic structures of the neutral and radical-cation states of the spiro-OMeTAD molecule are shown in fig.  S20  and fig.  S22 . respectively. As seen from fig.  S20 , the frontier molecular orbital (MO) of the neutral state is quasi-degenerate, indicating a very weak electronic communication between the two halves of the spiro molecule. The inspection of the 𝛼 and 𝛽 spin-orbitals of the radical-cation, derived by means of spinunrestricted DFT calculations, shows that the highest occupied 𝛼 and 𝛽 orbitals have nearly identical energies and wave-functions; therefore, following the terminology used for a neutral molecule, we can refer to this pair of orbitals as HOMOs (see fig.  S22 ). These is also true for the next two sets of 𝛼 and 𝛽 spin-orbitals that we label accordingly as HOMO-1 and HOMO-2. However, the 𝛼 orbital at -8.73 eV stands alone and then is followed by the HOMO-3 pair of orbitals; this 𝛼 orbital can be thus referred to as a SOMO (singly occupied MO). The electronicstructure configuration obtained for the spiro-OMeTAD radical-cation where the SOMO is located below the HOMO is referred to as non-Aufbau electronic configuration. We note that, as in the case of the SOMO, there is also an unoccupied spin-orbital (in this case, the 𝛽 spin-orbital at -4.99 eV) that stands alone, away from paired unoccupied orbitals. It is then common to call this unpaired unoccupied orbital as SUMO (singly unoccupied MO) and label as LUMOs the paired unoccupied orbitals  (66) . The vertical ionization energy (IE), computed as the difference between the total energies of the electronic radical-cation and neutral configurations of spiro-OMeTAD, is ca. 5.46 eV. This value compares well with the energy of the HOMO of neutral spiro-OMeTAD molecule, as expected when the DFT calculations are performed with optimally tuned long-range corrected functionals. The IE decreases to 5.03 eV in the case of PCM calculations performed for spiro-OMeTAD molecules embedded in a dielectric medium with =2.37. This value compares very well with the experimental value of 5.08 eV obtained for the pristine spiro-OMeTAD film, which suggests that the dielectric constant of the film is not significantly larger than 2. The DFT calculations indicate that, at the optimized geometry of the spiro-OMeTAD • :TFSI complex, there is a nearly full electron transfer from spiro-OMeTAD to TFSI, i.e., the complex can be seen as a spiro-OMeTAD •+ TFSI -ion pair. Therefore, the electronic structure of the spiro-OMeTAD • :TFSI complex can be understood as a superposition of the spiro-OMeTAD •+ radicalcation MOs and those of the closed-shell configuration of TFSI -, however, with the MO energies shifted due to mutual electrostatic interactions. As a result, the electronic structure of the OMeTAD •+ TFSI -complex (fig.  S23 ) resembles that of the non-Aufbau electronic pattern of the spiro-OMeTAD •+ radical-cation with the MO energies shifted and the wavefunctions spatially localized due electrostatic effects. The results indicate that the IE of spiro-OMeTAD • :TFSI is about 0.2 eV larger than that of spiro-OMeTAD, which agrees well with the UPS data showing a slight increase in the film IE upon presence of OMeTAD •+ TFSI -. The electronic structures of the neutral TFSI radical and the TFSI anion were given in fig.  S24 . The HOMO of the TFSI anion is calculated to be slightly higher than that of neutral spiro. 
 Ion modulation effect: The electronic structure of spiro-OMeTAD • :TFSI can be significantly affected by the presence of TBPM + and TFSI -ions, see fig.  S34  and fig.  S35 . The presence of TBPM + and TFSI -ions can also influence the intermolecular equilibrium distance within a spiro-OMeTAD •+ TFSI -radical complex and further affect its electronic structure. Therefore, additional extensive molecular dynamics simulations would be needed to better describe the influence of TBPM + TFSI -ions on the blend energetics. We note that, when viewing the last step of the radical doping as a hole transfer from a spiro-OMeTAD •+ TFSI -complex to a spiro-OMeTAD molecule away from the complex, we can use the total energies of the structures shown in Fig.  3A  to compute the activation energy (𝐸 𝑎 𝑑 ) necessary to release a hole from dopant levels to transport levels. The calculations show that, when the influence of medium polarization is neglected, 𝐸 𝑎 𝑑 is about 1.9 eV; this value sharply decreases to 0.8 eV when the calculations are performed using dielectric constant of =2.37. We note that the activation energy is further influenced by entropy effects not considered in our model. Clearly the 𝐸 𝑎 𝑑 can be also affected by ionic salts by modulating either/both the energy of doping or/and transport levels.    The VOC of solar cells is determined by the gap of the absorbing layer and the recombination processes (i.e. radiative and non-radiative recombination). Suboptimal energetic alignment between the absorbing layer and the charge transport layer is a source of non-radiative recombination. Upon the addition of radicals, both WF and HOMO of the HTL show downshifts, moving towards the QFL and valence band of perovskites. Further adding ionic salts makes it possible for the WF of the HTL to be better aligned with the QFL of the perovskite layer, minimizing non-radiative recombination and enhancing the VOC. In the conventional doping process with 56 mol% LiTFSI and 330 mol% tBP, the radical absorption intensity and film conductivity increase continuously with increasing oxidation time. However, both parameters have lower values than those in the film using the IM radical doping strategy which only contains 14 mol% spiro-OMeTAD •+ TFSI -. These results indicate that more radical cations and a higher conductivity are obtained at lower dopant levels using the IM radical doping approach than using LiTFSI.                 , C is the junction capacitance, V is the applied voltage, ε is the semiconductor permittivity, q is the unit charge, A is the junction area and NA is the carrier density. As expected, the addition of TBMP + TFSI -increases the carrier concentration, indicated by a lower slope of C -2 -V curve.    There is no significant change in the radical absorption spectra with the addition of TBMP + TFSI -, either. The absorption peak corresponding to the inter-valence charge transfer (IVCT) band of the radicals is slightly blue shifted, which can be ascribed to increased disorder in the film upon TBMP + TFSI -addition.    19 F NMR peak of spiro-OMeTAD and spiro-OMeTAD •+ TFSI -; spiro-OMeTAD, spiro-OMeTAD •+ TFSI -with TBMP + TFSI -; and pure TBMP + TFSI -. (Both 19 F ss-NMR spectra were performed at a 30 kHz spinning speed under magic angle.) Solid-state 19 F NMR peak of spiro-OMeTAD and spiro-OMeTAD •+ TFSI -is a broad peak with half width around 2.5 ppm. When TBMP-TFSI is added, there is actually still a broad peak (on the lefthand side, apparently small, but likely actually quite large in terms of integrated intensity) and a sharp peak one the righthand side, which reflects two different environments of TFSI -. However, the broad peak signal has a right shift and a narrower bandwidth around 1.5 ppm compared to the signal of spiro-OMeTAD and spiro-OMeTAD •+ TFSI -, and the sharp peak has a right shift compared to the signal of TBMP + TFSI -, which implies enhanced electron transfer process between spiro-OMeTAD and spiro-OMeTAD •+ TFSI -in the presence of TBMP + TFSI - salt and is consistent with the hr-NMR results            Fig. 1 . 1 Fig. 1. Comparison of perovskite solar cells (PSCs) based on the conventional and ion-modulated (IM) radical doping strategies. (A) Illustration of the complex in situ reaction processes in the conventional doping process (top) and the clean, instant IM radical doping strategy (bottom) of spiro-OMeTAD. The radical and ionic salt were dissolved in 1,1,2,2tetrachloroethane. (B) Current density-voltage (J-V) curves of PSCs (SnO 2 electron transport layer) based on conventional doping, radical doping, and IM radical doping of spiro-OMeTAD. (C) J-V curves of PSCs (mesoporous TiO 2 electron transport layer) based on conventional and IM radical doping of spiro-OMeTAD. (D and E) PCE tracking of unencapsulated PSCs based on conventional and IM radical doping of spiro-OMeTAD under 70 ± 5% humidity (D) and 70 ± 3°C thermal aging (E). Error bars denote SD. 
 Fig. 2 . 2 Fig. 2. Effects of radicals and ionic salts on conductivity and energetics. (A and B) J-V curves of the hole-only devices (A) and conductivity of the spiro-OMeTAD films doped with different radical amounts (B). Inset of (B) shows the structure of the hole-only devices. (C) J-V curves of the hole-only devices with 14 mol % radicals and different amounts of TBMP + TFSI -. The inset shows conductivity. (D and E) Fermi-level and HOMO onsets of the spiro-OMeTAD films doped with different radical amounts (D) and different TBMP + TFSI -amounts (14 mol % radicals) (E). Error bars denote SD. (F) Illustration of the band alignment between the perovskite layer and the HTL with different WF values. 
 Fig. 3 . 3 Fig. 3. Molecular-level doping mechanisms of the IM radical doping. (A) Illustration of the charge transfer and doping mechanisms with spiro-OMeTAD •+ TFSI - radicals. (B) 1 H hr-NMR spectra of spiro-OMeTAD (black line), spiro-OMeTAD/ spiro-OMeTAD •+ TFSI -mixture without TBMP + TFSI -(red line; inset shows magnified view of d+e+f peak in the range of 9 to ~7.5 ppm), and spiro-OMeTAD/ spiro-OMeTAD •+ TFSI -mixture with TBMP + TFSI -(blue line) in the range 9 to 6.25 ppm. (Peaks b, c, and d+e+f refer to the aromatic protons signal.) (C) EPR signals of doped spiro-OMeTAD (14 mol % radicals) with and without TBMP + TFSI - at low temperature and room temperature. (D) Zoom-in spectra near the valence band of neutral spiro-OMeTAD, 14 mol % radical-doped spiro-OMeTAD film, and 14 mol % radical and 20 mol % TBMP + TFSI --doped spiro-OMeTAD films. (E) Illustration of ionic salts' effect on WF modulation in the framework of the IM radical doping strategy. (F) Temperature-dependent conductivity evolution of doped spiro-OMeTAD (14 mol % radicals) with and without TBMP + TFSI -. 
 Fig. 4 . 4 Fig. 4. Generality of the IM radical doping strategy. (A) J-V curves of different PSCs based on spiro-OMeTAD HTL following the IM radical doping strategy. (B) Molecular structures of six additional ionic salts used in this work and their effects on the energetic levels of the doped spiro-OMeTAD films. EDMPA, ethyldimethylpropylammonium; PMPlm, 3-methyl-1-propylpyridinium; BMIM, 1-propyl-3-methyl-imidazolium. (C) J-V curves of PSCs based on the spiro-OMeTAD HTL doped with six additional ionic salts (14 mol % radicals). 
 Fig. S1 S1 Fig. S1 Molecular structure of spiro-OMeTAD 2•+ (TFSI -)2. Hydrogen atoms were omitted for clarity. 
 Fig. S2 ( S2 Fig. S2 (A) XPS and (B) UV-Vis absorption spectra of neutral spiro-OMeTAD and spiro-OMeTAD 2•+ (TFSI -)2. Note: The feature at ca. 1700 nm is due to the mis-corrected vibrational overtone from the solvent. 
 Fig. S3 . S3 Fig. S3. (A) PSCs device structure; (B) XRD, (C) UV-Vis absorption and PL spectra, (D)TRPL results of the active perovskite layer.The device structure for the PSCs was ITO/SnO2/perovskite/doped spiro-OMeTAD/Au. The active layer shows a high crystallinity based on the XRD results. A small amount (10 mol%) of excess PbI2 was added into the active layer to achieve higher performance by self-passivation. The perovskite film shows high absorption across the whole visible range and a strong PL peak at ~820 nm. With OAI surface passivation, the carrier lifetime in the perovskite is ~450 ns. 
 Fig. S4 ( S4 Fig. S4 (A) J-V curves of PSCs with conventionally doped spiro-OMeTAD under different oxidation time. (B and C) J-V curves of PSCs using spiro-OMeTAD with IM radical doping: (B) different radical amounts and (C) 14 mol% radicals as a function of TBMP + TFSI -amounts. Note that the radical amount corresponds to the amount of spiro-OMeTAD •+ TFSI -. 
 Fig Fig. S5 (A) Conductivity and (B) UV-Vis absorption spectra comparison between conventional spiro-OMeTAD doping as a function of oxidation time and IM radical doping. In the conventional doping process with 56 mol% LiTFSI and 330 mol% tBP, the radical 
 Fig. S6 S6 Fig. S6 AFM topography of doped spiro-OMeTAD films on perovskites with 20 mol% (A) and 30 mol% TBMP + TFSI -(B).Based on the AFM topography, when the TBMP + TFSI -concentration increases to ~30 mol%, phase segregation of ionic species happens during HTL film formation. 
 Fig. S7 S7 Fig. S7 EQEEL of PSCs using the IM radical doping strategy with 14 mol% radicals and different TBMP + TFSI -amounts. 
 Fig. S8 S8 Fig. S8 PCE certification of the PSCs based on spiro-OMeTAD using the IM radical doping strategy. 
 Fig. S9 S9 Fig. S9 The PCE distribution of PSCs based on (A) SnO2 planar ETL structure and (B) TiO2 mesoporous ETL structure using the conventional doping recipe and the IM radical doping strategy. (C) The optimized oxidation time statistics of the conventional doping recipe under different environment humidity. 
 Fig Fig. S10 J-V curves of PSCs (unencapsulated) using the conventional doping recipe (A) and the IM radical doping strategy (B) as a function of aging time in a ~70±5% humidity box. 
 Fig. Fig. S11 J-V curves of PSCs (unencapsulated) using the conventional doping recipe (A) and the IM radical doping strategy (B) as a function of aging time in a ~70±3°C oven. 
 Fig. S12 ( S12 Fig. S12 (A) Optical images of PSCs (back side) with spiro-OMeTAD using conventional doping and IM radical doping as a function of aging time in high humidity. (B) The box used for high humidity aging. 
 Fig. S13 ( S13 Fig. S13 (A) XRD patterns of the device using conventional doping of spiro-OMeTAD as a function of humidity exposure time. (B) XRD patterns of the device using IM radical doping of spiro-OMeTAD as a function of humidity exposure time. 
 Fig. S14 ( S14 Fig. S14 (A) XRD patterns of the device using conventional doping of spiro-OMeTAD as a function of thermal aging time. (B) XRD patterns of the device using IM radical doping of spiro-OMeTAD as a function of thermal aging time. 
 Fig. S15 S15 Fig. S15 SEM images of spiro-OMeTAD layer on the fresh perovskite film: (A) based on conventional doping and (B) based on IM radical doping. Images are given in each case for two resolutions. 
 Fig. S16 S16 Fig. S16 SEM images of spiro-OMeTAD layer on the perovskite film based on conventional doping: (A) after humidity exposure and (B) after thermal stress. Blue rectangle: humidity induced large pinholes (~ 20 μm) on the surface; red circles: small pinholes (~ 1 μm) generated after thermal stress. 
 Fig. S17 S17 Fig. S17 SEM images of spiro-OMeTAD on the perovskite film based on IM radical doping: (A) after humidity exposure and (B) after thermal stress. 
 Fig. S18 S18 Fig. S18 Device parameters (A) PCE; (B) VOC; (C) JSC; (D) FF for MPP tracking of unencapsulated PSCs using spiro-OMeTAD HTLs based on conventional doping and IM radical doping under continuous AM 1.5 illumination at 25℃ under N2 atmosphere. 
 Fig. S19 ( S19 Fig. S19 (A) UPS spectra of the spiro-OMeTAD films doped with different radical amounts. (B) UPS spectra of the spiro-OMeTAD films doped with fixed 14 mol% radicals and different TBMP + TFSI -amounts. 
 Fig. S20 S20 Fig. S20 Energies and wavefunctions of the frontier molecular orbitals (MOs) of neutral spiro-OMeTAD. 
 Fig. S21 S21 Fig. S21 Capacitance-voltage (CV) measurements of radical doped spiro-OMeTAD film and IM doped spiro-OMeTAD film. (The device structure in this measurement is p-Si/SiO2/doped spiro-OMeTAD/Au) 
 Fig. S22 S22 Fig. S22 Energies and wavefunctions of the frontier molecular orbitals of the spiro-OMeTAD radical-cation. 
 Fig. S23 S23 Fig. S23 Energies and wavefunctions of the frontier molecular orbitals of spiro-OMeTAD • :TFSI 
 Fig. S25 S25 Fig.S25UV-Vis absorption spectra of spiro-OMeTAD with different amounts of ionic salts (an intensity zoom-in is given in B) From the absorption spectra, there are no obvious radical absorption peaks upon addition of TBMP + TFSI -, indicating that the ionic salts have negligible effects on the oxidation of spiro-OMeTAD molecules to radicals. 
 Fig. S26 S26 Fig. S26 UV-Vis absorption spectra of spiro-OMeTAD2•+ (TFSI -)2 with different amounts of ionic salts (with a zoom-in of the NIR region is given in B). There is no significant change in the radical absorption spectra with the addition of TBMP + TFSI -, either. The absorption peak corresponding to the inter-valence charge transfer 
 Fig. S27 S27 Fig. S27 GIWAXS spectra (A) qz; (B) qr of the neutral spiro-OMeTAD film, the spiro-OMeTAD film doped with radicals, and the spiro-OMeTAD film doped with both radicals and TBMP + TFSI -. All these thin films show low crystallinity. The addition of radicals has little impact on crystallization and the TBMP + TFSI -addition even decreases long-range orientation of spiro-OMeTAD molecules. 
 Fig. S28 S28 Fig. S28 ToF-SIMS measurements of PSCs with the HTL based on IM radical doping of spiro-OMeTAD and ETL based on SnO2.From the uniform distribution of S -, C5H4N -, C4H9 -and CF3 -, it can be concluded that the distributions of TFSI -and TBPM + are uniform. 
 Fig. S29 ( S29 Fig. S29 (A) 1 H hr-NMR spectra of spiro-OMeTAD and spiro-OMeTAD with TBMP + TFSI -in C6D5Cl. (B) 1 H hr-NMR spectra of the spiro-OMeTAD and spiro-OMeTAD •+ TFSI -mixture with (blue line) and without (red line) TBMP + TFSI -. (Peaks b, c, and d+e+f refers to the aromatic protons signal.) 
 Fig. S31 S31 Fig. S31 Temperature-dependent EPR measurements of doped spiro-OMeTAD thin films without TBMP + TFSI -(A) and with TBMP + TFSI -(B). 
 Fig. S32 S32 Fig. S32 Lorentz fit of monoradical doped spiro-OMeTAD without TBMP + TFSI -at 90 K (A1), 175 K (C1) and 282 K (E1); Lorentz fit of mono radical doped spiro-OMeTAD with 20 mol% TBMP + TFSI -at 90 K (B1), 175 K (D1) and 284 K (F1); Gauss fit of mono radical doped spiro-OMeTAD without TBMP + TFSI -at 90 K (A2), 175 K (C2) and 282 K (E2); Lorentz fit of mono radical doped spiro-OMeTAD with 20 mol% TBMP + TFSI -at 90 K (B2), 175 K (D2) and 284 K (F2). 
 Fig. S33 S33 Fig. S33 LEIPS data for spiro-OMeTAD doped with spiro-OMeTAD •+ TFSI -(A & B), spiro-OMeTAD doped with spiro-OMeTAD •+ TFSI -and TBMP + TFSI -(C & D). 
 Fig. S34 ( S34 Fig.S34(A) Geometries and (B) molecular orbital energies (eV) of the spiro-OMeTAD •+ TFSI - radical complex with additional TBPM + :TFSI -ions placed at various positions, as calculated at the LC-ωhPBE/6-31G** level of theory. 
 Fig. S35 S35 Fig. S35 Illustration of the lowest unoccupied spin-orbital (SUMO) in spiro-OMeTAD •+ TFSI -(A) without and (B) with TBMP + TFSI -, as calculated at the tuned LC-hPBE/6-31G** level of theory; dotted circles and yellow shades represent TFSI -and TBMP + TFSI -ionic salts, respectively. 
 Fig. S36 S36 Fig. S36 Temperature-dependent conductivity measurements of doped spiro-OMeTAD thin films without TBMP + TFSI -(A) and with TBMP + TFSI -(B). 
 Fig. Fig. S37 J-V curves of champion PSCs based on different perovskite active layers using conventionally doped spiro-OMeTAD HTLs. 
 Fig. S38 S38 Fig. S38 PCE tracking of unencapsulated PSCs using conventional and IM radical doped spiro-OMeTAD as the HTL under 70±5% humidity based on (A1) MAPbI3, (B1) Cs0.05(FA0.8MA0.2)0.95Pb(I0.8Br0.2)3, (C1) FAPbI3 deposited by the two-step method, (D1) FAPbI3 with IL; and under 70±3°C thermal aging based on (A2) MAPbI3, (B2) Cs0.05(FA0.8MA0.2)0.95Pb(I0.8Br0.2)3, (C2) FAPbI3 deposited by the two-step method; (D2) FAPbI3 with IL. Error bars denote standard deviation. 
 Fig. S39 S39 Fig. S39 UPS data of IM radical doped spiro-OMeTAD films with different ionic salts (with 14 mol% radicals). 
 Fig. S40 S40 Fig. S40 Conductivity of IM radical doped spiro-OMeTAD films with different ionic salts (with 14 mol% radicals). Error bars denote standard deviation. 
 
 
 
 C NMR (126 MHz, Methanol-d4) δ 172.35, 146.00, 126.25, 122.45, 119.90, 47.90, 37.45, 30.17. 
 TBMP + PS -: 1 H NMR (500 MHz, Methanol-d4) δ 8.76 (d, J = 6.9 Hz, 2H), 8.09 (d, J = 6.8 Hz, 2H), 7.72 (d, J = 8.2 Hz, 2H), 7.25 (d, J = 7.9 Hz, 2H), 4.36 (s, 3H), 2.39 (s, 3H), 1.45 (s, 9H).13 C NMR (126 MHz, Methanol-d4) δ 172.26, 146.07, 143.69, 141.64, 129.82, 126.95,  126.22, 47.91, 37.45, 30.19, 21.29.     C NMR (126 MHz, Methanol-d4) δ 172.35, 146.00, 126.25, 47.87, 37.46, 30.18. TBMP + BF4 -: 1 H NMR (500 MHz, Methanol-d4) δ 8.78 (d, J = 6.8 Hz, 2H), 8.14 (d, J = 6.6 Hz, 2H), 4.39 (s, 3H), 1.48 (s, 9H). 13 C NMR (126 MHz, Methanol-d4) δ 172.29, 146.01, 126.23, 47.89, 37.44, 30.18. 
 2  
 Table S1 . S1 Device parameters of the PSCs using the conventional spiro-OMeTAD doping recipe for the HTL as a function of oxidation time. Conventional doping devices VOC (V) JSC (mA cm -2 ) FF (%) PCE (%) Initial 0.92 2.29 15.2 0.3 After 4 h oxidation 1.07 21.58 33.4 7.7 After 8 h oxidation 1.09 22.09 54.8 13.2 After 12 h oxidation 1.11 24.08 72.3 19.3 After 24 h oxidation 1.15 24.40 79.0 22.2 
 Table S2 . S2 Device parameters of the PSCs based on spiro-OMeTAD HTLs using the IM radical doping strategy. IM radical doping devices VOC (V) JSC (mA cm -2 ) FF (%) PCE (%) w/o any dopants 0.79 9.42 24.1 1.8 w/ 2 mol% radical 0.97 23.18 60.9 13.7 w/ 14 mol% radical 1.04 23.48 76.6 18.7 w/ 20 mol% radical 1.03 23.45 68.5 16.6 w/ 14 mol% radical & 12 mol% salt 1.1 24.35 78.3 21.0 w/ 14 mol% radical & 20 mol% salt 1.17 24.42 81.8 23.4 w/ 14 mol% radical & 30 mol% salt 1.15 24.37 74.3 20.8 
 Table S3 . S3 Device parameters of champion PSCs based on mesoporous TiO2 using the conventionally doped and IM radical doped spiro-OMeTAD layers. VOC (V) JSC (mA cm -2 ) FF (%) PCE (%) Conventional doping 1.169 25.66 82.49 24.8 IM radical doping 1.175 25.52 83.88 25.1 
 Table S6 . S6 Device parameters of champion PSCs based on SnO2/FAPbI3 using IM radical doped spiro-OMeTAD films with different ionic salts (with 14 mol% radicals). VOC (V) JSC (mA cm -2 ) FF (%) PCE (%) EDMPA + TFSI - 1.154 24.40 79.90 22.5 PMPlm 1.155 24.38 81.11 22.8 BMIM + TFSI - 1.158 24.33 81.07 22.8 TBMP + PS - 1.110 24.33 79.02 21.3 TBMP + BF4 - 1.123 24.32 79.09 21.6 TBMP + PF6 - 1.118 24.36 81.29 22.1 
			 of 7 RESEARCH | RESEARCH ARTICLE Downloaded from https://www.science.org at University of California San Diego on November 07, 2024 Zhang et al., Science 377, 495-501 (2022) 
			 of 7 RESEARCH | RESEARCH ARTICLE Downloaded from https://www.science.org at University of California San Diego on November 07, 2024 
			 Torr to accomplish the solar cell fabrication. A 0.06 cm 2 shadow mask was used to define the effective working area of the solar cells.