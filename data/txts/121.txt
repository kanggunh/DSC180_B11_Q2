Paper #: 121
Controlled growth of perovskite layers with volatile alkylammonium chlorides

1.1263210  16  1.045510  16  1.1744710  16  9.3682610  15  Trap densities were calculated using the VTFL from SCLC measurements, and equation Ntraps = 2ε0εrVTFL/(qL 2 ), where the ε0 is the vacuum permittivity, εr (47) is the relative dielectric constant of FAPbI3, q is the elementary charge, and L (550 nm) is the thickness of the perovskite films, respectively. Controlling the crystallinity and surface morphology of perovskite layers by methods such as solvent engineering  1, 2  and methylammonium chloride addition  [3] [4] [5] [6] [7]  is an effective strategy for achieving high-efficiency perovskite solar cells. In particular, it is essential to deposit α-formamidinium lead iodide (FAPbI 3 ) perovskite thin films with few defects due to their excellent crystallinity and large grain size. Here we report the controlled crystallization of perovskite thin films with the combination of alkylammonium chlorides (RACl) added to FAPbI 3 . The δ-phase to α-phase transition of FAPbI 3 and the crystallization process and surface morphology of the perovskite thin films coated with RACl under various conditions were investigated through in situ grazing-incidence wide-angle X-ray diffraction and scanning electron microscopy. RACl added to the precursor solution was believed to be easily volatilized during coating and annealing owing to dissociation into RA 0 and HCl with deprotonation of RA + induced by RA⋯H + -Cl -binding to PbI 2 in FAPbI 3 . Thus, the type and amount of RACl determined the δ-phase to α-phase transition rate, crystallinity, preferred orientation and surface morphology of the final α-FAPbI 3 . The resulting perovskite thin layers facilitated the fabrication of perovskite solar cells with a power-conversion efficiency of 26.08% (certified 25.73%) under standard illumination. So far, alkyl ammonium cations (RA + ) with longer lengths or larger ionic radii than that of formamidinium (FA + ) and methylammonium (MA + ) have been mainly used in forming one-dimensional or two-dimensional (1D or 2D) lead halide perovskites  [8] [9] [10]  , for coexisting with three-dimensional (3D) structures and defect passivation of grain boundaries and surfaces. For this purpose, iodide (I -) or bromide (Br -) is mainly used as a halide anion that binds to RA + . This is because the proton affinity of Cl -ions is greater than that of I -and Br -ions, so that RA + Cl -can easily dissociate into deprotonated RA 0 and H + Cl -, which can then volatilize  [11] [12] [13]  . On the basis of this volatilization, there have been many reports related to low-temperature formation, grain growth and preferential orientation of α-FAPbI 3 when perovskite thin films are deposited by adding shorter alkylammonium chloride (RACl), MACl, to the precursor solution  [3] [4] [5] [6] [7]  . However, there are few reports of using longer RACl such as propylammonium chloride (PACl) and butylammonium chloride (BACl) as an agent for improving perovskite crystallization and surface morphology  [13] [14] [15]  . The volatilization rate of propylamine (PA 0 ) and butylamine (BA 0 ) produced by deprotonation of PACl and BACl may be slower than that of MACl, because the boiling points of PA 0 and BA 0 are 47.8 °C and 78 °C, respectively, which are much higher than that of methylamine (MA 0 , -6.3 °C). Thus, the addition of these RACls with different physical properties is expected to have a great influence on the crystallization behaviour during the formation of perovskite thin films. Nonetheless, few studies have investigated whether the benefits of adding RACl are because of Cl -ions, RA + or the synergistic effects of both Cl -ions and RA + . This work reports the understanding of the role of each RA + and Cl - (specifically, RACl added on the basis of MACl) in the crystallization and surface morphology of the coatings of RACl-added FAPbI 3 precursor solutions and the perovskite solar cells (PSCs) fabricated from the resulting α-FAPbI 3 thin films. 
 Formation of α-FAPbI 3 thin films Figure  1a  shows the surface morphologies observed by scanning electron microscopy (SEM) for the thin films formed by dripping the antisolvent during the spin-coating process of the FAPbI 3 precursor solutions with 0, 5, 10 or 15 mol% PACl added to a 35-mol% MACl base. The thin films coated with the FAPbI 3 precursor containing only 35 mol% MACl without PACl showed distinct grain boundaries. Moreover, several pinholes mixed with the residual coating medium were observed. By contrast, the grain boundaries disappeared with increasing PACl and a uniform surface morphology without pinholes was obtained. Similarly, the surface morphology of the coated thin film with further addition of 10 mol% MACl or BACl to the precursor solution containing 35 mol% MACl also improved in terms of surface uniformity (Extended Data Fig.  1a ), even though PACl was more uniform. These results indicate that the increase in RACl, which can bind to PbI 2 in FAPbI 3 , decelerates the nucleation rate of the intermediate phase induced by dripping the antisolvent. Moreover, depending on the RA + type, a uniform thin film with large grains is formed. For fabricating α-FAPbI 3 -based high-efficiency PSCs, it is important to maintain the uniformity of the intermediate thin film, even after high-temperature heat treatment. Therefore, the as-deposited thin films were annealed at 120 °C for 40 min and then compared with the surface morphology. As shown in Fig.  1b , after annealing, all thin films were formed into very dense and pinhole-free uniform thin films, with or without non-uniformities, such as large pores observed in the as-deposited thin films. The surface morphology of the thin film coated with the precursor, to which only MACl was added, was identical to those reported in the previous study  16  . In particular, thin films coated with precursors containing 10 mol% and 15 mol% PACl exhibited an extremely flat surface morphology even after annealing compared with that of the precursors containing 10 mol% MACl or BACl (Extended Data Fig.  1b ). We further compared the surface morphology and roughness of perovskite thin films deposited with precursors containing an extra 10 mol% of RACl using atomic force microscopy (Supplementary Fig.  1 ). It was observed that the addition of 10 mol% of RACl to the FAPbI 3 precursor containing 35 mol% of MACl reduced the roughness of the thin film surface but the smoothest surface was obtained with PACl. Thus, PACl added to 35 mol% MACl plays a decisive role in improving the surface morphology, leading to improved efficiency. Figure  1c  shows the structural evolution monitored by in situ grazing-incidence wide-angle X-ray diffraction (GI-WAXD) during heating from room temperature (RT) to 120 °C using the as-deposited thin films. The initial δ-FAPbI 3 thin film was converted to α-FAPbI 3 in a heating regime of approximately 60-80 °C. Notably, the as-deposited thin film coated with the precursor to which 15 mol% PACl was added contained α-FAPbI 3 and δ-FAPbI 3 at RT. Generally, α-FAPbI 3 requires a heating temperature above 150 °C to achieve a corner-shared PbI 6 octahedral structure  [17] [18] [19]  . Presumably, α-FAPbI 3 at low temperatures of 60-80 °C and even RT can be attributed to the MACl-induced kinetic effect, such as the PbI 6 octahedral rotation  20, 21  and synergistic effect of PACl coexisting with MACl, as will be discussed later. It is known that adding 100 mol% MACl, approximately three times the amount used in this study, to the FAPbI 3 precursor produces an α phase with a crystal orientation along the (100) α plane at RT immediately after the evaporation of the coating solvent  22  . This can be related to the formation of unstable 2D MAFAPbI 3 Cl (ref.  22  ) and coordination of Cl -ions at the octahedra terminal corner that inhibits the face-shared octahedron, which is the δ-FAPbI 3 structure. Zhao and colleagues  23  reported that HCl promoted the δ-phase to α-phase transition at RT but the transition to the α phase at RT became similar to that with MACl only when the evaporation rate was controlled after adding 100 mol%, which was the same amount as MACl. Therefore, it is reasonable to conclude that the content of Cl -ions added to the  q xy (Å -1 ) q xy (Å -1 ) q xy (Å -1 ) -2 -1 2 1 0 -2 -1 2 1 0 -2 -1 2 1 0 -2 -1 2 1 0 
 FTO F FT T T T T TO FTO FTO FTO FTO FTO TO FTO TO FTO FTO FTO O FT F FT FT FT FT FT T T T T T T T T FT FT T T T T T T T T T T T T T TO q z (Å -1 )  q (Å - 
 Article perovskite precursor and the control of the release rate of Cl -ions by RA + to which Cl -ions are bound are important factors determining the δ-phase to α-phase transition. Notably, in the thin film coated with the precursor to which 5 mol% and 10 mol% PACl were added, the width of the (100) α peak (q ≈ 10 nm -1 ) became much broader at 60-80 °C, at which the transition to the α phase started, and disappeared as the temperature increased. The broadening of the (100) α peak is more pronounced in a thin film containing 10 mol% PACl than that containing 5 mol% and was absent in the film with 15 mol% of PACl, which showed a large amount of α-FAPbI 3 even before annealing (Fig  1c  and Extended Data Fig.  2 ). The (100) α peak width variation at the δ-phase to α-phase transition temperature is the greatest in thin films coated with precursors doped with 10 mol% PACl, which may provide further kinetics for crystallization into high-quality α-FAPbI 3 . Figure  1d  compares the 2D GI-WAXD of the perovskite thin films obtained after annealing the as-deposited thin film at 120 °C for 30 min. A small amount of the intermediate phase containing MACl and PACl and the solvent and δ phase disappeared after heat treatment, transforming into a nearly pure α-FAPbI 3 perovskite structure. This observation is also supported by the time-of-flight secondary ion mass spectrometry (ToF-SIMS) results, which showed that almost no Cl -ions remained in FAPbI 3 in all thin films (Supplementary Fig.  2 ). As reported for MACl addition  7, 14, 16  , few residual Cl -ions were found in PACl and BACl, indicating that almost all of the added RACl evaporated during the coating and annealing processes. The reason for the ready disappearance of RACls added to the precursor solution, such as MACl and PACl, whereas only FAPbI 3 remains, will be discussed later. In thin films obtained from precursors containing PACl, a preferred orientation along the (100) α direction and crystallinity increased as PACl increased up to 15 mol%, with a slight difference between 10 mol% and 15 mol%. This result indicated that PACl led to sharp Bragg diffraction spots of the (100) α plane along the Debye-Scherrer ring at q ≈ 10 nm -1 , indicating improved crystallinity and grain orientation in the out-of-plane direction perpendicular to the substrate. The influence of these crystallinities, crystal orientation and surface morphology controls on the device performance was investigated according to the amount of PACl added to the precursor solution. As shown in Supplementary Fig.  3 , the average efficiency was the highest in the devices fabricated with a precursor solution wherein 10 mol% PACl was added to 35 mol% MACl. The efficiency improvement with PACl indicates that the effect of PA + cations, rather than that of Cl -ions, is dominant because the PSCs fabricated with the precursor to which more MACl was added resulted in lower performance. This implies that more controlled crystallization occurs in the perovskite thin film, in which 10 mol% of PACl is added to the precursor. 
 δ-phase to α-phase transition of FAPbI 3 To gain further insight into the PA + cations for the δ-phase to α-phase transition at low temperatures and highly flat surface morphology of the FAPbI 3 perovskite thin films, we first monitored the surface and structural evolution of the as-deposited thin films at RT. Their behaviours were compared with those of thin films coated with precursors to which 10 mol% MACl and BACl were added because the highest efficiency was obtained when 10 mol% PACl was added to a FAPbI 3 precursor solution containing 35 mol% MACl. Figure  2a  shows azimuthally integrated in situ 2D GI-WAXD measured during ageing of as-deposited film at RT for 0-120 min. Hereafter, 35 mol% of MACl in the FAPbI 3 precursor solution is referred to as 'control', further addition of 10 mol% of MACl and BACl as 'reference 1' and 'reference 2', respectively, and further addition of 10 mol% of PACl as 'target'. In the film coated with the control, the δ phase was almost 100% and the α phase appeared after several tens of minutes and increased substantially during ageing for 120 min. However, even after 120 min, the δ phase was dominant. The as-deposited thin film coated with reference 1 exhibited a greater δ-phase to α-phase transition tendency but the δ phase remained after ageing for 120 min. By contrast, the thin film coated using the target and reference 2 rapidly underwent a δ-phase to α-phase transition with the generation of some amount of 2D phase as the ageing time increased and almost attained the α-phase after 120 min. Because the in situgenerated 2D perovskites disappeared during annealing (Fig.  1c ), both  q (Å -1 ) q (Å -1 ) 0.5 1.0 1.5 2.0 2.5 0.5 1.0 1.5 2.0 2.5 q (Å -1 ) q (Å -1 ) Integrated intensity (a.u.) PA + and BA + cations, like MA + cations, presumably escaped from the thin film. The time-dependent change in the α and δ phases shown in the GI-WAXD of Fig.  2a  is quantitatively illustrated in Fig.  2b, c . The integral of the δ phase for each ageing time initially increased and then rapidly decreased, with the change being more pronounced over time (Fig.  2b ). Concurrently, the α phase rapidly increased from the beginning and was saturated from 30 min to 1 h. the coating film of the precursor to which BACl was added, the δ phase sharply decreased, whereas the α phase rapidly increased from the beginning of ageing (Fig.  2c ); thus, the two changes were well matched. On this addition of BACl, the faster δ-phase to α-phase transition is believed to be associated with a slower volatilization rate of deprotonated BA 0 and stronger base-acid interaction with PbI 2 of FAPbI 3 , because the temperature of such a phase transition is also the lowest in BACl (Extended Data Fig.  3 ). However, such a δ-phase to α-phase transition at RT did not occur unless an antisolvent was dropped during the spin-coating process of the precursor solution on the substrate, and the phase transition occurred only when the temperature was raised (Extended Data Fig.  4 ). As shown by comparing the GI-WAXD (Fig.  1c ) for the target thin film as deposited with and without dripping the antisolvent, a marked difference was observed in terms of crystallinity and orientation and unknown intermediates. Furthermore, in situ GI-WAXD measurements during annealing to 120 °C with the previous two coating films demonstrated that the α phase in the thin film coated without dripping the antisolvent appeared at a relatively high temperature, greater than 70 °C (Extended Data Fig.  4 ). The differences could be related to the washout of almost all dimethyl sulfoxide (DMSO) or N,N-dimethylformamide (DMF) bound to FAPbI 3 when the antisolvent was dropped during spin coating using RACl-added precursors. This observation can be attributed to the fact that, in RACl and DMSO, which compete with PbI 2 as the Lewis base, DMSO is soluble in the antisolvent, whereas RACl remains insoluble; thus, the RACl may dominate the crystallization of the perovskite. 
 Control Particularly, unlike the intermediate of FAPbI 3 -DMSO, RACl coordinated to FAPbI 3 is considered present on the surface of crystalline FAPbI 3 precipitated by the dripping of an antisolvent. On this basis, the behaviour seen in Fig.  2a  can be explained by the presence of RACl on the surface of the δ-phase crystal, which reduces the surface energy, converting to the corner-shared structure from the edge-shared phase by rotating the PbI 6 octahedron  20, 21, 24  , and can further orient the crystal in the (100) α direction by orientation attachment  25, 26  . Numerous studies have reported that several substances, such as Cl -and SCN -bound to the surface of δ-FAPbI 3 , lower the transition barrier, thereby facilitating the transition to the α phase at low temperatures  20, 23, 27  . DMSO also facilitates the δ-phase to α-phase transition when adsorbed on the surface of the δ-FAPbI 3 crystals  28, 29  . In this context, the in situ GI-WAXD measurements demonstrate that δ-FAPbI 3 transforms to α-FAPbI 3 at 60-80 °C during slow heating. Thus, we conclude that the phase transition is generally thermodynamically favourable above 60 °C because of the lowering of the activation barrier in the presence of RACl. At RT, the barrier kinetically suppresses the return to the δ phase  20  . The visual colour change also confirms the δ-phase to α-phase transition with ageing of the as-deposited thin film. In the digital photograph of the change with time of the same thin film as shown in Fig.  2a , the black areas are darkened owing to the formation of α-FAPbI 3 according to the type of RACl (Extended Data Fig.  5 ). Notably, the thin film coated without the antisolvent did not turn black, regardless of RACl type (Supplementary Fig.  4 ). The δ-phase to α-phase transition, occurring thermodynamically at a high temperature of 150 °C or even at RT, is attributed to the complex action of the metastable intermediate depending on the amount of Cl -ions and the type of RA + with the removal of the residual solvents. There have been many reports on the δ-phase to α-phase transition and preferred orientation at low temperatures when adding Cl -anions, such as HCl and MACl (refs.  3, 23, 30, 31  ). Furthermore, the 2D phases resulting from RA + lower the δ-phase to α-phase transition temperature and enhance the α-phase stability  32  . RACl added to the FAPbI 3 precursor solution substantially lowered the  
 Article transition temperature, which even disappeared during ageing at RT (Supplementary Fig.  5 ). This result indicates that the δ-phase to α-phase transition of the coated thin film is kinetically affected by the amount of RACl and the type of RA + . The transformation of α-FAPbI 3 perovskite from the crystalline precursor film was also investigated in the formation chemistry by measuring the extended X-ray absorption fine structure (EXAFS) on the Pb L III edge  33  . Consistent with the behaviour in GI-WAXD (Fig.  2a ), the interatomic distance between Pb-I and its peak intensity, indicating the δ-phase to α-phase transition (Extended Data Fig.  6 ), was changed (Fig.  2d ). Furthermore, the number of I -and Cl - ions coordinating with Pb 2+ cations increased in response to this phase transition and then began decreasing (Fig.  2e ). This result implies that the coordination of RACl to PbI 2 initially increases, leading to the formation of PbI 6 octahedrons, and then slowly disappears. RA + (soft acid) acts more like a soft base (I -) to form stable products, whereas RA + (soft acid) and Cl -(hard base) form unstable products. Furthermore, the primary ammonium (RA + ) ions, although their pK a slightly depends on the length of the alkyl group, are weakly acidic and deprotonate more readily than FA + (ref.  34  ). Thus, the RACl coordinated to PbI 2 (or FAPbI 3 ) was expected to be converted to highly volatile species (for example, MA 0 , PA 0 and HCl) through processes such as deprotonation of RA + (refs.  11, 12, 34  ) while binding with PbI 2 as RA + cations and Cl -anions (RA⋯ H + -Cl -- PbI 2 + FA + → RA 0 ↑ + HPbI 2 Cl + FA + → HCl↑ + FAPbI 3 ). Indeed, RACl itself decomposes and evaporates only above 180 °C (ref.  35  ). The RA 0 generated by RA + deprotonation may exist in a liquid phase before volatilization during annealing, depending on its boiling point. Considering this, we surmise that liquid RA 0 can influence the surface flattening of FAPbI 3 , depending on the RA 0 type. As expected, the BACl-added precursor resulted in a better surface morphology flatness than that obtained using MACl (Extended Data Fig.  1b ); however, the thin film coated with PACl-added precursor was the flattest. 
 Characteristics of α-FAPbI 3 thin films Figure  3a  shows the photoluminescence (PL) spectra of perovskite layers annealed at 120 °C for 40 min after spin-coating the precursor solutions with different types and amounts of volatile RACl on a glass substrate. The control, reference 1 and reference 2 have similar PL intensities but that of the target is slightly high and implies decreasing nonradioactive recombination. For a more quantitative comparison of charge recombination, time-resolved PL was measured using time-correlated single-photon counting under low-intensity pulsed excitation, in which a mono-exponential decay through nonradiative-trap-induced recombination can be observed  36  . The corresponding mono-exponential lifetimes (Supplementary Table  1 ) were obtained from the PL decay curves in Fig.  3b . The carrier lifetime of the target film (τ = 2,929 ns) was longer than that of the control, reference 1 and reference 2 films (τ = 2,187, 2,582 and 1,503 ns, respectively). The highest PL intensity and the longest lifetime in the target film indicated that the nonradiative recombination was the lowest, suggesting the formation of a thin film with the lowest defect concentration by adding 10 mol% PACl. We further measured the dark current-voltage of the full devices by means of the space-charge-limited current method  37, 38  (Fig.  3c  and Extended Data Fig.  7 ). From the calculated trap densities (Supplementary Table  2 ), the trap densities are calculated to be 1.13 × 10 16 , 1.05 × 10 16 , 1.18 × 10 16 and 9.37 × 10 15 cm -3 for the control, reference 1, reference 2 and target films, respectively. Obviously, the target showed the lowest trap concentration, indicating that the defects in the perovskite film coated with the 10-mol%-PACl-added precursor were reduced. Although target and reference 2 are almost similar in terms of surface morphology and the δ-phase to α-phase transition of the perovskite thin film, the lowest trap density in target is believed to be because of higher crystallinity than reference 2. This may be related to the relatively too fast rate of crystallization in the formation of the perovskite thin film of reference 2 (Extended Data Fig.  8 ). Urbach energies (E u ) were also compared because the low defect concentration of the perovskite thin film responsible for the high performance was because of the superiority of the structural quality during the crystal formation of perovskites. E u for the perovskite films was calculated from the ultraviolet (UV)-visible absorption spectra using the following equation: α = α 0 exp(hν/E u ), in which α is the absorption coefficient and hν is the photon energy. E u in the target represented the lowest value, indicating the highest structural quality (Fig.  3d  and Supplementary Fig.  6 ). 
 Photovoltaic performance The consistent results that the target thin film is of high quality encourage further investigation into the benefits of thin films in photovoltaic devices. Thus, 24 PSCs under identical conditions using different RACls were fabricated to confirm their impact on performance in each category. The statistical distribution of current density (J SC ), open-circuit voltage (V OC ) and fill factor (FF) determining the power-conversion efficiency (PCE) are shown in Fig.  4a . As expected from the defect concentration and carrier lifetime analysis of the perovskite thin films formed under each condition, the average PCE of target was the highest and increased compared with that of reference 2. By contrast, the average PCE of reference 1 was lower than that of control. Excessive addition of MACl may be related to the incorporation of small amounts of MA + ions into FAPbI 3 (ref.  7  ), which affects the bandgap (Supplementary Fig.  7 ) and external strain  39  , further affecting the reduction of J SC and FF and, eventually, PCE. The J-V characteristics of the best-performing target device in reverse and forward bias sweeps with antireflective coatings on the device surface are illustrated in Fig.  4b . The J SC , V OC and FF values calculated from the J-V curve at a reverse scan mode were 25.69 mA cm -2 , 1.178 V and 86.15%, respectively; these factors correspond to the PCE of 26.08% under standard air mass 1.5 global (AM 1.5 G) conditions, with J SC , V OC , FF and PCE values of 25.64 mA cm -2 , 1.178 V, 85.06% and 25.7%, respectively, at the forward bias. The PCE of the device was further verified by an accredited laboratory (Newport, USA) using the quasi-steady-state method (Supplementary Fig.  8 ). The resulting stabilized efficiency measured was 25.73%, with J SC , V OC and FF values of 25.80 mA cm -2 , 1.179 V and 84.60%, respectively, which is the highest efficiency ever reported. Figure  4c  shows the external quantum efficiency (EQE) for the same device as that of the J-V curve. The J SC obtained by integrating the EQE over the wavelength is 25.3 mA cm -2 , which is in good agreement with that in the J-V curve measured using the solar simulator. When tested with maximum power point tracking under ambient and full sunlight illumination without a UV cutoff filter, the encapsulated target device retained approximately 88% (25.2%) of its initial efficiency after 600 h (Fig.  4d ). 
 Online content Any methods, additional references, Nature Portfolio reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at  https://doi.org/10.1038/s41586-023-05825-y . 
 Methods 
 Materials The following materials were used in the experiments: formamidinium iodide (FAI; 99.99%, GreatCell Solar), lead(II) iodide (PbI 2 ; 99.99%, TCI), methylenediamine dihydrochloride (MDACl Formamidinium lead triiodide (FAPbI 3 ) black powder was synthesized by mixing 3.36 g FAI with 9 g PbI 2 (1:1 molar ratio) in 11 ml of 2-ME in a 70-ml vial by stirring. The mixed solution was heated to 120 °C in an oil bath and stirred for 45 min. Subsequently, the precipitated FAPbI 3 was filtered using filter paper (Whatman) without cooling to RT. The filtered FAPbI 3 was baked on a hot plate at 150 °C (in air) for 30 min and then left overnight in a vacuum chamber at RT. 
 Device fabrication PSCs were composed of several layers of glass/fluorine-doped tin oxide (FTO)/SnO 2 /perovskite/2,2′,7,7′-tetrakis[N,N-di(4-methoxyphenyl) amino]-9,9′-spirobifluorene (Spiro-OMeTAD)/Au. FTO glass (Asahi VU glass, 12-13 Ω cm -2 ) substrates were sequentially sonicated in acetone, detergent and ethanol for 20 min each. The FTO glasses were dipped in a solution prepared by mixing SnCl 2 •2H 2 O (108 mg), urea (500 mg), thioglycolic acid (10 μl) and HCl (500 μl) in 40 ml of deionized water for 6 h. The substrates were then annealed at 150 °C for 1 h, followed by spin-coating with KCl solution (40 mM) in deionized water and annealing at 150 °C for 15 min. The perovskite precursor solutions were prepared by dissolving 1.4 M FAPbI 3 powder with MDACl 2 (3.8 mol%) and MACl (35 mol%) in a mixed solvent of DMF:DMSO = 8:1 (control); 10 mol% of different alkylammonium chlorides were added for the reference 1 (MACl 10 mol%), reference 2 (BACl 10 mol%) and target (PACl 10 mol%) solutions. The perovskite solutions were then spin-coated onto the substrate at 1,000 rpm for 10 s and 5,000 rpm for 15 s; 1 ml of ethyl ether was dripped onto the substrate during spinning. Before all perovskite layers were heat-treated at 120 °C for 1 h, the as-deposited layers were aged for a period of time at RT, depending on the added RACl. 
 Characterization The surface morphology of the perovskite layers was observed by SEM (Cold FE-SEM SU-8220, Hitachi High-Technologies) with a beam power of 5.0 kV. Steady-state PL and time-resolved PL spectra were measured using a commercial time-correlated single-photon-counting setup (FluoTime 300, PicoQuant GmbH) equipped with a PMA-C-192-M detector and high-resolution excitation monochromators. The J-V characteristics of the devices were measured using a Keithley 2420 source meter under illumination by a solar simulator (Newport, Oriel Sol3A class AAA) with an AM 1.5 G filter and 100 mW cm -2 irradiation intensity. The active area was determined by placing a metal mask in front of the solar cell to avoid the overestimation of the photocurrent density. A spectral mismatch factor of 1.05 was used for all J-V measurements. For the measurement of high-efficiency devices, an antireflective film (NanoEcoWay Co., Ltd.) was applied to the surface. The EQE was measured using an internal quantum efficiency system (Oriel, IQE 200B) under irradiation by a 100-W xenon lamp. The film morphology and thickness were measured using SEM (FE-SEM, Su-7000). 
 GI-WAXD measurements GI-WAXD measurements were performed at the PLS-II 6D UNIST-PAL beamline at the Pohang Accelerator Laboratory (PAL), Korea. The X-rays from the bending magnet were monochromatized to 18.986 keV (λ = 0.6530 Å) using a double-crystal monochromator focused horizontally and vertically (90 (V) × 120 (H) μm 2 full width at half maximum) at the sample position using a sagittal Si(111) crystal and toroidal mirror, respectively. The GI-WAXD sample chamber was equipped with a five-axis motorized stage for fine sample alignment. The 2D GI-WAXD pattern was recorded using a 2D charge-coupled device detector (MX225-HS, Rayonix, LLC, USA). The diffraction angles were calibrated using NIST SRM660b (LaB 6 ) with a sample-to-detector distance of 240.98 mm. An incidence angle of 0.80° was used for the in situ GI-WAXD experiments to obtain crystallographic information about the overall thickness of the perovskite films and to ensure that all incoming X-rays were irradiated onto the small-length perovskite film sample, rather than only passing or being blocked by the substrate or sample stage. The in situ GI-WAXD pattern was obtained every 5 s for the initial 1.5 min and every 1 min between 1.5 and 30 min, in which the X-ray exposure time was 3.5 s each. The FAPbI 3 film temperature was increased from RT to 120 °C in 1.5 min and maintained at 120 °C for 30 min using a fine-tuned temperature controller (Eurotherm 3504 temperature controller, Eurotherm, USA). 
 EXAFS measurements The specimen for EXAFS analysis was prepared by coating FAPbI 3 precursor solution containing MACl 35 mol% and PACl 10 mol%. The as-deposited layer was subjected to EXAFS for a total of six times, 2 min every 20 min. (The total X-ray exposure time was 12 min.) Pb L III -edge X-ray absorption spectra, EXAFS, were collected on the BL10C beam line (WEXAFS) at the Pohang Light Source (PLS-II) using top-up mode operation under a ring current of 350 mA at 3.0 GeV. From the high-intensity X-ray photons of the multipole wiggler source, monochromatic X-ray beams could be obtained using a liquid-nitrogen-cooled double-crystal monochromator (Bruker ASC) with a Si(111) crystal pair. Under grazing incident angle of 3°, all X-ray absorption spectra were recorded in fluorescence mode using a N 2 /Ar mixed-gas-filled ionization chamber (IC Spec, FMB Oxford) and passivated implanted planar silicon (PIPS, Canberra Co.) for the incident and fluorescent X-ray photons, respectively. Higher-order harmonic contaminations were eliminated by detuning to reduce the incident X-ray intensity by about 30%. Energy calibration was simultaneously performed for each measurement with a reference Pb foil in front of the third ion chamber using partially bypassed X-rays. Using the UWXAFS package, Fourier-transformed radial distribution functions (RDFs) of k 3 -weighted Pb L III -edge EXAFS spectra, k 3 χ(k) were obtained in the k range between 3.0 and 13.0 Å -1 through a standard XAFS data-analysis process. Ideal RDFs for model δ-phase and α-phase FAPbI 3 could be obtained from ab initio calculation using FEFF9 code. 
 ToF-SIMS measurements ToF-SIMS profiling measured the depth distributions of the Cl -ions with perovskite/SnO 2 on the FTO substrate. The samples were analysed using a ToF-SIMS V instrument (IONTOF) with a Bi + primary beam (25 keV and 1 pA) and Cs + sputter beam (0.25 keV and 12 nA). The sputter size was 200 × 200 μm; the analysis areas were 100 μm × 100 μm (for depth profiling) and 500 μm × 500 μm (for surface analysis); the area dosage of ions was PIDD 2.48e + (ref.  14  ).  Fig. 1 | 1 Fig. 1 | Changes in the surface morphology and crystal phase of perovskite thin films with volatile RACl. a, Surface morphologies of the thin films spincoated with 0-15 mol% PACl added to the FAPbI 3 precursor containing 35 mol% MACl. b, Surface morphologies after annealing them at 120 °C for 40 min. c, The structural evolution monitored by azimuthally integrated in situ GI-WAXD during heating from RT to 120 °C using the as-deposited thin films. d, 2D GI-WAXD of the perovskite thin films annealed at 120 °C for 30 min and cooled to RT. Scale bars, 1 μm. 
 Fig. 2 | 2 Fig. 2 | Structural evolution by in situ GI-WAXD of thin films coated with volatile RACl. a, The structural evolution of the as-deposited thin films, which were coated using the FAPbI 3 precursor solutions (control, reference 1, reference 2 and target), by azimuthally integrated in situ 2D GI-WAXD during ageing at RT for 120 min. b, The integrated intensity of δ-FAPbI 3 extracted from 2D GI-WAXD over time. c, The integrated intensity of α-FAPbI 3 extracted from 2D GI-WAXD over time. d, Pb L III -edge EXAFS spectra of the as-deposited thin films, which were coated using the FAPbI 3 precursor solution containing MACl and a further 10 mol% of PACl, during ageing at RT for 120 min. The Fourier transform of the k-space EXAFS spectra was plotted. e, The plot of Fouriertransformed peak intensities of Pb-Cl (A) and Pb-I (B) corresponding to the structural development of the EXAFS spectra (in d). a.u., arbitrary units. 
 VFig. 3 | 3 Fig. 3 | Characteristics of perovskite layers deposited with volatile RACl. a,b, Steady-state PL (a) and time-resolved PL (b) spectra of films deposited on a glass substrate. c, Space-charge-limited current analysis for the target and control (inset). V TFL , trap-filled limit voltage. The inset schematic shows the structure of the device used for the measurements. d, Urbach energy calculated in perovskites consisting of FTO/SnO 2 /perovskites. a.u., arbitrary units. 
 Fig. 4 | 4 Fig.4| Performance and stability of PSCs, measured by applying an antireflection film to the surface. a, Statistical distribution of photovoltaic parameters for each of 24 PSCs fabricated with control, reference 1, reference 2 and target thin films. The box plots show the average value (centre line in box), the maximum and minimum values (whiskers), and the lower quartile (25%) and upper quartile (75%) (bottom and top of box). The horizontal dashed blue lines allow for comparison against the control. b, J-V curves of the bestperforming PSC fabricated with the target, which was measured in the reverse and forward modes under AM 1.5 G, including UV. c, The EQE curve of the corresponding PSC. d, Maximum power point tracking for a PSC fabricated with the target, which was measured under full solar illumination (AM 1.5 G, 100 mW cm -2 under ambient conditions) without a UV filter. 
 Extended Data Fig. 2 | 2 Changes in the width of the (100) α peak with time. Shown during annealing from RT to 120 °C, using the thin films formed by dripping the antisolvent during spin-coating of the FAPbI 3 precursor solutions containing 0, 5, 10 or 15 mol% PACl added to a 35 mol% MACl. Extended Data Fig. 3 | Representative 2D GI-WAXD images and enlarged 1D GI-WAXD profiles during in situ experiments. a-e, Control. f-j, Target. k-p, Reference 1. q-u, Reference 2. GI-WAXD measured while increasing and maintaining the temperature from RT to 120 °C. v-y, Enlarged 1D GI-WAXD profiles of control (v), reference 1 (w), target (x) and reference 2 (y) samples around the (100) α peak to investigate the onset temperature of the δ-phase to α-phase transition. z, Plot of the onset temperature of the δ-phase to α-phase transition. 2D GI-WAXD shows that the transition temperature from δ to α phase gradually decreases as the length of the alkyl group in RACl increases from MACl to PACl and BACl. The boiling points and basicity of deprotonated MA 0 , PA 0 and BA 0 are different. Thus, strong acid-base interaction can occur between the Lewis acid PbI 2 and the Lewis base R-NH 2 on the surface of FAPbI 3 . Alkyl substituents such as methyl, propyl and butyl are electron-donating groups and tend to increase with increasing length. This makes BA 0 more Lewis basic, increasing RH 2 N-PbI 2 interaction. Eventually, BA 0 deprotonated in BACl lowers more surface energy of δ-FAPbI 3 , leading to a faster and more effective δ-phase to α-phase transition. Extended Data Fig. 6 | Fourier-transformed RDF. RDF obtained using theoretically calculated Pb L III -edge EXAFS for the α-FAPbI 3 , δ-FAPbI 3 and relaxed-FAPbI 3 , respectively. Extended Data Fig. 7 | Space-charge-limited current analysis. Shown for reference 1 and reference 2. V TFL is trap-filled limit voltage. Article Extended Data Fig. 8 | Changes in the mutually normalized integrated area over time and representative 2D GI-WAXD images. a, Changes in the mutually normalized integrated area obtained by α-phase peaks of in situ GI-WAXD measured while increasing and maintaining the temperature from RT to 120 °C. b, Representative 2D GI-WAXD images of target and reference 2 samples annealed at 120 °C for 30 min. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 Table 1 . 1 Calculated carrier lifetime of perovskite films from time-resolved PL measurements. Supplementary τ (ns) Control 2,187±43 Reference 1 2,582±80 Reference 2 1,503±11 Target 2,929±157 Supplementary 
 Table 2 . 2 Calculated trap densities from Space charge-limited current (SCLC) measurements. Control Reference 1 Reference 2 Target 𝑽 𝑻𝑭𝑳 (V) 0.655 0.608 0.683 0.5448 Trap density(𝒄𝒎 -𝟑 )